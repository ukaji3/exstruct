{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"ExStruct Documentation","text":"<p>Welcome to the ExStruct docs. This site covers usage, CLI, and API reference for extracting structured data from Excel workbooks.</p> <ul> <li>README (EN)</li> <li>README (JA)</li> <li>API Reference: See the navigation for callable functions and parameters.</li> <li>CLI Guide</li> <li>Concept / Why ExStruct?</li> <li>Corporate Usage License Guide</li> </ul>"},{"location":"#at-a-glance","title":"At a Glance","text":"<ul> <li>Export structured JSON (default), YAML, TOON (optional deps).</li> <li>Output modes: <code>light</code> / <code>standard</code> / <code>verbose</code>.</li> <li>Table detection is tunable via <code>set_table_detection_params</code>.</li> <li>Graceful fallback when Excel COM is unavailable.</li> </ul>"},{"location":"#quick-links","title":"Quick Links","text":"<ul> <li>Install: <code>pip install exstruct</code></li> <li>CLI: <code>exstruct input.xlsx --pretty --mode standard</code></li> <li>Python: <code>from exstruct import extract, export</code></li> </ul>"},{"location":"README.en/","title":"ExStruct \u2014 Excel Structured Extraction Engine","text":"<p>ExStruct reads Excel workbooks and outputs structured data (cells, table candidates, shapes, charts, smartart, merged cell ranges, print areas/views, auto page-break areas, hyperlinks) as JSON by default, with optional YAML/TOON formats. It targets both COM/Excel environments (rich extraction) and non-COM environments (cells + table candidates + print areas), with tunable detection heuristics and multiple output modes to fit LLM/RAG pipelines.</p> <p>\u65e5\u672c\u7248 README</p>"},{"location":"README.en/#features","title":"Features","text":"<ul> <li>Excel \u2192 Structured JSON: cells, shapes, charts, smartart, table candidates, print areas/views, and auto page-break areas per sheet.</li> <li>Output modes: <code>light</code> (cells + table candidates + print areas; no COM, shapes/charts empty), <code>standard</code> (texted shapes + arrows, charts, smartart, merged cell ranges, print areas), <code>verbose</code> (all shapes with width/height, charts with size, merged cell ranges, print areas). Verbose also emits cell hyperlinks, <code>colors_map</code>, and <code>formulas_map</code>. Size output is flag-controlled.</li> <li>Formula map extraction: emits <code>formulas_map</code> (formula string -&gt; cell coordinates) via openpyxl/COM; enabled by default in <code>verbose</code> or via <code>include_formulas_map</code>.</li> <li>Auto page-break export (COM only): capture Excel-computed auto page breaks and write per-area JSON/YAML/TOON when requested (CLI option appears only when COM is available).</li> <li>Formats: JSON (compact by default, <code>--pretty</code> available), YAML, TOON (optional dependencies).</li> <li>Table detection tuning: adjust heuristics at runtime via API.</li> <li>CLI rendering (Excel required): optional PDF and per-sheet PNGs.</li> <li>Graceful fallback: if Excel COM is unavailable, extraction falls back to cells + table candidates without crashing.</li> </ul>"},{"location":"README.en/#benchmark","title":"Benchmark","text":"<p>This repository includes benchmark reports focused on RAG/LLM preprocessing of Excel documents. We track two perspectives: (1) core extraction accuracy and (2) reconstruction utility for downstream structure queries (RUB). See <code>benchmark/REPORT.md</code> for the working summary and <code>benchmark/public/REPORT.md</code> for the public bundle. Current results are based on n=12 cases and will be expanded.</p>"},{"location":"README.en/#installation","title":"Installation","text":"<pre><code>pip install exstruct\n</code></pre> <p>Optional extras:</p> <ul> <li>YAML: <code>pip install pyyaml</code></li> <li>TOON: <code>pip install python-toon</code></li> <li>Rendering (PDF/PNG): Excel + <code>pip install pypdfium2 pillow</code></li> <li>All extras at once: <code>pip install exstruct[yaml,toon,render]</code></li> </ul> <p>Platform note:</p> <ul> <li>Full extraction (shapes/charts) targets Windows + Excel (COM via xlwings). On other platforms, use <code>mode=light</code> to get cells + <code>table_candidates</code>.</li> </ul>"},{"location":"README.en/#quick-start-cli","title":"Quick Start (CLI)","text":"<pre><code>exstruct input.xlsx &gt; output.json          # compact JSON to stdout (default)\nexstruct input.xlsx -o out.json --pretty   # pretty JSON to a file\nexstruct input.xlsx --format yaml          # YAML (needs pyyaml)\nexstruct input.xlsx --format toon          # TOON (needs python-toon)\nexstruct input.xlsx --sheets-dir sheets/   # split per sheet in chosen format\nexstruct input.xlsx --auto-page-breaks-dir auto_areas/  # COM only; option appears when available\nexstruct input.xlsx --print-areas-dir areas/  # split per print area (if any)\nexstruct input.xlsx --mode light           # cells + table candidates only\nexstruct input.xlsx --pdf --image          # PDF and PNGs (Excel required)\n</code></pre> <p>Auto page-break exports are available via API and CLI when Excel/COM is available; the CLI exposes <code>--auto-page-breaks-dir</code> only in COM-capable environments.</p>"},{"location":"README.en/#mcp-server-stdio","title":"MCP Server (stdio)","text":"<p>Install the MCP extras and run the stdio server:</p> <pre><code>pip install exstruct[mcp]\nexstruct-mcp --root C:\\data --log-file C:\\logs\\exstruct-mcp.log --on-conflict rename\n</code></pre> <p>Available tools:</p> <ul> <li><code>exstruct_extract</code></li> <li><code>exstruct_read_json_chunk</code></li> <li><code>exstruct_validate_input</code></li> </ul> <p>Notes:</p> <ul> <li>Logs go to stderr (and optionally <code>--log-file</code>) to avoid contaminating stdio responses.</li> <li>On Windows with Excel, standard/verbose can use COM for richer extraction. On non-Windows, COM is unavailable and extraction uses openpyxl-based fallbacks.</li> </ul> <p>MCP Setup Guide for Each AI Agent:</p> <p>MCP Server</p>"},{"location":"README.en/#quick-start-python","title":"Quick Start (Python)","text":"<pre><code>from pathlib import Path\nfrom exstruct import extract, export, set_table_detection_params\n\n# Tune table detection (optional)\nset_table_detection_params(table_score_threshold=0.3, density_min=0.04)\n\n# Extract with modes: \"light\", \"standard\", \"verbose\"\nwb = extract(\"input.xlsx\", mode=\"standard\")\nexport(wb, Path(\"out.json\"), pretty=False)  # compact JSON\n\n# Model helpers: iterate, index, and serialize directly\nfirst_sheet = wb[\"Sheet1\"]           # __getitem__ access\nfor name, sheet in wb:               # __iter__ yields (name, SheetData)\n    print(name, len(sheet.rows))\nwb.save(\"out.json\", pretty=True)     # WorkbookData \u2192 file (by extension)\nfirst_sheet.save(\"sheet.json\")       # SheetData \u2192 file (by extension)\nprint(first_sheet.to_yaml())         # YAML text (requires pyyaml)\n\n# ExStructEngine: per-instance options (nested configs)\nfrom exstruct import (\n    DestinationOptions,\n    ExStructEngine,\n    FilterOptions,\n    FormatOptions,\n    OutputOptions,\n    StructOptions,\n    export_auto_page_breaks,\n)\n\nengine = ExStructEngine(\n    options=StructOptions(mode=\"verbose\"),  # verbose includes hyperlinks by default\n    output=OutputOptions(\n        format=FormatOptions(pretty=True),\n        filters=FilterOptions(include_shapes=False),  # drop shapes in output\n        destinations=DestinationOptions(sheets_dir=Path(\"out_sheets\")),  # also write per-sheet files\n    ),\n)\nwb2 = engine.extract(\"input.xlsx\")\nengine.export(wb2, Path(\"out_filtered.json\"))\n\n# Enable hyperlinks in standard mode\nengine_links = ExStructEngine(options=StructOptions(mode=\"standard\", include_cell_links=True))\nwith_links = engine_links.extract(\"input.xlsx\")\n\n# Export per print area (if print areas exist)\nfrom exstruct import export_print_areas_as\nexport_print_areas_as(wb, \"areas\", fmt=\"json\", pretty=True)\n\n# Auto page-break extraction/output (COM only; raises if no auto breaks exist)\nengine_auto = ExStructEngine(\n    output=OutputOptions(\n        destinations=DestinationOptions(auto_page_breaks_dir=Path(\"auto_areas\"))\n    )\n)\nwb_auto = engine_auto.extract(\"input.xlsx\")  # includes SheetData.auto_print_areas\nengine_auto.export(wb_auto, Path(\"out_with_auto.json\"))  # also writes auto_areas/*\nexport_auto_page_breaks(wb_auto, \"auto_areas\", fmt=\"json\", pretty=True)  # manual writer\n</code></pre> <p>Note (non-COM environments): If Excel COM is unavailable, extraction still runs and returns cells + <code>table_candidates</code>; <code>shapes</code>/<code>charts</code> will be empty.</p>"},{"location":"README.en/#table-detection-tuning","title":"Table Detection Tuning","text":"<pre><code>from exstruct import set_table_detection_params\n\nset_table_detection_params(\n    table_score_threshold=0.35,  # increase to be stricter\n    density_min=0.05,\n    coverage_min=0.2,\n    min_nonempty_cells=3,\n)\n</code></pre> <p>Use higher thresholds to reduce false positives; lower them if true tables are missed.</p>"},{"location":"README.en/#output-modes","title":"Output Modes","text":"<ul> <li>light: cells + table candidates (no COM needed).</li> <li>standard: texted shapes + arrows, charts (COM if available), merged cell ranges, table candidates. Hyperlinks are off unless <code>include_cell_links=True</code>.</li> <li>verbose: all shapes (with width/height), charts, merged cell ranges, table candidates, cell hyperlinks, <code>colors_map</code>, and <code>formulas_map</code>.</li> </ul>"},{"location":"README.en/#error-handling-fallbacks","title":"Error Handling / Fallbacks","text":"<ul> <li>Excel COM unavailable \u2192 falls back to cells + table candidates; shapes/charts empty.</li> <li>Shape extraction failure \u2192 logs warning, still returns cells + table candidates.</li> <li>CLI prints errors to stdout/stderr and returns non-zero on failures.</li> </ul>"},{"location":"README.en/#optional-rendering","title":"Optional Rendering","text":"<p>Requires Excel and <code>pypdfium2</code>.</p> <pre><code>exstruct input.xlsx --pdf --image --dpi 144\n</code></pre> <p>Creates <code>&lt;output&gt;.pdf</code> and <code>&lt;output&gt;_images/</code> PNGs per sheet.</p>"},{"location":"README.en/#example-1-excel-structuring-demo","title":"Example 1: Excel Structuring Demo","text":"<p>To show how well exstruct can structure Excel, we parse a workbook that combines three elements on one sheet and share an AI reasoning benchmark that uses the JSON output.</p> <ul> <li>Table (sales data)</li> <li>Line chart</li> <li>Flowchart built only with shapes</li> </ul> <p>(Screenshot below is the actual sample Excel sheet)  Sample workbook: <code>sample/sample.xlsx</code></p>"},{"location":"README.en/#1-input-excel-sheet-overview","title":"1. Input: Excel Sheet Overview","text":"<p>This sample Excel contains:</p>"},{"location":"README.en/#1-table-sales-data","title":"\u2460 Table (Sales Data)","text":"Month Product A Product B Product C Jan-25 120 80 60 Feb-25 135 90 64 Mar-25 150 100 70 Apr-25 170 110 72 May-25 160 120 75 Jun-25 180 130 80"},{"location":"README.en/#2-chart-line-chart","title":"\u2461 Chart (Line Chart)","text":"<ul> <li>Title: Sales Data</li> <li>Series: Product A / Product B / Product C (six months)</li> <li>Y axis: 0\u2013200</li> </ul>"},{"location":"README.en/#3-flowchart-built-with-shapes","title":"\u2462 Flowchart built with shapes","text":"<p>The sheet includes this flow:</p> <ul> <li>Start / End</li> <li>Format check</li> <li>Loop (items remaining?)</li> <li>Error handling</li> <li>Yes/No decision for sending email</li> </ul>"},{"location":"README.en/#2-output-structured-json-produced-by-exstruct-excerpt","title":"2. Output: Structured JSON produced by exstruct (excerpt)","text":"<p>Below is a shortened JSON output example from parsing this Excel workbook.</p> <pre><code>{\n  \"book_name\": \"sample.xlsx\",\n  \"sheets\": {\n    \"Sheet1\": {\n      \"rows\": [\n        {\n          \"r\": 3,\n          \"c\": {\n            \"1\": \"\u6708\",\n            \"2\": \"\u88fd\u54c1A\",\n            \"3\": \"\u88fd\u54c1B\",\n            \"4\": \"\u88fd\u54c1C\"\n          }\n        },\n        ...\n      ],\n      \"shapes\": [\n        {\n          \"id\": 1,\n          \"text\": \"\u958b\u59cb\",\n          \"l\": 148,\n          \"t\": 220,\n          \"kind\": \"shape\",\n          \"type\": \"AutoShape-FlowchartProcess\"\n        },\n        {\n          \"id\": 2,\n          \"text\": \"\u5165\u529b\u30c7\u30fc\u30bf\u8aad\u307f\u8fbc\u307f\",\n          \"l\": 132,\n          \"t\": 282,\n          \"kind\": \"shape\",\n          \"type\": \"AutoShape-FlowchartProcess\"\n        },\n        {\n          \"l\": 193,\n          \"t\": 246,\n          \"kind\": \"arrow\",\n          \"begin_arrow_style\": 1,\n          \"end_arrow_style\": 2,\n          \"begin_id\": 1,\n          \"end_id\": 2,\n          \"direction\": \"N\"\n        },\n        ...\n      ],\n      \"charts\": [\n        {\n          \"name\": \"Chart 1\",\n          \"chart_type\": \"Line\",\n          \"title\": \"\u58f2\u4e0a\u30c7\u30fc\u30bf\",\n          \"y_axis_range\": [\n            0.0,\n            200.0\n          ],\n          \"series\": [\n            {\n              \"name\": \"\u88fd\u54c1A\",\n              \"name_range\": \"Sheet1!$C$3\",\n              \"x_range\": \"Sheet1!$B$4:$B$9\",\n              \"y_range\": \"Sheet1!$C$4:$C$9\"\n            },\n            ...\n          ],\n          \"l\": 377,\n          \"t\": 25\n        }\n      ],\n      \"table_candidates\": [\n        \"B3:E9\"\n      ]\n    }\n  }\n}\n</code></pre>"},{"location":"README.en/#3-how-ai-copilot-llm-interprets-the-json","title":"3. How AI (Copilot / LLM) interprets the JSON","text":"<pre><code>Below is the Markdown reconstruction of the Excel workbook. The table, chart, and flowchart are all represented.\n\n---\n\n## \ud83d\udcca Sales Data Table\n\n| Month      | Product A | Product B | Product C |\n| ---------- | --------- | --------- | --------- |\n| 2025-01-01 | 120       | 80        | 60        |\n| 2025-02-01 | 135       | 90        | 64        |\n| 2025-03-01 | 150       | 100       | 70        |\n| 2025-04-01 | 170       | 110       | 72        |\n| 2025-05-01 | 160       | 120       | 75        |\n| 2025-06-01 | 180       | 130       | 80        |\n\n---\n\n## \ud83d\udcc8 Sales Data (Line Chart)\n\n- Chart title: **\u58f2\u4e0a\u30c7\u30fc\u30bf (Sales Data)**\n- Chart type: Line\n- Y-axis range: 0 to 200\n- Data series:\n  - Product A: 120 \u2192 135 \u2192 150 \u2192 170 \u2192 160 \u2192 180\n  - Product B: 80 \u2192 90 \u2192 100 \u2192 110 \u2192 120 \u2192 130\n  - Product C: 60 \u2192 64 \u2192 70 \u2192 72 \u2192 75 \u2192 80\n\n---\n\n## \ud83d\udd04 Process Flow (Mermaid Flowchart)\n\n```mermaid\nflowchart TD\n    A[Start]\n    B[Load input data]\n    C{Is format valid?}\n    D[Show error]\n    E[Process one item]\n    F{Items remaining?}\n    G[Generate output]\n    H{Send email?}\n    I[Send email]\n    J[Finish]\n\n    A --&gt; B\n    B --&gt; C\n    C --&gt;|yes| D\n    C --&gt; H\n    D --&gt; E\n    E --&gt; F\n    F --&gt; G\n    G --&gt;|yes| I\n    G --&gt;|no| J\n    H --&gt; J\n    I --&gt; J\n```\n</code></pre>"},{"location":"README.en/#example-2-general-application-form","title":"Example 2: General Application Form","text":""},{"location":"README.en/#excel-sheet","title":"Excel Sheet","text":""},{"location":"README.en/#exstruct-json","title":"ExStruct JSON","text":"<p>(Truncated for brevity)</p> <pre><code>{\n  \"book_name\": \"en_sf425.xlsx\",\n  \"sheets\": {\n    \"FFR\": {\n      \"rows\": [\n        { \"r\": 1, \"c\": { \"0\": \"FEDERAL FINANCIAL REPORT\" } },\n        { \"r\": 3, \"c\": { \"0\": \"(Follow form instructions)\" } },\n        {\n          \"r\": 4,\n          \"c\": {\n            \"0\": \"1.  Federal Agency and Organizational Element\",\n            \"5\": \"2.  Federal Grant or Other Identifying Number Assigned by Federal Agency\",\n            \"20\": \"Page\",\n            \"23\": \" of\"\n          }\n        },\n        ...\n      ],\n      \"shapes\": [\n        {\n          \"id\": 1,\n          \"text\": \"Not Required by EPA\",\n          \"l\": 575,\n          \"t\": 396,\n          \"kind\": \"shape\",\n          \"type\": \"AutoShape-Rectangle\"\n        }\n      ],\n      \"print_areas\": [{ \"r1\": 1, \"c1\": 0, \"r2\": 66, \"c2\": 23 }],\n      \"merged_cells\": {\n        \"schema\": [\"r1\", \"c1\", \"r2\", \"c2\", \"v\"],\n        \"items\": [\n          [34, 15, 34, 23, \" \"],\n          [56, 10, 57, 17, \"Federal Share Calculation\"],\n          [18, 10, 18, 23, \" \"],\n          [15, 0, 15, 1, \" \"],\n          ...\n        ]\n      }\n    }\n  }\n}\n\n</code></pre>"},{"location":"README.en/#migration-note-v035-merged_cells-format-change","title":"Migration note (v0.3.5): merged_cells format change","text":"<p><code>merged_cells</code> changed from a list of objects to a schema/items structure in v0.3.5 (breaking change for JSON consumers).</p> <p>Old format (&lt;= v0.3.2):</p> <pre><code>\"merged_cells\": [\n  { \"r1\": 34, \"c1\": 15, \"r2\": 34, \"c2\": 23, \"v\": \" \" },\n  { \"r1\": 56, \"c1\": 10, \"r2\": 57, \"c2\": 17, \"v\": \"Federal Share Calculation\" }\n]\n</code></pre> <p>New format (v0.3.5+):</p> <pre><code>\"merged_cells\": {\n  \"schema\": [\"r1\", \"c1\", \"r2\", \"c2\", \"v\"],\n  \"items\": [\n    [34, 15, 34, 23, \" \"],\n    [56, 10, 57, 17, \"Federal Share Calculation\"]\n  ]\n}\n</code></pre> <p>Migration example (support both during transition):</p> <pre><code>def normalize_merged_cells(raw):\n    schema = [\"r1\", \"c1\", \"r2\", \"c2\", \"v\"]\n    if isinstance(raw, list):\n        items = [[d.get(k, \" \") for k in schema] for d in raw]\n        return {\"schema\": schema, \"items\": items}\n    if isinstance(raw, dict) and \"schema\" in raw and \"items\" in raw:\n        return raw\n    return None\n</code></pre>"},{"location":"README.en/#llm-reconstruction-example","title":"LLM reconstruction example","text":"<pre><code>&lt;!-- This is a structured interpretation, not an official reproduction. --&gt;\n\n# **Federal Financial Report (FFR)**\n\n_(Follow form instructions)_\n\n---\n\n## **1. Federal Agency and Organizational Element**\n\n**United States Environmental Protection Agency**\n\n## **2. Federal Grant or Other Identifying Number Assigned by Federal Agency**\n\n**Page 1 of pages**\n\n---\n\n## **3. Recipient Organization**\n\n_(Name and complete address including Zip code)_\n\n---\n\n## **4. Recipient Identifiers**\n\n- **4a. DUNS Number**\n- **4b. EIN**\n- **5. Recipient Account Number or Identifying Number**  \n  _(To report multiple grants, use FFR Attachment)_\n- **6. Report Type**\n  - \u25a1 Quarterly\n  - \u25a1 Semi-Annual\n  - \u25a1 Annual\n  - \u25a1 Final\n- **7. Basis of Accounting**\n  - \u25a1 Cash\n  - \u25a1 Accrual\n\n---\n\n## **8. Project/Grant Period**\n\n- **From:** (Month, Day, Year)\n- **To:** (Month, Day, Year)\n\n## **9. Reporting Period End Date**\n\n(Month, Day, Year)\n\n---\n\n# **10. Transactions**\n\n_(Use lines a\u2013c for single or multiple grant reporting)_\n\n### **Federal Cash**\n\n_(To report multiple grants, also use FFR Attachment)_\n\n- **a. Cash Receipts**\n- **b. Cash Disbursements**\n- **c. Cash on Hand** (line a minus b)\n\n_(Use lines d\u2013o for single grant reporting)_\n\n### **Federal Expenditures and Unobligated Balance**\n\n- **d. Total Federal funds authorized**\n- **e. Federal share of expenditures**\n- **f. Federal share of unliquidated obligations** \u2014 0\n- **g. Total Federal share** (sum of lines e and f) \u2014 0\n- **h. Unobligated balance of Federal funds** (line d minus g) \u2014 0\n\n### **Recipient Share**\n\n- **i. Total recipient share required**\n- **j. Recipient share of expenditures**\n- **k. Remaining recipient share to be provided** (line i minus j) \u2014 0\n\n### **Program Income**\n\n- **l. Total Federal program income earned**\n- **m. Program income expended (deduction alternative)**\n- **n. Program income expended (addition alternative)**\n- **o. Unexpended program income** (line l minus line m or line n)\n\n---\n\n# **11. Indirect Expense**\n\n| Type           | Rate | Period From | Period To | Base | Amount Charged | Federal Share |\n| -------------- | ---- | ----------- | --------- | ---- | -------------- | ------------- |\n|                |      |             |           |      |                |               |\n| **g. Totals:** |      |             |           | 0    | 0              | 0             |\n\n---\n\n# **12. Remarks**\n\nAttach any explanations deemed necessary or information required by the Federal sponsoring agency in compliance with governing legislation.\n\n---\n\n# **13. Certification**\n\nBy signing this report, I certify that it is true, complete, and accurate to the best of my knowledge.  \nI am aware that any false, fictitious, or fraudulent information may subject me to criminal, civil, or administrative penalties.  \n_(U.S. Code, Title 18, Section 1001)_\n\n- **a. Typed or Printed Name and Title of Authorized Certifying Official**\n- **b. Signature of Authorized Certifying Official**\n- **c. Telephone** (Area code, number, extension)\n- **d. Email address**\n- **e. Date Report Submitted** (Month, Day, Year)\n\n---\n\n# **14. Agency Use Only**\n\n**Federal Share Calculation**\n\n---\n\n### **Standard Form 425**\n\n**OMB Approval Number:** 0348-0061  \n**Expiration Date:** 02/28/2015\n\n---\n\n# **Paperwork Burden Statement**\n\nAccording to the Paperwork Reduction Act, as amended, no persons are required to respond to a collection of information unless it displays a valid OMB Control Number.  \nThe valid OMB control number for this information collection is **0348-0061**.\n\nPublic reporting burden for this collection of information is estimated to average **1.5 hours per response**, including time for reviewing instructions, searching existing data sources, gathering and maintaining the data needed, and completing and reviewing the collection of information.\n\nSend comments regarding the burden estimate or any other aspect of this collection of information, including suggestions for reducing this burden, to:\n\n**Office of Management and Budget**  \nPaperwork Reduction Project (0348-0060)  \nWashington, DC 20503\n\n---\n\n### **Shape in Original Document**\n\n- _Not Required by EPA_\n</code></pre> <p>From this we can see:</p> <p>exstruct's JSON is already in a format that AI can read and reason over directly.</p> <p>Other LLM inference samples using this library can be found in the following directory:</p> <ul> <li>Basic Excel</li> <li>Flowchart</li> <li>Gantt Chart</li> <li>Application forms with many merged cells</li> </ul>"},{"location":"README.en/#4-summary","title":"4. Summary","text":"<p>This benchmark confirms exstruct can:</p> <ul> <li>Parse tables, charts, and shapes (flowcharts) simultaneously</li> <li>Convert the semantic structure of Excel into JSON</li> <li>Let AI/LLMs read that JSON directly and reconstruct the workbook contents</li> </ul> <p>In short, exstruct = \u201can engine that converts Excel into a format AI can understand.\u201d</p>"},{"location":"README.en/#notes","title":"Notes","text":"<ul> <li>Default JSON is compact to reduce tokens; use <code>--pretty</code> or <code>pretty=True</code> when readability matters.</li> <li>Field <code>table_candidates</code> replaces <code>tables</code>; adjust downstream consumers accordingly.</li> </ul>"},{"location":"README.en/#enterprise-use","title":"Enterprise Use","text":"<p>ExStruct is used primarily as a library, not a service.</p> <ul> <li>No official support or SLA is provided</li> <li>Long-term stability is prioritized over rapid feature growth</li> <li>Forking and internal modification are expected in enterprise use</li> </ul> <p>This project is suitable for teams that:</p> <ul> <li>need transparency over black-box tools</li> <li>are comfortable maintaining internal forks if necessary</li> </ul>"},{"location":"README.en/#print-areas-and-auto-page-breaks-printarea-printareaview","title":"Print Areas and Auto Page Breaks (PrintArea / PrintAreaView)","text":"<ul> <li><code>SheetData.print_areas</code> holds print areas (cell coordinates) in light/standard/verbose.</li> <li><code>SheetData.auto_print_areas</code> holds Excel COM-computed auto page-break areas when auto page-break extraction is enabled (COM only).</li> <li>Use <code>export_print_areas_as(...)</code> or CLI <code>--print-areas-dir</code> to write one file per print area (nothing is written if none exist).</li> <li>Use CLI <code>--auto-page-breaks-dir</code> (COM only), <code>DestinationOptions.auto_page_breaks_dir</code> (preferred), or <code>export_auto_page_breaks(...)</code> to write per-auto-page-break files; the API raises <code>ValueError</code> if no auto page breaks exist.</li> <li><code>PrintAreaView</code> includes rows and table candidates inside the area, plus shapes/charts that overlap the area (size-less shapes are treated as points). <code>normalize=True</code> rebases row/col indices to the area origin.</li> </ul>"},{"location":"README.en/#documentation-build","title":"Documentation build","text":"<ul> <li>Update generated model docs before building the site: <code>python scripts/gen_model_docs.py</code>.</li> <li>Build locally with mkdocs + mkdocstrings (dev deps required): <code>uv run mkdocs serve</code> or <code>uv run mkdocs build</code>.</li> </ul>"},{"location":"README.en/#architecture","title":"Architecture","text":"<p>ExStruct uses a pipeline-based architecture that separates extraction strategy (Backend) from orchestration (Pipeline) and semantic modeling.</p> <p>\u2192 See: docs/architecture/pipeline.md</p>"},{"location":"README.en/#contributing","title":"Contributing","text":"<p>If you plan to extend ExStruct internals, please read the contributor architecture guide.</p> <p>\u2192 docs/contributors/architecture.md</p>"},{"location":"README.en/#note-on-coverage","title":"Note on coverage","text":"<p>The cell-structure inference logic (cells.py) relies on heuristic rules and Excel-specific behaviors. Full coverage is intentionally not pursued, as exhaustive testing would not reflect real-world reliability.</p>"},{"location":"README.en/#license","title":"License","text":"<p>BSD-3-Clause. See <code>LICENSE</code> for details.</p>"},{"location":"README.en/#documentation","title":"Documentation","text":"<ul> <li>API Reference (GitHub Pages): https://harumiweb.github.io/exstruct/</li> <li>JSON Schemas: see <code>schemas/</code> (one file per model); regenerate via <code>python scripts/gen_json_schema.py</code>.</li> </ul>"},{"location":"README.ja/","title":"ExStruct \u2014 Excel \u69cb\u9020\u5316\u62bd\u51fa\u30a8\u30f3\u30b8\u30f3","text":"<p>ExStruct \u306f Excel \u30ef\u30fc\u30af\u30d6\u30c3\u30af\u3092\u8aad\u307f\u53d6\u308a\u3001\u69cb\u9020\u5316\u30c7\u30fc\u30bf\uff08\u30bb\u30eb\u30fb\u30c6\u30fc\u30d6\u30eb\u5019\u88dc\u30fb\u56f3\u5f62\u30fb\u30c1\u30e3\u30fc\u30c8\u30fbSmartArt\u30fb\u5370\u5237\u7bc4\u56f2\u30d3\u30e5\u30fc\uff09\u3092\u30c7\u30d5\u30a9\u30eb\u30c8\u3067 JSON \u306b\u51fa\u529b\u3057\u307e\u3059\u3002\u5fc5\u8981\u306b\u5fdc\u3058\u3066 YAML/TOON \u3082\u9078\u629e\u3067\u304d\u3001COM/Excel \u74b0\u5883\u3067\u306f\u30ea\u30c3\u30c1\u62bd\u51fa\u3001\u975e COM \u74b0\u5883\u3067\u306f\u30bb\u30eb\uff0b\u30c6\u30fc\u30d6\u30eb\u5019\u88dc\uff0b\u5370\u5237\u7bc4\u56f2\u3078\u306e\u30d5\u30a9\u30fc\u30eb\u30d0\u30c3\u30af\u3067\u5b89\u5168\u306b\u52d5\u4f5c\u3057\u307e\u3059\u3002LLM/RAG \u5411\u3051\u306b\u691c\u51fa\u30d2\u30e5\u30fc\u30ea\u30b9\u30c6\u30a3\u30c3\u30af\u3084\u51fa\u529b\u30e2\u30fc\u30c9\u3092\u8abf\u6574\u53ef\u80fd\u3067\u3059\u3002</p>"},{"location":"README.ja/#_1","title":"\u4e3b\u306a\u7279\u5fb4","text":"<ul> <li>Excel \u2192 \u69cb\u9020\u5316 JSON: \u30bb\u30eb\u3001\u56f3\u5f62\u3001\u30c1\u30e3\u30fc\u30c8\u3001SmartArt\u3001\u30c6\u30fc\u30d6\u30eb\u5019\u88dc\u3001\u30bb\u30eb\u7d50\u5408\u7bc4\u56f2\u3001\u5370\u5237\u7bc4\u56f2/\u81ea\u52d5\u6539\u30da\u30fc\u30b8\u7bc4\u56f2\uff08PrintArea/PrintAreaView\uff09\u3092\u30b7\u30fc\u30c8\u5358\u4f4d\u30fb\u7bc4\u56f2\u5358\u4f4d\u3067\u51fa\u529b\u3002</li> <li>\u51fa\u529b\u30e2\u30fc\u30c9: <code>light</code>\uff08\u30bb\u30eb\uff0b\u30c6\u30fc\u30d6\u30eb\u5019\u88dc\u306e\u307f\uff09\u3001<code>standard</code>\uff08\u30c6\u30ad\u30b9\u30c8\u4ed8\u304d\u56f3\u5f62\uff0b\u77e2\u5370\u3001\u30c1\u30e3\u30fc\u30c8\u3001SmartArt\u3001\u30bb\u30eb\u7d50\u5408\u7bc4\u56f2\uff09\u3001<code>verbose</code>\uff08\u5168\u56f3\u5f62\u3092\u5e45\u9ad8\u3055\u4ed8\u304d\u3067\u51fa\u529b\u3001\u30bb\u30eb\u306e\u30cf\u30a4\u30d1\u30fc\u30ea\u30f3\u30af/<code>colors_map</code>/<code>formulas_map</code>\u3082\u51fa\u529b\uff09\u3002</li> <li>\u6570\u5f0f\u53d6\u5f97: <code>formulas_map</code>\uff08\u6570\u5f0f\u6587\u5b57\u5217 \u2192 \u30bb\u30eb\u5ea7\u6a19\uff09\u3092 openpyxl/COM \u3067\u53d6\u5f97\u3002<code>verbose</code> \u65e2\u5b9a\u3001<code>include_formulas_map</code> \u3067\u5236\u5fa1\u3002</li> <li>\u30d5\u30a9\u30fc\u30de\u30c3\u30c8: JSON\uff08\u30c7\u30d5\u30a9\u30eb\u30c8\u306f\u30b3\u30f3\u30d1\u30af\u30c8\u3001<code>--pretty</code> \u3067\u6574\u5f62\uff09\u3001YAML\u3001TOON\uff08\u4efb\u610f\u4f9d\u5b58\uff09\u3002</li> <li>\u30c6\u30fc\u30d6\u30eb\u691c\u51fa\u306e\u30c1\u30e5\u30fc\u30cb\u30f3\u30b0: API \u3067\u30d2\u30e5\u30fc\u30ea\u30b9\u30c6\u30a3\u30c3\u30af\u3092\u52d5\u7684\u306b\u5909\u66f4\u53ef\u80fd\u3002</li> <li>\u30cf\u30a4\u30d1\u30fc\u30ea\u30f3\u30af\u62bd\u51fa: <code>verbose</code> \u30e2\u30fc\u30c9\uff08\u307e\u305f\u306f <code>include_cell_links=True</code> \u6307\u5b9a\uff09\u3067\u30bb\u30eb\u306e\u30ea\u30f3\u30af\u3092 <code>links</code> \u306b\u51fa\u529b\u3002</li> <li>CLI \u30ec\u30f3\u30c0\u30ea\u30f3\u30b0\uff08Excel \u5fc5\u9808\uff09: PDF \u3068\u30b7\u30fc\u30c8\u753b\u50cf\u3092\u751f\u6210\u53ef\u80fd\u3002</li> <li>\u5b89\u5168\u306a\u30d5\u30a9\u30fc\u30eb\u30d0\u30c3\u30af: Excel COM \u4e0d\u5728\u3067\u3082\u30d7\u30ed\u30bb\u30b9\u306f\u843d\u3061\u305a\u3001\u30bb\u30eb\uff0b\u30c6\u30fc\u30d6\u30eb\u5019\u88dc\uff0b\u5370\u5237\u7bc4\u56f2\u306b\u5207\u308a\u66ff\u3048\uff08\u56f3\u5f62\u30fb\u30c1\u30e3\u30fc\u30c8\u306f\u7a7a\uff09\u3002</li> </ul>"},{"location":"README.ja/#_2","title":"\u30d9\u30f3\u30c1\u30de\u30fc\u30af","text":"<p>\u3053\u306e\u30ea\u30dd\u30b8\u30c8\u30ea\u306b\u306f\u3001Excel\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u306eRAG/LLM\u524d\u51e6\u7406\u306b\u7126\u70b9\u3092\u5f53\u3066\u305f\u30d9\u30f3\u30c1\u30de\u30fc\u30af\u30ec\u30dd\u30fc\u30c8\u304c\u542b\u307e\u308c\u3066\u3044\u307e\u3059\u3002 \u79c1\u305f\u3061\u306f2\u3064\u306e\u8996\u70b9\u304b\u3089\u8ffd\u8de1\u3057\u3066\u3044\u307e\u3059\u3002(1) \u30b3\u30a2\u62bd\u51fa\u7cbe\u5ea6\u3068 (2) \u4e0b\u6d41\u69cb\u9020\u30af\u30a8\u30ea\u306e\u305f\u3081\u306e\u518d\u69cb\u7bc9\u30e6\u30fc\u30c6\u30a3\u30ea\u30c6\u30a3 (RUB) \u3067\u3059\u3002 \u4f5c\u696d\u30b5\u30de\u30ea\u30fc\u306b\u3064\u3044\u3066\u306f<code>benchmark/REPORT.md</code>\u3092\u3001\u516c\u958b\u30d0\u30f3\u30c9\u30eb\u306b\u3064\u3044\u3066\u306f<code>benchmark/public/REPORT.md</code>\u3092\u53c2\u7167\u3057\u3066\u304f\u3060\u3055\u3044\u3002 \u73fe\u5728\u306e\u7d50\u679c\u306fn=12\u306e\u30b1\u30fc\u30b9\u306b\u57fa\u3065\u3044\u3066\u304a\u308a\u3001\u4eca\u5f8c\u3055\u3089\u306b\u62e1\u5f35\u3055\u308c\u308b\u4e88\u5b9a\u3067\u3059\u3002</p>"},{"location":"README.ja/#_3","title":"\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb","text":"<pre><code>pip install exstruct\n</code></pre> <p>\u30aa\u30d7\u30b7\u30e7\u30f3\u4f9d\u5b58:</p> <ul> <li>YAML: <code>pip install pyyaml</code></li> <li>TOON: <code>pip install python-toon</code></li> <li>\u30ec\u30f3\u30c0\u30ea\u30f3\u30b0\uff08PDF/PNG\uff09: Excel + <code>pip install pypdfium2 pillow</code></li> <li>\u307e\u3068\u3081\u3066\u5c0e\u5165: <code>pip install exstruct[yaml,toon,render]</code></li> </ul> <p>\u30d7\u30e9\u30c3\u30c8\u30d5\u30a9\u30fc\u30e0\u6ce8\u610f:</p> <ul> <li>\u56f3\u5f62\u30fb\u30c1\u30e3\u30fc\u30c8\u3092\u542b\u3080\u30d5\u30eb\u62bd\u51fa\u306f Windows + Excel (xlwings/COM) \u524d\u63d0\u3002\u305d\u306e\u4ed6\u30d7\u30e9\u30c3\u30c8\u30d5\u30a9\u30fc\u30e0\u3067\u306f <code>mode=light</code> \u3067\u30bb\u30eb\uff0b<code>table_candidates</code> \u306e\u307f\u5b89\u5168\u306b\u53d6\u5f97\u3067\u304d\u307e\u3059\u3002</li> </ul>"},{"location":"README.ja/#cli","title":"\u30af\u30a4\u30c3\u30af\u30b9\u30bf\u30fc\u30c8 CLI","text":"<pre><code>exstruct input.xlsx &gt; output.json          # \u30c7\u30d5\u30a9\u30eb\u30c8\u306f\u6a19\u6e96\u51fa\u529b\u306e\u30b3\u30f3\u30d1\u30af\u30c8 JSON\nexstruct input.xlsx -o out.json --pretty   # \u6574\u5f62 JSON \u3092\u30d5\u30a1\u30a4\u30eb\u3078\nexstruct input.xlsx --format yaml          # YAML\uff08pyyaml \u304c\u5fc5\u8981\uff09\nexstruct input.xlsx --format toon          # TOON\uff08python-toon \u304c\u5fc5\u8981\uff09\nexstruct input.xlsx --sheets-dir sheets/   # \u30b7\u30fc\u30c8\u3054\u3068\u306b\u5206\u5272\u51fa\u529b\nexstruct input.xlsx --auto-page-breaks-dir auto_areas/  # COM \u9650\u5b9a\uff08\u5229\u7528\u53ef\u80fd\u306a\u74b0\u5883\u306e\u307f\u8868\u793a\uff09\nexstruct input.xlsx --mode light           # \u30bb\u30eb\uff0b\u30c6\u30fc\u30d6\u30eb\u5019\u88dc\u306e\u307f\nexstruct input.xlsx --pdf --image          # PDF \u3068 PNG\uff08Excel \u5fc5\u9808\uff09\n</code></pre> <p>\u81ea\u52d5\u6539\u30da\u30fc\u30b8\u7bc4\u56f2\u306e\u66f8\u304d\u51fa\u3057\u306f API/CLI \u4e21\u65b9\u306b\u5bfe\u5fdc\uff08Excel/COM \u304c\u5fc5\u8981\uff09\u3057\u3001CLI \u306f\u5229\u7528\u53ef\u80fd\u306a\u74b0\u5883\u3067\u306e\u307f <code>--auto-page-breaks-dir</code> \u3092\u8868\u793a\u3057\u307e\u3059\u3002</p>"},{"location":"README.ja/#mcp","title":"MCP\u30b5\u30fc\u30d0\u30fc (\u6a19\u6e96\u5165\u51fa\u529b)","text":"<p>MCP\u306e\u62e1\u5f35\u6a5f\u80fd\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u3001\u6a19\u6e96\u5165\u51fa\u529b\u30b5\u30fc\u30d0\u30fc\u3092\u5b9f\u884c\u3057\u307e\u3059\u3002</p> <pre><code>pip install exstruct[mcp]\nexstruct-mcp --root C:\\data --log-file C:\\logs\\exstruct-mcp.log --on-conflict rename\n</code></pre> <p>\u5229\u7528\u53ef\u80fd\u306a\u30c4\u30fc\u30eb:</p> <ul> <li><code>exstruct_extract</code></li> <li><code>exstruct_read_json_chunk</code></li> <li><code>exstruct_validate_input</code></li> </ul> <p>\u6ce8\u610f\u70b9:</p> <ul> <li>\u6a19\u6e96\u5165\u51fa\u529b\u306e\u5fdc\u7b54\u3092\u6c5a\u67d3\u3057\u306a\u3044\u3088\u3046\u3001\u30ed\u30b0\u306f\u6a19\u6e96\u30a8\u30e9\u30fc\u51fa\u529b\uff08\u304a\u3088\u3073\u30aa\u30d7\u30b7\u30e7\u30f3\u3067<code>--log-file</code>\u3067\u6307\u5b9a\u3057\u305f\u30d5\u30a1\u30a4\u30eb\uff09\u306b\u51fa\u529b\u3055\u308c\u307e\u3059\u3002</li> <li>Windows\u306eExcel\u74b0\u5883\u3067\u306f\u3001\u6a19\u6e96/\u8a73\u7d30\u30e2\u30fc\u30c9\u3067COM\u3092\u5229\u7528\u3057\u3066\u3001\u3088\u308a\u30ea\u30c3\u30c1\u306a\u62bd\u51fa\u304c\u53ef\u80fd\u3067\u3059\u3002Windows\u4ee5\u5916\u3067\u306fCOM\u306f\u5229\u7528\u3067\u304d\u305a\u3001\u62bd\u51fa\u306fopenpyxl\u30d9\u30fc\u30b9\u306e\u30d5\u30a9\u30fc\u30eb\u30d0\u30c3\u30af\u6a5f\u80fd\u3092\u4f7f\u7528\u3057\u307e\u3059\u3002</li> </ul> <p>\u5404AI\u30a8\u30fc\u30b8\u30a7\u30f3\u30c8\u3067\u306eMCP\u8a2d\u5b9a\u30ac\u30a4\u30c9:</p> <p>MCP\u30b5\u30fc\u30d0\u30fc</p>"},{"location":"README.ja/#python","title":"\u30af\u30a4\u30c3\u30af\u30b9\u30bf\u30fc\u30c8 Python","text":"<pre><code>from pathlib import Path\nfrom exstruct import extract, export, set_table_detection_params\n\n# \u30c6\u30fc\u30d6\u30eb\u691c\u51fa\u3092\u8abf\u6574\uff08\u4efb\u610f\uff09\nset_table_detection_params(table_score_threshold=0.3, density_min=0.04)\n\n# \u30e2\u30fc\u30c9: \"light\" / \"standard\" / \"verbose\"\nwb = extract(\"input.xlsx\", mode=\"standard\")  # standard \u3067\u306f\u30ea\u30f3\u30af\u306f\u30c7\u30d5\u30a9\u30eb\u30c8\u975e\u51fa\u529b\nexport(wb, Path(\"out.json\"), pretty=False)  # \u30b3\u30f3\u30d1\u30af\u30c8 JSON\n\n# \u30e2\u30c7\u30eb\u306e\u4fbf\u5229\u30e1\u30bd\u30c3\u30c9: \u53cd\u5fa9\u30fb\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u30fb\u76f4\u5217\u5316\nfirst_sheet = wb[\"Sheet1\"]           # __getitem__ \u3067\u30b7\u30fc\u30c8\u53d6\u5f97\nfor name, sheet in wb:               # __iter__ \u3067 (name, SheetData) \u3092\u5217\u6319\n    print(name, len(sheet.rows))\nwb.save(\"out.json\", pretty=True)     # WorkbookData \u3092\u62e1\u5f35\u5b50\u306b\u5fdc\u3058\u3066\u4fdd\u5b58\nfirst_sheet.save(\"sheet.json\")       # SheetData \u3082\u540c\u69d8\u306b\u4fdd\u5b58\nprint(first_sheet.to_yaml())         # YAML \u6587\u5b57\u5217\uff08pyyaml \u5fc5\u9808\uff09\n\n# ExStructEngine: \u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u3054\u3068\u306e\u8a2d\u5b9a\uff08\u30cd\u30b9\u30c8\u69cb\u9020\uff09\nfrom exstruct import (\n    DestinationOptions,\n    ExStructEngine,\n    FilterOptions,\n    FormatOptions,\n    OutputOptions,\n    StructOptions,\n    export_auto_page_breaks,\n)\n\nengine = ExStructEngine(\n    options=StructOptions(mode=\"verbose\"),  # verbose \u3067\u306f\u30cf\u30a4\u30d1\u30fc\u30ea\u30f3\u30af\u304c\u30c7\u30d5\u30a9\u30eb\u30c8\u3067\u542b\u307e\u308c\u308b\n    output=OutputOptions(\n        format=FormatOptions(pretty=True),\n        filters=FilterOptions(include_shapes=False),  # \u56f3\u5f62\u3092\u51fa\u529b\u304b\u3089\u9664\u5916\n        destinations=DestinationOptions(sheets_dir=Path(\"out_sheets\")),  # \u30b7\u30fc\u30c8\u3054\u3068\u306b\u4fdd\u5b58\n    ),\n)\nwb2 = engine.extract(\"input.xlsx\")\nengine.export(wb2, Path(\"out_filtered.json\"))  # \u30d5\u30a3\u30eb\u30bf\u9069\u7528\u5f8c\u306e\u51fa\u529b\n\n# standard \u3067\u30cf\u30a4\u30d1\u30fc\u30ea\u30f3\u30af\u3092\u6709\u52b9\u5316\nengine_links = ExStructEngine(options=StructOptions(mode=\"standard\", include_cell_links=True))\nwith_links = engine_links.extract(\"input.xlsx\")\n\n# \u5370\u5237\u7bc4\u56f2\u3054\u3068\u306b\u66f8\u304d\u51fa\u3059\nfrom exstruct import export_print_areas_as\nexport_print_areas_as(wb, \"areas\", fmt=\"json\", pretty=True)  # \u5370\u5237\u7bc4\u56f2\u304c\u3042\u308b\u5834\u5408\u306e\u307f\u30d5\u30a1\u30a4\u30eb\u751f\u6210\n\n# \u81ea\u52d5\u6539\u30da\u30fc\u30b8\u7bc4\u56f2\u306e\u62bd\u51fa/\u51fa\u529b\uff08COM \u9650\u5b9a\u3002\u81ea\u52d5\u6539\u30da\u30fc\u30b8\u304c\u7121\u3044\u5834\u5408\u306f\u4f8b\u5916\u3092\u9001\u51fa\uff09\nengine_auto = ExStructEngine(\n    output=OutputOptions(\n        destinations=DestinationOptions(auto_page_breaks_dir=Path(\"auto_areas\"))\n    )\n)\nwb_auto = engine_auto.extract(\"input.xlsx\")  # SheetData.auto_print_areas \u3092\u542b\u3080\nengine_auto.export(wb_auto, Path(\"out_with_auto.json\"))  # \u81ea\u52d5\u6539\u30da\u30fc\u30b8\u3054\u3068\u306e\u30d5\u30a1\u30a4\u30eb\u3082 auto_areas/* \u306b\u4fdd\u5b58\nexport_auto_page_breaks(wb_auto, \"auto_areas\", fmt=\"json\", pretty=True)\n</code></pre> <p>\u5099\u8003 (COM \u975e\u5bfe\u5fdc\u74b0\u5883): Excel COM \u304c\u4f7f\u3048\u306a\u3044\u5834\u5408\u3067\u3082\u30bb\u30eb\uff0b<code>table_candidates</code> \u306f\u8fd4\u308a\u307e\u3059\u304c\u3001<code>shapes</code> / <code>charts</code> \u306f\u7a7a\u306b\u306a\u308a\u307e\u3059\u3002</p>"},{"location":"README.ja/#_4","title":"\u30c6\u30fc\u30d6\u30eb\u691c\u51fa\u30d1\u30e9\u30e1\u30fc\u30bf","text":"<pre><code>from exstruct import set_table_detection_params\n\nset_table_detection_params(\n    table_score_threshold=0.35,  # \u53b3\u3057\u304f\u3059\u308b\u306a\u3089\u4e0a\u3052\u308b\n    density_min=0.05,\n    coverage_min=0.2,\n    min_nonempty_cells=3,\n)\n</code></pre> <p>\u5024\u3092\u4e0a\u3052\u308b\u3068\u8aa4\u691c\u77e5\u304c\u6e1b\u308a\u3001\u4e0b\u3052\u308b\u3068\u691c\u51fa\u6f0f\u308c\u304c\u6e1b\u308a\u307e\u3059\u3002</p>"},{"location":"README.ja/#_5","title":"\u51fa\u529b\u30e2\u30fc\u30c9","text":"<ul> <li>light: \u30bb\u30eb\uff0b\u30c6\u30fc\u30d6\u30eb\u5019\u88dc\u306e\u307f\uff08COM \u4e0d\u8981\uff09\u3002</li> <li>standard: \u30c6\u30ad\u30b9\u30c8\u4ed8\u304d\u56f3\u5f62\uff0b\u77e2\u5370\u3001\u30c1\u30e3\u30fc\u30c8\uff08COM \u3042\u308a\u3067\u53d6\u5f97\uff09\u3001\u30c6\u30fc\u30d6\u30eb\u5019\u88dc\u3002\u30bb\u30eb\u306e\u30cf\u30a4\u30d1\u30fc\u30ea\u30f3\u30af\u306f <code>include_cell_links=True</code> \u3092\u6307\u5b9a\u3057\u305f\u3068\u304d\u306e\u307f\u51fa\u529b\u3002</li> <li>verbose: \u5168\u56f3\u5f62\uff08\u5e45\u9ad8\u3055\u4ed8\u304d\uff09\u3001\u30c1\u30e3\u30fc\u30c8\u3001<code>table_candidates</code>\u3001\u30cf\u30a4\u30d1\u30fc\u30ea\u30f3\u30af\u3001<code>colors_map</code>\u3001<code>formulas_map</code> \u3092\u51fa\u529b\u3002</li> </ul>"},{"location":"README.ja/#_6","title":"\u30a8\u30e9\u30fc\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0 / \u30d5\u30a9\u30fc\u30eb\u30d0\u30c3\u30af","text":"<ul> <li>Excel COM \u4e0d\u5728\u6642\u306f\u30bb\u30eb\uff0b\u30c6\u30fc\u30d6\u30eb\u5019\u88dc\u306b\u81ea\u52d5\u30d5\u30a9\u30fc\u30eb\u30d0\u30c3\u30af\uff08\u56f3\u5f62\u30fb\u30c1\u30e3\u30fc\u30c8\u306f\u7a7a\uff09\u3002</li> <li>\u56f3\u5f62\u62bd\u51fa\u5931\u6557\u6642\u3082\u8b66\u544a\u3092\u51fa\u3057\u3064\u3064\u30bb\u30eb\uff0b\u30c6\u30fc\u30d6\u30eb\u5019\u88dc\u3092\u8fd4\u5374\u3002</li> <li>CLI \u306f\u30a8\u30e9\u30fc\u3092 stdout/stderr \u306b\u51fa\u3057\u3001\u5931\u6557\u6642\u306f\u975e\u30bc\u30ed\u7d42\u4e86\u30b3\u30fc\u30c9\u3002</li> </ul>"},{"location":"README.ja/#_7","title":"\u4efb\u610f\u30ec\u30f3\u30c0\u30ea\u30f3\u30b0","text":"<p>Excel \u3068 <code>pypdfium2</code> \u304c\u5fc5\u8981\u3067\u3059:</p> <pre><code>exstruct input.xlsx --pdf --image --dpi 144\n</code></pre> <p><code>&lt;output&gt;.pdf</code> \u3068 <code>&lt;output&gt;_images/</code> \u914d\u4e0b\u306b PNG \u3092\u751f\u6210\u3057\u307e\u3059\u3002</p>"},{"location":"README.ja/#1-excel","title":"\u4f8b \u2460: Excel \u69cb\u9020\u5316\u30c7\u30e2","text":"<p>\u672c\u30e9\u30a4\u30d6\u30e9\u30ea exstruct \u304c\u3069\u306e\u7a0b\u5ea6 Excel \u3092\u69cb\u9020\u5316\u3067\u304d\u308b\u306e\u304b\u3092\u793a\u3059\u305f\u3081\u3001 \u4ee5\u4e0b\u306e 3 \u8981\u7d20\u3092 1 \u30b7\u30fc\u30c8\u306b\u307e\u3068\u3081\u305f Excel \u3092\u89e3\u6790\u3057\u3001 \u305d\u306e JSON \u51fa\u529b\u3092\u7528\u3044\u305f LLM \u63a8\u8ad6\u4f8b \u3092\u63b2\u8f09\u3057\u307e\u3059\u3002</p> <ul> <li>\u8868\uff08\u58f2\u4e0a\u30c7\u30fc\u30bf\uff09</li> <li>\u6298\u308c\u7dda\u30b0\u30e9\u30d5</li> <li>\u56f3\u5f62\u306e\u307f\u3067\u4f5c\u6210\u3057\u305f\u30d5\u30ed\u30fc\u30c1\u30e3\u30fc\u30c8</li> </ul> <p>\uff08\u4e0b\u753b\u50cf\u304c\u5b9f\u969b\u306e\u30b5\u30f3\u30d7\u30eb Excel \u30b7\u30fc\u30c8\uff09  \u30b5\u30f3\u30d7\u30eb Excel: <code>sample/sample.xlsx</code></p>"},{"location":"README.ja/#1-input-excel-sheet-overview","title":"1. Input: Excel Sheet Overview","text":"<p>\u3053\u306e\u30b5\u30f3\u30d7\u30eb Excel \u306b\u306f\u4ee5\u4e0b\u306e\u30c7\u30fc\u30bf\u304c\u542b\u307e\u308c\u3066\u3044\u307e\u3059\uff1a</p>"},{"location":"README.ja/#1","title":"\u2460 \u8868 (\u58f2\u4e0a\u30c7\u30fc\u30bf)","text":"\u6708 \u88fd\u54c1 A \u88fd\u54c1 B \u88fd\u54c1 C Jan-25 120 80 60 Feb-25 135 90 64 Mar-25 150 100 70 Apr-25 170 110 72 May-25 160 120 75 Jun-25 180 130 80"},{"location":"README.ja/#2","title":"\u2461 \u30b0\u30e9\u30d5 (\u6298\u308c\u7dda\u30b0\u30e9\u30d5)","text":"<ul> <li>\u30bf\u30a4\u30c8\u30eb: \u58f2\u4e0a\u30c7\u30fc\u30bf</li> <li>\u7cfb\u5217: \u88fd\u54c1 A / \u88fd\u54c1 B / \u88fd\u54c1 C\uff08\u534a\u5e74\u5206\uff09</li> <li>Y \u8ef8: 0\u2013200</li> </ul>"},{"location":"README.ja/#3","title":"\u2462 \u56f3\u5f62\u306b\u3088\u308b\u30d5\u30ed\u30fc\u30c1\u30e3\u30fc\u30c8","text":"<p>\u30b7\u30fc\u30c8\u5185\u306b\u4ee5\u4e0b\u3092\u542b\u3080\u30d5\u30ed\u30fc\u304c\u3042\u308a\u307e\u3059\uff1a</p> <ul> <li>\u958b\u59cb / \u7d42\u4e86</li> <li>\u5f62\u5f0f\u30c1\u30a7\u30c3\u30af</li> <li>\u30eb\u30fc\u30d7\uff08\u6b8b\u4ef6\u3042\u308a\uff1f\uff09</li> <li>\u30a8\u30e9\u30fc\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0</li> <li>\u30e1\u30fc\u30eb\u9001\u4fe1\u306e Yes/No \u5224\u5b9a</li> </ul>"},{"location":"README.ja/#2-output-exstruct-json","title":"2. Output: exstruct \u304c\u751f\u6210\u3059\u308b\u69cb\u9020\u5316 JSON\uff08\u629c\u7c8b\uff09","text":"<p>\u4ee5\u4e0b\u306f\u3001\u5b9f\u969b\u306b\u3053\u306e Excel \u30d6\u30c3\u30af\u3092\u89e3\u6790\u3057\u305f\u969b\u306e\u77ed\u7e2e\u7248 JSON \u51fa\u529b\u4f8b \u3067\u3059\u3002</p> <pre><code>{\n  \"book_name\": \"sample.xlsx\",\n  \"sheets\": {\n    \"Sheet1\": {\n      \"rows\": [\n        {\n          \"r\": 3,\n          \"c\": {\n            \"1\": \"\u6708\",\n            \"2\": \"\u88fd\u54c1A\",\n            \"3\": \"\u88fd\u54c1B\",\n            \"4\": \"\u88fd\u54c1C\"\n          }\n        },\n        ...\n      ],\n      \"shapes\": [\n        {\n          \"id\": 1,\n          \"text\": \"\u958b\u59cb\",\n          \"l\": 148,\n          \"t\": 220,\n          \"kind\": \"shape\",\n          \"type\": \"AutoShape-FlowchartProcess\"\n        },\n        {\n          \"id\": 2,\n          \"text\": \"\u5165\u529b\u30c7\u30fc\u30bf\u8aad\u307f\u8fbc\u307f\",\n          \"l\": 132,\n          \"t\": 282,\n          \"kind\": \"shape\",\n          \"type\": \"AutoShape-FlowchartProcess\"\n        },\n        {\n          \"l\": 193,\n          \"t\": 246,\n          \"kind\": \"arrow\",\n          \"begin_arrow_style\": 1,\n          \"end_arrow_style\": 2,\n          \"begin_id\": 1,\n          \"end_id\": 2,\n          \"direction\": \"N\"\n        },\n        ...\n      ],\n      \"charts\": [\n        {\n          \"name\": \"Chart 1\",\n          \"chart_type\": \"Line\",\n          \"title\": \"\u58f2\u4e0a\u30c7\u30fc\u30bf\",\n          \"y_axis_range\": [\n            0.0,\n            200.0\n          ],\n          \"series\": [\n            {\n              \"name\": \"\u88fd\u54c1A\",\n              \"name_range\": \"Sheet1!$C$3\",\n              \"x_range\": \"Sheet1!$B$4:$B$9\",\n              \"y_range\": \"Sheet1!$C$4:$C$9\"\n            },\n            ...\n          ],\n          \"l\": 377,\n          \"t\": 25\n        }\n      ],\n      \"table_candidates\": [\n        \"B3:E9\"\n      ]\n    }\n  }\n}\n</code></pre>"},{"location":"README.ja/#3-ai-copilot-llm-json","title":"3. AI (Copilot / LLM) \u306b JSON \u3092\u6e21\u3057\u305f\u969b\u306e\u7406\u89e3\u7d50\u679c","text":"<pre><code>\u4ee5\u4e0b\u306f\u3001\u63d0\u4f9b\u3055\u308c\u305f Excel \u30d6\u30c3\u30af\u306e\u5185\u5bb9\u3092 Markdown \u5f62\u5f0f\u3067\u518d\u69cb\u6210\u3057\u305f\u3082\u306e\u3067\u3059\u3002\u8868\u3001\u30b0\u30e9\u30d5\u3001\u30d5\u30ed\u30fc\u30c1\u30e3\u30fc\u30c8\u306e 3 \u8981\u7d20\u3092\u305d\u308c\u305e\u308c\u9069\u5207\u306b\u8868\u73fe\u3057\u3066\u3044\u307e\u3059\u3002\n\n---\n\n## \ud83d\udcca \u58f2\u4e0a\u30c7\u30fc\u30bf\u8868\n\n| \u6708         | \u88fd\u54c1 A | \u88fd\u54c1 B | \u88fd\u54c1 C |\n| ---------- | ------ | ------ | ------ |\n| 2025-01-01 | 120    | 80     | 60     |\n| 2025-02-01 | 135    | 90     | 64     |\n| 2025-03-01 | 150    | 100    | 70     |\n| 2025-04-01 | 170    | 110    | 72     |\n| 2025-05-01 | 160    | 120    | 75     |\n| 2025-06-01 | 180    | 130    | 80     |\n\n---\n\n## \ud83d\udcc8 \u58f2\u4e0a\u30c7\u30fc\u30bf\uff08\u6298\u308c\u7dda\u30b0\u30e9\u30d5\uff09\n\n- \u30b0\u30e9\u30d5\u30bf\u30a4\u30c8\u30eb: **\u58f2\u4e0a\u30c7\u30fc\u30bf**\n- \u30b0\u30e9\u30d5\u7a2e\u985e: \u6298\u308c\u7dda\u30b0\u30e9\u30d5\uff08Line\uff09\n- Y \u8ef8\u7bc4\u56f2: 0 \uff5e 200\n- \u30c7\u30fc\u30bf\u7cfb\u5217:\n  - \u88fd\u54c1 A: 120 \u2192 135 \u2192 150 \u2192 170 \u2192 160 \u2192 180\n  - \u88fd\u54c1 B: 80 \u2192 90 \u2192 100 \u2192 110 \u2192 120 \u2192 130\n  - \u88fd\u54c1 C: 60 \u2192 64 \u2192 70 \u2192 72 \u2192 75 \u2192 80\n\n---\n\n## \ud83d\udd04 \u51e6\u7406\u30d5\u30ed\u30fc\uff08Mermaid \u30d5\u30ed\u30fc\u30c1\u30e3\u30fc\u30c8\uff09\n\n```mermaid\nflowchart TD\n    A[\u958b\u59cb]\n    B[\u5165\u529b\u30c7\u30fc\u30bf\u8aad\u307f\u8fbc\u307f]\n    C{\u5f62\u5f0f\u306f\u6b63\u3057\u3044\uff1f}\n    D[1\u4ef6\u51e6\u7406]\n    E{\u6b8b\u4ef6\u3042\u308a\uff1f}\n    F[\u51fa\u529b\u3092\u751f\u6210]\n    G{\u30e1\u30fc\u30eb\u9001\u4fe1\uff1f}\n    H[\u30a8\u30e9\u30fc\u8868\u793a]\n    I[\u30e1\u30fc\u30eb\u9001\u4fe1]\n    J[\u7d42\u4e86]\n\n    A --&gt; B\n    B --&gt; C\n    C --&gt;|\u306f\u3044| D\n    C --&gt; H\n    D --&gt; E\n    E --&gt; F\n    F --&gt; G\n    G --&gt;|\u306f\u3044| I\n    G --&gt;|\u3044\u3044\u3048| J\n    H --&gt; J\n    I --&gt; J\n```\n</code></pre>"},{"location":"README.ja/#2_1","title":"\u4f8b \u2461: \u4e00\u822c\u7684\u306a\u7533\u8acb\u66f8","text":""},{"location":"README.ja/#excel","title":"Excel \u30c7\u30fc\u30bf","text":""},{"location":"README.ja/#exstruct-json","title":"ExStruct JSON","text":"<p>\u203b\u9577\u3044\u306e\u3067\u4e00\u90e8\u7701\u7565</p> <pre><code>{\n  \"book_name\": \"ja_form.xlsx\",\n  \"sheets\": {\n    \"Sheet1\": {\n      \"rows\": [\n        { \"r\": 1, \"c\": { \"0\": \"\u4ecb\u8b77\u4fdd\u967a\u8ca0\u62c5\u9650\u5ea6\u984d\u8a8d\u5b9a\u7533\u8acb\u66f8\" } },\n        {\n          \"r\": 3,\n          \"c\": { \"0\": \"\uff08\u7533\u8acb\u5148\uff09\", \"7\": \"  \u3000\u3000\u3000\u3000\u5e74\u3000\u3000\u3000\u3000\u6708\u3000\u3000\u3000\u3000\u65e5\" }\n        },\n        { \"r\": 4, \"c\": { \"1\": \"X\u5e02\u9577\u3000\" } },\n        ...\n      ],\n      \"table_candidates\": [\"B25:C26\", \"C37:D50\"],\n      \"merged_cells\": {\n        \"schema\": [\"r1\", \"c1\", \"r2\", \"c2\", \"v\"],\n        \"items\": [\n          [55, 5, 55, 10, \"\u7533\u8acb\u8005\u304c\u88ab\u4fdd\u967a\u8005\u672c\u4eba\u306e\u5834\u5408\u306b\u306f\u3001\u4e0b\u8a18\u306b\u3064\u3044\u3066\u8a18\u8f09\u306f\u4e0d\u8981\u3067\u3059\u3002\"],\n          [54, 8, 54, 10, \" \"],\n          [51, 5, 52, 6, \"\u6709\u4fa1\u8a3c\u5238\"],\n          ...\n        ]\n      }\n    }\n  }\n}\n\n</code></pre>"},{"location":"README.ja/#v035-merged_cells","title":"\u4e92\u63db\u6027\u30e1\u30e2\uff08v0.3.5\uff09: merged_cells \u5f62\u5f0f\u5909\u66f4","text":"<p><code>merged_cells</code> \u306f v0.3.5 \u3067\u300c\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u914d\u5217\u300d\u304b\u3089\u300cschema/items\u300d\u5f62\u5f0f\u306b\u5909\u66f4\u3055\u308c\u307e\u3057\u305f\uff08JSON \u5229\u7528\u5074\u306b\u306f\u7834\u58ca\u7684\u5909\u66f4\uff09\u3002</p> <p>\u65e7\u5f62\u5f0f\uff08&lt;= v0.3.2\uff09:</p> <pre><code>\"merged_cells\": [\n  { \"r1\": 55, \"c1\": 5, \"r2\": 55, \"c2\": 10, \"v\": \"\u7533\u8acb\u8005\u304c\u88ab\u4fdd\u967a\u8005\u672c\u4eba\u306e\u5834\u5408\u306b\u306f\u3001\u4e0b\u8a18\u306b\u3064\u3044\u3066\u8a18\u8f09\u306f\u4e0d\u8981\u3067\u3059\u3002\" },\n  { \"r1\": 51, \"c1\": 5, \"r2\": 52, \"c2\": 6, \"v\": \"\u6709\u4fa1\u8a3c\u5238\" }\n]\n</code></pre> <p>\u65b0\u5f62\u5f0f\uff08v0.3.5+\uff09:</p> <pre><code>\"merged_cells\": {\n  \"schema\": [\"r1\", \"c1\", \"r2\", \"c2\", \"v\"],\n  \"items\": [\n    [55, 5, 55, 10, \"\u7533\u8acb\u8005\u304c\u88ab\u4fdd\u967a\u8005\u672c\u4eba\u306e\u5834\u5408\u306b\u306f\u3001\u4e0b\u8a18\u306b\u3064\u3044\u3066\u8a18\u8f09\u306f\u4e0d\u8981\u3067\u3059\u3002\"],\n    [51, 5, 52, 6, \"\u6709\u4fa1\u8a3c\u5238\"]\n  ]\n}\n</code></pre> <p>\u79fb\u884c\u4f8b\uff08\u4f75\u5b58\u30d1\u30fc\u30b9\uff09:</p> <pre><code>def normalize_merged_cells(raw):\n    schema = [\"r1\", \"c1\", \"r2\", \"c2\", \"v\"]\n    if isinstance(raw, list):\n        items = [[d.get(k, \" \") for k in schema] for d in raw]\n        return {\"schema\": schema, \"items\": items}\n    if isinstance(raw, dict) and \"schema\" in raw and \"items\" in raw:\n        return raw\n    return None\n</code></pre>"},{"location":"README.ja/#llm-exstruct-json-markdown","title":"LLM \u63a8\u8ad6\u306b\u3088\u308b ExStruct JSON \u2192 Markdown \u5909\u63db\u7d50\u679c","text":"<pre><code># \u4ecb\u8b77\u4fdd\u967a\u8ca0\u62c5\u9650\u5ea6\u984d\u8a8d\u5b9a\u7533\u8acb\u66f8\n\n\uff08\u7533\u8acb\u5148\uff09\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u5e74\u3000\u3000\u6708\u3000\u3000\u65e5  \nX \u5e02\u9577\n\n\u6b21\u306e\u3068\u304a\u308a\u95a2\u4fc2\u66f8\u985e\u3092\u6dfb\u3048\u3066\u3001\u98df\u8cbb\u30fb\u5c45\u4f4f\u8cbb\uff08\u6ede\u5728\u8cbb\uff09\u306b\u4fc2\u308b\u8ca0\u62c5\u9650\u5ea6\u984d\u8a8d\u5b9a\u3092\u7533\u8acb\u3057\u307e\u3059\u3002\n\n---\n\n## \u88ab\u4fdd\u967a\u8005\u60c5\u5831\n\n| \u9805\u76ee         | \u5185\u5bb9                         |\n| ------------ | ---------------------------- |\n| \u30d5\u30ea\u30ac\u30ca     |                              |\n| \u88ab\u4fdd\u967a\u8005\u6c0f\u540d |                              |\n| \u88ab\u4fdd\u967a\u8005\u756a\u53f7 |                              |\n| \u500b\u4eba\u756a\u53f7     |                              |\n| \u751f\u5e74\u6708\u65e5     | \u660e\u30fb\u5927\u30fb\u662d\u3000\u3000\u5e74\u3000\u3000\u6708\u3000\u3000\u65e5 |\n| \u4f4f\u6240         |                              |\n| \u9023\u7d61\u5148       |                              |\n\n---\n\n## \u5165\u6240\uff08\u9662\uff09\u3057\u305f\u4ecb\u8b77\u4fdd\u967a\u65bd\u8a2d\n\n| \u9805\u76ee                  | \u5185\u5bb9       |\n| --------------------- | ---------- |\n| \u65bd\u8a2d\u6240\u5728\u5730\u30fb\u540d\u79f0\uff08\u203b\uff09 |            |\n| \u9023\u7d61\u5148                |            |\n| \u5165\u6240\uff08\u9662\uff09\u5e74\u6708\u65e5      | \u5e74\u3000\u6708\u3000\u65e5 |\n\n**\uff08\u203b\uff09\u4ecb\u8b77\u4fdd\u967a\u65bd\u8a2d\u306b\u5165\u6240\uff08\u9662\uff09\u3057\u3066\u3044\u306a\u3044\u5834\u5408\u3001\u304a\u3088\u3073\u30b7\u30e7\u30fc\u30c8\u30b9\u30c6\u30a4\u5229\u7528\u6642\u306f\u8a18\u5165\u4e0d\u8981**\n\n---\n\n## \u914d\u5076\u8005\u306e\u6709\u7121\n\n| \u9805\u76ee         | \u5185\u5bb9     |\n| ------------ | -------- |\n| \u914d\u5076\u8005\u306e\u6709\u7121 | \u6709 \u30fb \u7121 |\n\n\u203b\u300c\u7121\u300d\u306e\u5834\u5408\u3001\u4ee5\u4e0b\u306e\u300c\u914d\u5076\u8005\u306b\u95a2\u3059\u308b\u4e8b\u9805\u300d\u306f\u8a18\u5165\u4e0d\u8981\n\n---\n\n## \u914d\u5076\u8005\u306b\u95a2\u3059\u308b\u4e8b\u9805\n\n| \u9805\u76ee                                           | \u5185\u5bb9                       |\n| ---------------------------------------------- | -------------------------- |\n| \u30d5\u30ea\u30ac\u30ca                                       |                            |\n| \u6c0f\u540d                                           |                            |\n| \u751f\u5e74\u6708\u65e5                                       | \u660e\u30fb\u5927\u30fb\u662d\u3000\u5e74\u3000\u6708\u3000\u65e5     |\n| \u500b\u4eba\u756a\u53f7                                       |                            |\n| \u4f4f\u6240                                           | \u3012                         |\n| \u9023\u7d61\u5148                                         |                            |\n| \u672c\u5e74 1 \u6708 1 \u65e5\u73fe\u5728\u306e\u4f4f\u6240\uff08\u73fe\u4f4f\u6240\u3068\u7570\u306a\u308b\u5834\u5408\uff09 | \u3012                         |\n| \u8ab2\u7a0e\u72b6\u6cc1                                       | \u5e02\u753a\u6751\u6c11\u7a0e\uff1a\u8ab2\u7a0e \u30fb \u975e\u8ab2\u7a0e |\n\n---\n\n## \u53ce\u5165\u7b49\u306b\u95a2\u3059\u308b\u7533\u544a\n\n\u4ee5\u4e0b\u306e\u8a72\u5f53\u3059\u308b\u9805\u76ee\u306b\u30c1\u30a7\u30c3\u30af\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\n- \u25a1 \u2460 \u751f\u6d3b\u4fdd\u8b77\u53d7\u7d66\u8005\n- \u25a1 \u2461 \u5e02\u753a\u6751\u6c11\u7a0e\u4e16\u5e2f\u975e\u8ab2\u7a0e\u3067\u3042\u308b\u8001\u9f62\u798f\u7949\u5e74\u91d1\u53d7\u7d66\u8005\n- \u25a1 \u2462 \u5e02\u753a\u6751\u6c11\u7a0e\u4e16\u5e2f\u975e\u8ab2\u7a0e\u8005\u3067\u3001\u8ab2\u7a0e\u5e74\u91d1\u53ce\u5165\u984d\uff0b\u907a\u65cf\u5e74\u91d1\u30fb\u969c\u5bb3\u5e74\u91d1\uff0b\u305d\u306e\u4ed6\u6240\u5f97\u306e\u5408\u8a08\u304c **\u5e74\u984d 80 \u4e07\u5186\u4ee5\u4e0b**\n- \u25a1 \u2463 \u540c\u4e0a\u3067 **80 \u4e07\u5186\u8d85\u301c120 \u4e07\u5186\u4ee5\u4e0b**\n- \u25a1 \u2464 \u540c\u4e0a\u3067 **120 \u4e07\u5186\u8d85**\n\n\u203b\u907a\u65cf\u5e74\u91d1\u306b\u306f\u5be1\u5a66\u5e74\u91d1\u3001\u5be1\u592b\u5e74\u91d1\u3001\u6bcd\u5b50\u5e74\u91d1\u3001\u6e96\u6bcd\u5b50\u5e74\u91d1\u3001\u907a\u5150\u5e74\u91d1\u3092\u542b\u3080\n\n---\n\n## \u9810\u8caf\u91d1\u7b49\u306b\u95a2\u3059\u308b\u7533\u544a\n\n- \u25a1 \u9810\u8caf\u91d1\u30fb\u6709\u4fa1\u8a3c\u5238\u7b49\u306e\u5408\u8a08\u984d\u304c\u4ee5\u4e0b\u306e\u57fa\u6e96\u4ee5\u4e0b\u3067\u3042\u308b\n  - \u2461 \u306e\u65b9\uff1a1000 \u4e07\u5186\uff08\u592b\u5a66 2000 \u4e07\u5186\uff09\n  - \u2462 \u306e\u65b9\uff1a650 \u4e07\u5186\uff08\u592b\u5a66 1650 \u4e07\u5186\uff09\n  - \u2463 \u306e\u65b9\uff1a550 \u4e07\u5186\uff08\u592b\u5a66 1550 \u4e07\u5186\uff09\n  - \u2464 \u306e\u65b9\uff1a500 \u4e07\u5186\uff08\u592b\u5a66 1500 \u4e07\u5186\uff09\n  - \u203b\u7b2c 2 \u53f7\u88ab\u4fdd\u967a\u8005\uff0840\u301c64 \u6b73\uff09\u306f \u2462\u301c\u2464 \u306e\u65b9\uff1a1000 \u4e07\u5186\uff08\u592b\u5a66 2000 \u4e07\u5186\uff09\u4ee5\u4e0b\n\n### \u9810\u8caf\u91d1\u7b49\u306e\u5185\u8a33\n\n| \u9805\u76ee                       | \u91d1\u984d             |\n| -------------------------- | ---------------- |\n| \u9810\u8caf\u91d1\u984d                   | \u5186               |\n| \u6709\u4fa1\u8a3c\u5238\uff08\u8a55\u4fa1\u6982\u7b97\u984d\uff09     | \u5186               |\n| \u305d\u306e\u4ed6\uff08\u73fe\u91d1\u30fb\u8ca0\u50b5\u3092\u542b\u3080\uff09 | \u5186\uff08\u5185\u5bb9\u3092\u8a18\u5165\uff09 |\n\n---\n\n## \u7533\u8acb\u8005\u60c5\u5831\uff08\u203b\u88ab\u4fdd\u967a\u8005\u672c\u4eba\u306e\u5834\u5408\u306f\u4e0d\u8981\uff09\n\n| \u9805\u76ee                   | \u5185\u5bb9 |\n| ---------------------- | ---- |\n| \u7533\u8acb\u8005\u6c0f\u540d             |      |\n| \u9023\u7d61\u5148\uff08\u81ea\u5b85\u30fb\u52e4\u52d9\u5148\uff09 |      |\n| \u7533\u8acb\u8005\u4f4f\u6240             |      |\n| \u672c\u4eba\u3068\u306e\u95a2\u4fc2           |      |\n\n---\n\n## \u6ce8\u610f\u4e8b\u9805\n\n1. \u3053\u306e\u7533\u8acb\u66f8\u306b\u304a\u3051\u308b\u300c\u914d\u5076\u8005\u300d\u306b\u306f\u3001\u4e16\u5e2f\u5206\u96e2\u3057\u3066\u3044\u308b\u914d\u5076\u8005\u304a\u3088\u3073\u5185\u7e01\u95a2\u4fc2\u306e\u8005\u3092\u542b\u3080\u3002\n2. \u9810\u8caf\u91d1\u7b49\u306f\u3001\u540c\u3058\u7a2e\u985e\u3092\u8907\u6570\u6240\u6709\u3057\u3066\u3044\u308b\u5834\u5408\u3059\u3079\u3066\u8a18\u5165\u3057\u3001\u901a\u5e33\u7b49\u306e\u5199\u3057\u3092\u6dfb\u4ed8\u3059\u308b\u3053\u3068\u3002\n3. \u66f8\u304d\u5207\u308c\u306a\u3044\u5834\u5408\u306f\u4f59\u767d\u307e\u305f\u306f\u5225\u7d19\u306b\u8a18\u5165\u3057\u3066\u6dfb\u4ed8\u3059\u308b\u3053\u3068\u3002\n4. \u865a\u507d\u306e\u7533\u544a\u306b\u3088\u308a\u4e0d\u6b63\u306b\u7279\u5b9a\u5165\u6240\u8005\u4ecb\u8b77\u30b5\u30fc\u30d3\u30b9\u8cbb\u7b49\u306e\u652f\u7d66\u3092\u53d7\u3051\u305f\u5834\u5408\u3001\u4ecb\u8b77\u4fdd\u967a\u6cd5\u7b2c 22 \u6761\u7b2c 1 \u9805\u306b\u57fa\u3065\u304d\u3001\u652f\u7d66\u984d\u304a\u3088\u3073\u6700\u5927 2 \u500d\u306e\u52a0\u7b97\u91d1\u3092\u8fd4\u9084\u3059\u308b\u5fc5\u8981\u304c\u3042\u308b\u3002\n</code></pre>"},{"location":"README.ja/#_8","title":"\u8003\u5bdf","text":"<p>\u4e0a\u8a18\u306e\u5b9f\u9a13\u7d50\u679c\u304b\u3089\u3001</p> <p>ExStruct \u306e JSON \u306f AI \u306b\u3068\u3063\u3066 \"\u305d\u306e\u307e\u307e\u610f\u5473\u3068\u3057\u3066\u7406\u89e3\u3067\u304d\u308b\u5f62\u5f0f\" \u3067\u3042\u308b</p> <p>\u3068\u3044\u3046\u3053\u3068\u304c\u660e\u78ba\u306b\u793a\u3055\u308c\u3066\u3044\u307e\u3059\u3002</p> <p>\u305d\u306e\u4ed6\u306e\u672c\u30e9\u30a4\u30d6\u30e9\u30ea\u3092\u4f7f\u3063\u305f LLM \u63a8\u8ad6\u30b5\u30f3\u30d7\u30eb\u306f\u4ee5\u4e0b\u306e\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306b\u3042\u308a\u307e\u3059\u3002</p> <ul> <li>Basic Excel</li> <li>Flowchart</li> <li>Gantt Chart</li> <li>Application forms with many merged cells</li> </ul>"},{"location":"README.ja/#4-summary","title":"4. Summary","text":"<p>\u3053\u306e\u30d9\u30f3\u30c1\u30de\u30fc\u30af\u306b\u3088\u308a\u3001\u672c\u30e9\u30a4\u30d6\u30e9\u30ea\u304c\u6b21\u306e\u80fd\u529b\u3092\u6301\u3064\u3053\u3068\u304c\u78ba\u8a8d\u3067\u304d\u307e\u3059\uff1a</p> <ul> <li>\u8868\u30fb\u30b0\u30e9\u30d5\u30fb\u56f3\u5f62\uff08\u30d5\u30ed\u30fc\u30c1\u30e3\u30fc\u30c8\uff09\u306e\u540c\u6642\u89e3\u6790</li> <li>Excel \u306e\u610f\u5473\u7684\u69cb\u9020\u3092 JSON \u306b\u5909\u63db</li> <li>AI\uff08LLM\uff09\u304c\u305d\u306e JSON \u3092\u76f4\u63a5\u8aad\u307f\u53d6\u308a\u3001Excel \u5185\u5bb9\u3092\u518d\u69cb\u7bc9\u3067\u304d\u308b</li> </ul> <p>\u3064\u307e\u308a exstruct = \u201cExcel \u3092 AI \u304c\u7406\u89e3\u3067\u304d\u308b\u30d5\u30a9\u30fc\u30de\u30c3\u30c8\u306b\u5909\u63db\u3059\u308b\u30a8\u30f3\u30b8\u30f3\u201d \u3067\u3059\u3002</p>"},{"location":"README.ja/#_9","title":"\u5099\u8003","text":"<ul> <li>\u30c7\u30d5\u30a9\u30eb\u30c8 JSON \u306f\u30b3\u30f3\u30d1\u30af\u30c8\uff08\u30c8\u30fc\u30af\u30f3\u524a\u6e1b\u76ee\u7684\uff09\u3002\u53ef\u8aad\u6027\u304c\u5fc5\u8981\u306a\u3089 <code>--pretty</code> / <code>pretty=True</code> \u3092\u5229\u7528\u3057\u3066\u304f\u3060\u3055\u3044\u3002</li> <li>\u30d5\u30a3\u30fc\u30eb\u30c9\u540d\u306f <code>table_candidates</code> \u3092\u4f7f\u7528\u3057\u307e\u3059\uff08\u4ee5\u524d\u306e <code>tables</code> \u304b\u3089\u5909\u66f4\uff09\u3002\u4e0b\u6d41\u306e\u30b9\u30ad\u30fc\u30de\u3092\u8abf\u6574\u3057\u3066\u304f\u3060\u3055\u3044\u3002</li> </ul>"},{"location":"README.ja/#_10","title":"\u4f01\u696d\u5411\u3051","text":"<p>ExStruct \u306f\u4e3b\u306b \u30e9\u30a4\u30d6\u30e9\u30ea \u3068\u3057\u3066\u5229\u7528\u3055\u308c\u308b\u60f3\u5b9a\u3067\u3001\u30b5\u30fc\u30d3\u30b9\u3067\u306f\u3042\u308a\u307e\u305b\u3093\u3002</p> <ul> <li>\u516c\u5f0f\u30b5\u30dd\u30fc\u30c8\u3084 SLA \u306f\u63d0\u4f9b\u3055\u308c\u307e\u305b\u3093</li> <li>\u8fc5\u901f\u306a\u6a5f\u80fd\u8ffd\u52a0\u3088\u308a\u3001\u9577\u671f\u7684\u306a\u5b89\u5b9a\u6027\u3092\u512a\u5148\u3057\u307e\u3059</li> <li>\u4f01\u696d\u5229\u7528\u3067\u306f\u30d5\u30a9\u30fc\u30af\u3084\u5185\u90e8\u6539\u4fee\u304c\u524d\u63d0\u3067\u3059</li> </ul> <p>\u6b21\u306e\u3088\u3046\u306a\u30c1\u30fc\u30e0\u306b\u9069\u3057\u3066\u3044\u307e\u3059\u3002</p> <ul> <li>\u30d6\u30e9\u30c3\u30af\u30dc\u30c3\u30af\u30b9\u5316\u3055\u308c\u305f\u30c4\u30fc\u30eb\u3067\u306f\u306a\u304f\u3001\u900f\u660e\u6027\u304c\u5fc5\u8981</li> <li>\u5fc5\u8981\u306b\u5fdc\u3058\u3066\u5185\u90e8\u30d5\u30a9\u30fc\u30af\u3092\u4fdd\u5b88\u3067\u304d\u308b</li> </ul>"},{"location":"README.ja/#printarea-printareaview","title":"\u5370\u5237\u7bc4\u56f2\u3068\u81ea\u52d5\u6539\u30da\u30fc\u30b8\u7bc4\u56f2\uff08PrintArea / PrintAreaView\uff09","text":"<ul> <li><code>SheetData.print_areas</code> \u306b\u5370\u5237\u7bc4\u56f2\uff08\u30bb\u30eb\u5ea7\u6a19\uff09\u304c\u542b\u307e\u308c\u307e\u3059\uff08light/standard/verbose \u3067\u53d6\u5f97\uff09\u3002</li> <li><code>SheetData.auto_print_areas</code> \u306b Excel COM \u304c\u8a08\u7b97\u3057\u305f\u81ea\u52d5\u6539\u30da\u30fc\u30b8\u7bc4\u56f2\u304c\u5165\u308a\u307e\u3059\uff08\u81ea\u52d5\u6539\u30da\u30fc\u30b8\u62bd\u51fa\u3092\u6709\u52b9\u5316\u3057\u305f\u5834\u5408\u306e\u307f\u3001COM \u9650\u5b9a\uff09\u3002</li> <li><code>export_print_areas_as(...)</code> \u3084 CLI <code>--print-areas-dir</code> \u3067\u5370\u5237\u7bc4\u56f2\u3054\u3068\u306b\u30d5\u30a1\u30a4\u30eb\u3092\u51fa\u529b\u3067\u304d\u307e\u3059\uff08\u5370\u5237\u7bc4\u56f2\u304c\u7121\u3044\u5834\u5408\u306f\u30d5\u30a1\u30a4\u30eb\u3092\u4f5c\u308a\u307e\u305b\u3093\uff09\u3002</li> <li>CLI <code>--auto-page-breaks-dir</code>\uff08COM \u9650\u5b9a\uff09\u3001<code>DestinationOptions.auto_page_breaks_dir</code>\uff08\u63a8\u5968\uff09\u3001\u307e\u305f\u306f <code>export_auto_page_breaks(...)</code> \u3067\u81ea\u52d5\u6539\u30da\u30fc\u30b8\u7bc4\u56f2\u3054\u3068\u306b\u30d5\u30a1\u30a4\u30eb\u3092\u51fa\u529b\u3067\u304d\u307e\u3059\u3002\u81ea\u52d5\u6539\u30da\u30fc\u30b8\u304c\u5b58\u5728\u3057\u306a\u3044\u5834\u5408\u3001<code>export_auto_page_breaks(...)</code> \u306f <code>ValueError</code> \u3092\u9001\u51fa\u3057\u307e\u3059\u3002</li> <li><code>PrintAreaView</code> \u306b\u306f\u7bc4\u56f2\u5185\u306e\u884c\u30fb\u30c6\u30fc\u30d6\u30eb\u5019\u88dc\u306b\u52a0\u3048\u3001\u7bc4\u56f2\u3068\u4ea4\u5dee\u3059\u308b\u56f3\u5f62/\u30c1\u30e3\u30fc\u30c8\u3092\u542b\u307f\u307e\u3059\uff08\u30b5\u30a4\u30ba\u4e0d\u660e\u306e\u56f3\u5f62\u306f\u5ea7\u6a19\u306e\u307f\u3067\u5224\u5b9a\uff09\u3002<code>normalize=True</code> \u3067\u884c/\u5217\u3092\u7bc4\u56f2\u8d77\u70b9\u306b\u518d\u57fa\u6e96\u5316\u3067\u304d\u307e\u3059\u3002</li> </ul>"},{"location":"README.ja/#_11","title":"\u30a2\u30fc\u30ad\u30c6\u30af\u30c1\u30e3","text":"<p>ExStruct \u306f\u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u578b\u306e\u30a2\u30fc\u30ad\u30c6\u30af\u30c1\u30e3\u3092\u63a1\u7528\u3057\u3001 \u62bd\u51fa\u6226\u7565\uff08Backend\uff09\u3068\u30aa\u30fc\u30b1\u30b9\u30c8\u30ec\u30fc\u30b7\u30e7\u30f3\uff08Pipeline\uff09\u3001 \u305d\u3057\u3066\u610f\u5473\u30e2\u30c7\u30eb\u306e\u69cb\u7bc9\u3092\u5206\u96e2\u3057\u3066\u3044\u307e\u3059\u3002</p> <p>\u2192 \u53c2\u7167: docs/architecture/pipeline.md</p>"},{"location":"README.ja/#_12","title":"\u30b3\u30f3\u30c8\u30ea\u30d3\u30e5\u30fc\u30c8","text":"<p>ExStruct \u306e\u5185\u90e8\u5b9f\u88c5\u3092\u62e1\u5f35\u3059\u308b\u5834\u5408\u306f\u3001 \u30b3\u30f3\u30c8\u30ea\u30d3\u30e5\u30fc\u30bf\u30fc\u5411\u3051\u306e\u30a2\u30fc\u30ad\u30c6\u30af\u30c1\u30e3\u30ac\u30a4\u30c9\u3092\u78ba\u8a8d\u3057\u3066\u304f\u3060\u3055\u3044\u3002</p> <p>\u2192 docs/contributors/architecture.md</p>"},{"location":"README.ja/#_13","title":"\u30ab\u30d0\u30ec\u30c3\u30b8\u306b\u95a2\u3059\u308b\u6ce8\u610f","text":"<p>\u30bb\u30eb\u69cb\u9020\u63a8\u8ad6\u30ed\u30b8\u30c3\u30af\uff08cells.py\uff09\u306f\u3001\u30d2\u30e5\u30fc\u30ea\u30b9\u30c6\u30a3\u30c3\u30af\u30eb\u30fc\u30eb\u3068 Excel \u56fa\u6709\u306e\u52d5\u4f5c\u306b\u4f9d\u5b58\u3057\u3066\u3044\u307e\u3059\u3002\u7db2\u7f85\u7684\u306a\u30c6\u30b9\u30c8\u306f\u73fe\u5b9f\u4e16\u754c\u306e\u4fe1\u983c\u6027\u3092\u53cd\u6620\u3067\u304d\u306a\u3044\u305f\u3081\u3001\u5b8c\u5168\u306a\u30ab\u30d0\u30ec\u30c3\u30b8\u306f\u610f\u56f3\u7684\u306b\u8ffd\u6c42\u3055\u308c\u3066\u3044\u307e\u305b\u3093\u3002</p>"},{"location":"README.ja/#license","title":"License","text":"<p>BSD-3-Clause. See <code>LICENSE</code> for details.</p>"},{"location":"README.ja/#_14","title":"\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8","text":"<ul> <li>API \u30ea\u30d5\u30a1\u30ec\u30f3\u30b9 (GitHub Pages): https://harumiweb.github.io/exstruct/</li> <li>JSON Schema \u306f <code>schemas/</code> \u306b\u30e2\u30c7\u30eb\u3054\u3068\u306b\u914d\u7f6e\u3057\u3066\u3044\u307e\u3059\u3002\u30e2\u30c7\u30eb\u5909\u66f4\u5f8c\u306f <code>python scripts/gen_json_schema.py</code> \u3067\u518d\u751f\u6210\u3057\u3066\u304f\u3060\u3055\u3044\u3002</li> </ul>"},{"location":"api/","title":"API Reference","text":"<p>This page shows the primary APIs, minimal runnable examples, expected outputs, and the dependencies required for optional features. Hyperlinks are included when <code>include_cell_links=True</code> (or when using <code>mode=\"verbose\"</code>). Auto page-break areas are COM-only and appear when auto page-break extraction/output is enabled (CLI exposes the option only when COM is available).</p>"},{"location":"api/#toc","title":"TOC","text":"<ul> <li>API Reference</li> <li>TOC</li> <li>Quick Examples</li> <li>Dependencies</li> <li>Auto-generated API mkdocstrings<ul> <li>Core functions</li> <li>Engine and options</li> </ul> </li> <li>Models<ul> <li>Model helpers SheetData / WorkbookData</li> </ul> </li> <li>Error Handling</li> <li>Tuning Examples</li> </ul>"},{"location":"api/#quick-examples","title":"Quick Examples","text":"<pre><code>from exstruct import extract, export\n\nwb = extract(\"sample.xlsx\", mode=\"standard\")\nexport(wb, \"out.json\")  # compact JSON by default\n</code></pre> <p>Expected JSON snippet (links appear when enabled):</p> <pre><code>{\n  \"book_name\": \"sample.xlsx\",\n  \"sheets\": {\n    \"Sheet1\": {\n      \"rows\": [{ \"r\": 1, \"c\": { \"0\": \"Name\", \"1\": \"Age\" }, \"links\": null }],\n      \"shapes\": [\n        {\n          \"text\": \"note\",\n          \"l\": 10,\n          \"t\": 20,\n          \"w\": 80,\n          \"h\": 24,\n          \"type\": \"TextBox\"\n        }\n      ],\n      \"charts\": [],\n      \"table_candidates\": [\"A1:B5\"]\n    }\n  }\n}\n</code></pre> <p>CLI-equivalent flow via Python:</p> <pre><code>from pathlib import Path\nfrom exstruct import process_excel\n\nprocess_excel(\n    file_path=Path(\"input.xlsx\"),\n    output_path=None,  # default: stdout (redirect if you want a file)\n    sheets_dir=Path(\"out_sheets\"),  # optional per-sheet outputs\n    out_fmt=\"json\",\n    image=True,\n    pdf=True,\n    mode=\"standard\",\n    pretty=True,\n)\n# Same as: exstruct input.xlsx --format json --pdf --image --mode standard --pretty --sheets-dir out_sheets &gt; out.json\n</code></pre>"},{"location":"api/#dependencies","title":"Dependencies","text":"<ul> <li>Core extraction: pandas, openpyxl (installed with the package).</li> <li>YAML export: <code>pyyaml</code> (lazy import; missing module raises <code>MissingDependencyError</code>).</li> <li>TOON export: <code>python-toon</code> (lazy import; missing module raises <code>MissingDependencyError</code>).</li> <li>Auto page-break extraction/export: Excel + COM required (feature is skipped when COM is unavailable; CLI hides the flag in non-COM environments).</li> <li>Rendering (PDF/PNG): Excel + COM + <code>pypdfium2</code> are mandatory. Missing Excel/COM or <code>pypdfium2</code> surfaces as <code>RenderError</code>/<code>MissingDependencyError</code>.</li> </ul>"},{"location":"api/#auto-generated-api-mkdocstrings","title":"Auto-generated API (mkdocstrings)","text":"<p>Python API\u306e\u6700\u65b0\u60c5\u5831\u306f\u4ee5\u4e0b\u306e\u81ea\u52d5\u751f\u6210\u30bb\u30af\u30b7\u30e7\u30f3\u3092\u53c2\u7167\u3057\u3066\u304f\u3060\u3055\u3044\uff08docstring\u30d9\u30fc\u30b9\u3067\u540c\u671f\uff09\u3002</p>"},{"location":"api/#core-functions","title":"Core functions","text":""},{"location":"api/#exstruct.extract","title":"exstruct.extract","text":"<pre><code>extract(file_path: str | Path, mode: ExtractionMode = 'standard') -&gt; WorkbookData\n</code></pre> <p>Extracts an Excel workbook into a WorkbookData structure.</p> <p>Parameters:</p> Name Type Description Default <code>file_path</code> <code>str | Path</code> <p>Path to the workbook file (.xlsx, .xlsm, .xls).</p> required <code>mode</code> <code>ExtractionMode</code> <p>Extraction detail level. \"light\" includes cells and table detection only (no COM, shapes/charts empty; print areas via openpyxl). \"standard\" includes texted shapes, arrows, charts (COM if available) and print areas. \"verbose\" also includes shape/chart sizes, cell link map, colors map, and formulas map.</p> <code>'standard'</code> <p>Returns:</p> Name Type Description <code>WorkbookData</code> <code>WorkbookData</code> <p>Parsed workbook representation containing sheets, rows, shapes, charts, and print areas.</p>"},{"location":"api/#exstruct.export","title":"exstruct.export","text":"<pre><code>export(data: WorkbookData, path: str | Path, fmt: Literal['json', 'yaml', 'yml', 'toon'] | None = None, *, pretty: bool = False, indent: int | None = None) -&gt; None\n</code></pre> <p>Save WorkbookData to a file (format inferred from extension).</p> <p>Parameters:</p> Name Type Description Default <code>data</code> <code>WorkbookData</code> <p>WorkbookData from <code>extract</code> or similar</p> required <code>path</code> <code>str | Path</code> <p>destination path; extension is used to infer format</p> required <code>fmt</code> <code>Literal['json', 'yaml', 'yml', 'toon'] | None</code> <p>explicitly set format if desired (json/yaml/yml/toon)</p> <code>None</code> <code>pretty</code> <code>bool</code> <p>pretty-print JSON</p> <code>False</code> <code>indent</code> <code>int | None</code> <p>JSON indent width (defaults to 2 when pretty=True and indent is None)</p> <code>None</code> <p>Raises:</p> Type Description <code>ValueError</code> <p>If the format is unsupported.</p> <p>Examples:</p> <p>Write pretty JSON and YAML (requires pyyaml):</p> <pre><code>&gt;&gt;&gt; from exstruct import export, extract\n&gt;&gt;&gt; wb = extract(\"input.xlsx\")\n&gt;&gt;&gt; export(wb, \"out.json\", pretty=True)\n&gt;&gt;&gt; export(wb, \"out.yaml\", fmt=\"yaml\")\n</code></pre>"},{"location":"api/#exstruct.export_sheets","title":"exstruct.export_sheets","text":"<pre><code>export_sheets(data: WorkbookData, dir_path: str | Path) -&gt; dict[str, Path]\n</code></pre> <p>Export each sheet as an individual JSON file.</p> <ul> <li>Payload: {book_name, sheet_name, sheet: SheetData}</li> <li>Returns: {sheet_name: Path}</li> </ul> <p>Parameters:</p> Name Type Description Default <code>data</code> <code>WorkbookData</code> <p>WorkbookData to split by sheet.</p> required <code>dir_path</code> <code>str | Path</code> <p>Output directory.</p> required <p>Returns:</p> Type Description <code>dict[str, Path]</code> <p>Mapping from sheet name to written JSON path.</p> <p>Examples:</p> <pre><code>&gt;&gt;&gt; from exstruct import export_sheets, extract\n&gt;&gt;&gt; wb = extract(\"input.xlsx\")\n&gt;&gt;&gt; paths = export_sheets(wb, \"out_sheets\")\n&gt;&gt;&gt; \"Sheet1\" in paths\nTrue\n</code></pre>"},{"location":"api/#exstruct.export_sheets_as","title":"exstruct.export_sheets_as","text":"<pre><code>export_sheets_as(data: WorkbookData, dir_path: str | Path, fmt: Literal['json', 'yaml', 'yml', 'toon'] = 'json', *, pretty: bool = False, indent: int | None = None) -&gt; dict[str, Path]\n</code></pre> <p>Export each sheet in the given format (json/yaml/toon); returns sheet name to path map.</p> <p>Parameters:</p> Name Type Description Default <code>data</code> <code>WorkbookData</code> <p>WorkbookData to split by sheet.</p> required <code>dir_path</code> <code>str | Path</code> <p>Output directory.</p> required <code>fmt</code> <code>Literal['json', 'yaml', 'yml', 'toon']</code> <p>Output format; inferred defaults to json.</p> <code>'json'</code> <code>pretty</code> <code>bool</code> <p>Pretty-print JSON.</p> <code>False</code> <code>indent</code> <code>int | None</code> <p>JSON indent width (defaults to 2 when pretty=True and indent is None).</p> <code>None</code> <p>Returns:</p> Type Description <code>dict[str, Path]</code> <p>Mapping from sheet name to written file path.</p> <p>Raises:</p> Type Description <code>ValueError</code> <p>If an unsupported format is passed.</p> <p>Examples:</p> <p>Export per sheet as YAML (requires pyyaml):</p> <pre><code>&gt;&gt;&gt; from exstruct import export_sheets_as, extract\n&gt;&gt;&gt; wb = extract(\"input.xlsx\")\n&gt;&gt;&gt; _ = export_sheets_as(wb, \"out_yaml\", fmt=\"yaml\")\n</code></pre>"},{"location":"api/#exstruct.export_print_areas_as","title":"exstruct.export_print_areas_as","text":"<pre><code>export_print_areas_as(data: WorkbookData, dir_path: str | Path, fmt: Literal['json', 'yaml', 'yml', 'toon'] = 'json', *, pretty: bool = False, indent: int | None = None, normalize: bool = False) -&gt; dict[str, Path]\n</code></pre> <p>Export each print area as a PrintAreaView.</p> <p>Parameters:</p> Name Type Description Default <code>data</code> <code>WorkbookData</code> <p>WorkbookData that contains print areas</p> required <code>dir_path</code> <code>str | Path</code> <p>output directory</p> required <code>fmt</code> <code>Literal['json', 'yaml', 'yml', 'toon']</code> <p>json/yaml/yml/toon</p> <code>'json'</code> <code>pretty</code> <code>bool</code> <p>Pretty-print JSON output.</p> <code>False</code> <code>indent</code> <code>int | None</code> <p>JSON indent width (defaults to 2 when pretty is True and indent is None).</p> <code>None</code> <code>normalize</code> <code>bool</code> <p>rebase row/col indices to the print-area origin when True</p> <code>False</code> <p>Returns:</p> Type Description <code>dict[str, Path]</code> <p>dict mapping area key to path (e.g., \"Sheet1#1\": /.../Sheet1_area1_...json)</p> <p>Examples:</p> <p>Export print areas when present:</p> <pre><code>&gt;&gt;&gt; from exstruct import export_print_areas_as, extract\n&gt;&gt;&gt; wb = extract(\"input.xlsx\", mode=\"standard\")\n&gt;&gt;&gt; paths = export_print_areas_as(wb, \"areas\")\n&gt;&gt;&gt; isinstance(paths, dict)\nTrue\n</code></pre>"},{"location":"api/#exstruct.export_auto_page_breaks","title":"exstruct.export_auto_page_breaks","text":"<pre><code>export_auto_page_breaks(data: WorkbookData, dir_path: str | Path, fmt: Literal['json', 'yaml', 'yml', 'toon'] = 'json', *, pretty: bool = False, indent: int | None = None, normalize: bool = False) -&gt; dict[str, Path]\n</code></pre> <p>Export auto page-break areas (COM-computed) as PrintAreaView files.</p> <p>Parameters:</p> Name Type Description Default <code>data</code> <code>WorkbookData</code> <p>WorkbookData containing auto_print_areas (COM extraction with auto breaks enabled)</p> required <code>dir_path</code> <code>str | Path</code> <p>output directory</p> required <code>fmt</code> <code>Literal['json', 'yaml', 'yml', 'toon']</code> <p>json/yaml/yml/toon</p> <code>'json'</code> <code>pretty</code> <code>bool</code> <p>Pretty-print JSON output.</p> <code>False</code> <code>indent</code> <code>int | None</code> <p>JSON indent width (defaults to 2 when pretty is True and indent is None).</p> <code>None</code> <code>normalize</code> <code>bool</code> <p>rebase row/col indices to the area origin when True</p> <code>False</code> <p>Returns:</p> Type Description <code>dict[str, Path]</code> <p>dict mapping area key to path (e.g., \"Sheet1#1\": /.../Sheet1_auto_page1_...json)</p> <p>Raises:</p> Type Description <code>PrintAreaError</code> <p>If no auto page-break areas are present.</p> <p>Examples:</p> <pre><code>&gt;&gt;&gt; from exstruct import export_auto_page_breaks, extract\n&gt;&gt;&gt; wb = extract(\"input.xlsx\", mode=\"standard\")\n&gt;&gt;&gt; try:\n...     export_auto_page_breaks(wb, \"auto_areas\")\n... except PrintAreaError:\n...     pass\n</code></pre>"},{"location":"api/#exstruct.export_pdf","title":"exstruct.export_pdf","text":"<pre><code>export_pdf(excel_path: str | Path, output_pdf: str | Path) -&gt; list[str]\n</code></pre> <p>Export an Excel workbook to PDF via Excel COM and return sheet names in order.</p>"},{"location":"api/#exstruct.export_sheet_images","title":"exstruct.export_sheet_images","text":"<pre><code>export_sheet_images(excel_path: str | Path, output_dir: str | Path, dpi: int = 144) -&gt; list[Path]\n</code></pre> <p>Export each worksheet in the given Excel workbook to PNG files and return the image paths in workbook order.</p> <p>Returns:</p> Name Type Description <code>paths</code> <code>list[Path]</code> <p>Paths to the generated PNG files, ordered by the corresponding worksheets.</p> <p>Raises:</p> Type Description <code>RenderError</code> <p>If export or rendering fails.</p>"},{"location":"api/#exstruct.process_excel","title":"exstruct.process_excel","text":"<pre><code>process_excel(file_path: str | Path, output_path: str | Path | None = None, out_fmt: str = 'json', image: bool = False, pdf: bool = False, dpi: int = 72, mode: ExtractionMode = 'standard', pretty: bool = False, indent: int | None = None, sheets_dir: str | Path | None = None, print_areas_dir: str | Path | None = None, auto_page_breaks_dir: str | Path | None = None, stream: TextIO | None = None) -&gt; None\n</code></pre> <p>Convenience wrapper: extract -&gt; serialize (file or stdout) -&gt; optional PDF/PNG.</p> <p>Parameters:</p> Name Type Description Default <code>file_path</code> <code>str | Path</code> <p>Input Excel workbook (path string or Path).</p> required <code>output_path</code> <code>str | Path | None</code> <p>None for stdout; otherwise, write to file (string or Path).</p> <code>None</code> <code>out_fmt</code> <code>str</code> <p>json/yaml/yml/toon.</p> <code>'json'</code> <code>image</code> <code>bool</code> <p>True to also output PNGs (requires Excel + COM + pypdfium2).</p> <code>False</code> <code>pdf</code> <code>bool</code> <p>True to also output PDF (requires Excel + COM + pypdfium2).</p> <code>False</code> <code>dpi</code> <code>int</code> <p>DPI for image output.</p> <code>72</code> <code>mode</code> <code>ExtractionMode</code> <p>light/standard/verbose (same meaning as <code>extract</code>).</p> <code>'standard'</code> <code>pretty</code> <code>bool</code> <p>Pretty-print JSON.</p> <code>False</code> <code>indent</code> <code>int | None</code> <p>JSON indent width.</p> <code>None</code> <code>sheets_dir</code> <code>str | Path | None</code> <p>Directory to write per-sheet files (string or Path).</p> <code>None</code> <code>print_areas_dir</code> <code>str | Path | None</code> <p>Directory to write per-print-area files (string or Path).</p> <code>None</code> <code>auto_page_breaks_dir</code> <code>str | Path | None</code> <p>Directory to write per-auto-page-break files (COM only).</p> <code>None</code> <code>stream</code> <code>TextIO | None</code> <p>IO override when output_path is None.</p> <code>None</code> <p>Raises:</p> Type Description <code>ValueError</code> <p>If an unsupported format or mode is given.</p> <code>PrintAreaError</code> <p>When exporting auto page breaks without available data.</p> <code>RenderError</code> <p>When rendering fails (Excel/COM/pypdfium2 issues).</p> <p>Examples:</p> <p>Extract and write JSON to stdout, plus per-sheet files:</p> <pre><code>&gt;&gt;&gt; from pathlib import Path\n&gt;&gt;&gt; from exstruct import process_excel\n&gt;&gt;&gt; process_excel(Path(\"input.xlsx\"), output_path=None, sheets_dir=Path(\"sheets\"))\n</code></pre> <p>Render PDF only (COM + Excel required):</p> <pre><code>&gt;&gt;&gt; process_excel(Path(\"input.xlsx\"), output_path=Path(\"out.json\"), pdf=True)\n</code></pre>"},{"location":"api/#engine-and-options","title":"Engine and options","text":""},{"location":"api/#exstruct.engine.ExStructEngine","title":"exstruct.engine.ExStructEngine","text":"<p>Configurable engine for ExStruct extraction and export.</p> <p>Instances are immutable; override options per call if needed.</p> Key behaviors <ul> <li>StructOptions: extraction mode and optional table detection params.</li> <li>OutputOptions: serialization format/pretty-print, include/exclude filters, per-sheet/per-print-area output dirs, etc.</li> <li>Main methods:     extract(path, mode=None) -&gt; WorkbookData         - Modes: light/standard/verbose         - light: COM-free; cells + tables + print areas only (shapes/charts empty)     serialize(workbook, ...) -&gt; str         - Applies include_* filters, then serializes     export(workbook, ...)         - Writes to file/stdout; optionally per-sheet and per-print-area files     process(file_path, ...)         - One-shot extract-&gt;export (CLI equivalent), with optional PDF/PNG</li> </ul>"},{"location":"api/#exstruct.engine.ExStructEngine.__init__","title":"__init__","text":"<pre><code>__init__(options: StructOptions | None = None, output: OutputOptions | None = None) -&gt; None\n</code></pre> <p>Initialize the engine with optional struct/output options.</p>"},{"location":"api/#exstruct.engine.ExStructEngine.from_defaults","title":"from_defaults  <code>staticmethod</code>","text":"<pre><code>from_defaults() -&gt; ExStructEngine\n</code></pre> <p>Factory to create an engine with default options.</p>"},{"location":"api/#exstruct.engine.ExStructEngine.extract","title":"extract","text":"<pre><code>extract(file_path: str | Path, *, mode: ExtractionMode | None = None) -&gt; WorkbookData\n</code></pre> <p>Produce a normalized WorkbookData extracted from the given workbook file.</p> <p>Parameters:</p> Name Type Description Default <code>file_path</code> <code>str | Path</code> <p>Path to the .xlsx/.xlsm/.xls file to extract.</p> required <code>mode</code> <code>ExtractionMode | None</code> <p>Extraction mode to use; if None the engine's configured mode is used. Modes: \"light\", \"standard\", \"verbose\".</p> <code>None</code> <p>Returns:</p> Name Type Description <code>WorkbookData</code> <code>WorkbookData</code> <p>Normalized workbook data extracted from the file.</p>"},{"location":"api/#exstruct.engine.ExStructEngine.serialize","title":"serialize","text":"<pre><code>serialize(data: WorkbookData, *, fmt: Literal['json', 'yaml', 'yml', 'toon'] | None = None, pretty: bool | None = None, indent: int | None = None) -&gt; str\n</code></pre> <p>Serialize a workbook after applying include/exclude filters.</p> <p>Parameters:</p> Name Type Description Default <code>data</code> <code>WorkbookData</code> <p>Workbook to serialize after filtering.</p> required <code>fmt</code> <code>Literal['json', 'yaml', 'yml', 'toon'] | None</code> <p>Serialization format; defaults to OutputOptions.format.fmt.</p> <code>None</code> <code>pretty</code> <code>bool | None</code> <p>Whether to pretty-print JSON output.</p> <code>None</code> <code>indent</code> <code>int | None</code> <p>Indentation to use when pretty-printing JSON.</p> <code>None</code>"},{"location":"api/#exstruct.engine.ExStructEngine.export","title":"export","text":"<pre><code>export(data: WorkbookData, output_path: str | Path | None = None, *, fmt: Literal['json', 'yaml', 'yml', 'toon'] | None = None, pretty: bool | None = None, indent: int | None = None, sheets_dir: str | Path | None = None, print_areas_dir: str | Path | None = None, auto_page_breaks_dir: str | Path | None = None, stream: TextIO | None = None) -&gt; None\n</code></pre> <p>Write filtered workbook data to a file or stream.</p> <p>Includes optional per-sheet and per-print-area outputs when destinations are provided.</p> <p>Parameters:</p> Name Type Description Default <code>data</code> <code>WorkbookData</code> <p>Workbook to serialize and write.</p> required <code>output_path</code> <code>str | Path | None</code> <p>Target file path (str or Path); writes to stdout when None.</p> <code>None</code> <code>fmt</code> <code>Literal['json', 'yaml', 'yml', 'toon'] | None</code> <p>Serialization format; defaults to OutputOptions.format.fmt.</p> <code>None</code> <code>pretty</code> <code>bool | None</code> <p>Whether to pretty-print JSON output.</p> <code>None</code> <code>indent</code> <code>int | None</code> <p>Indentation to use when pretty-printing JSON.</p> <code>None</code> <code>sheets_dir</code> <code>str | Path | None</code> <p>Directory for per-sheet outputs when provided (str or Path).</p> <code>None</code> <code>print_areas_dir</code> <code>str | Path | None</code> <p>Directory for per-print-area outputs when provided (str or Path).</p> <code>None</code> <code>auto_page_breaks_dir</code> <code>str | Path | None</code> <p>Directory for auto page-break outputs (str or Path; COM environments only).</p> <code>None</code> <code>stream</code> <code>TextIO | None</code> <p>Stream override when output_path is None.</p> <code>None</code>"},{"location":"api/#exstruct.engine.ExStructEngine.process","title":"process","text":"<pre><code>process(file_path: str | Path, output_path: str | Path | None = None, *, out_fmt: str | None = None, image: bool = False, pdf: bool = False, dpi: int = 72, mode: ExtractionMode | None = None, pretty: bool | None = None, indent: int | None = None, sheets_dir: str | Path | None = None, print_areas_dir: str | Path | None = None, auto_page_breaks_dir: str | Path | None = None, stream: TextIO | None = None) -&gt; None\n</code></pre> <p>One-shot extract-&gt;export wrapper (CLI equivalent) with optional PDF/PNG output.</p> <p>Parameters:</p> Name Type Description Default <code>file_path</code> <code>str | Path</code> <p>Input Excel workbook path (str or Path).</p> required <code>output_path</code> <code>str | Path | None</code> <p>Target file path (str or Path); writes to stdout when None.</p> <code>None</code> <code>out_fmt</code> <code>str | None</code> <p>Serialization format for structured output.</p> <code>None</code> <code>image</code> <code>bool</code> <p>Whether to export PNGs alongside structured output.</p> <code>False</code> <code>pdf</code> <code>bool</code> <p>Whether to export a PDF snapshot alongside structured output.</p> <code>False</code> <code>dpi</code> <code>int</code> <p>DPI to use when rendering images.</p> <code>72</code> <code>mode</code> <code>ExtractionMode | None</code> <p>Extraction mode; defaults to the engine's StructOptions.mode.</p> <code>None</code> <code>pretty</code> <code>bool | None</code> <p>Whether to pretty-print JSON output.</p> <code>None</code> <code>indent</code> <code>int | None</code> <p>Indentation to use when pretty-printing JSON.</p> <code>None</code> <code>sheets_dir</code> <code>str | Path | None</code> <p>Directory for per-sheet structured outputs (str or Path).</p> <code>None</code> <code>print_areas_dir</code> <code>str | Path | None</code> <p>Directory for per-print-area structured outputs (str or Path).</p> <code>None</code> <code>auto_page_breaks_dir</code> <code>str | Path | None</code> <p>Directory for auto page-break outputs (str or Path).</p> <code>None</code> <code>stream</code> <code>TextIO | None</code> <p>Stream override when writing to stdout.</p> <code>None</code>"},{"location":"api/#exstruct.engine.StructOptions","title":"exstruct.engine.StructOptions  <code>dataclass</code>","text":"<p>Extraction-time options for ExStructEngine.</p> <p>Attributes:</p> Name Type Description <code>mode</code> <code>ExtractionMode</code> <p>Extraction mode. One of \"light\", \"standard\", \"verbose\".   - light: cells + table candidates only (no COM, shapes/charts empty)   - standard: texted shapes + arrows + charts (if COM available)   - verbose: all shapes (width/height), charts, table candidates</p> <code>table_params</code> <code>TableParams | None</code> <p>Optional dict passed to <code>set_table_detection_params(**table_params)</code>           before extraction. Use this to tweak table detection heuristics           per engine instance without touching global state.</p> <code>include_colors_map</code> <code>bool | None</code> <p>Whether to extract background color maps.</p> <code>include_formulas_map</code> <code>bool | None</code> <p>Whether to extract formulas map.</p> <code>include_merged_cells</code> <code>bool | None</code> <p>Whether to extract merged cell ranges.</p> <code>include_merged_values_in_rows</code> <code>bool</code> <p>Whether to keep merged values in rows.</p> <code>colors</code> <code>ColorsOptions</code> <p>Color extraction options.</p>"},{"location":"api/#exstruct.engine.OutputOptions","title":"exstruct.engine.OutputOptions","text":"<p>               Bases: <code>BaseModel</code></p> <p>Output-time options for ExStructEngine.</p> <ul> <li>format: serialization format/indent.</li> <li>filters: include/exclude flags (rows/shapes/charts/tables/print_areas, size flags).</li> <li>destinations: side outputs (per-sheet, per-print-area, stream override).</li> </ul>"},{"location":"api/#exstruct.engine.FormatOptions","title":"exstruct.engine.FormatOptions","text":"<p>               Bases: <code>BaseModel</code></p> <p>Formatting options for serialization.</p>"},{"location":"api/#exstruct.engine.FilterOptions","title":"exstruct.engine.FilterOptions","text":"<p>               Bases: <code>BaseModel</code></p> <p>Include/exclude filters for output.</p>"},{"location":"api/#exstruct.engine.DestinationOptions","title":"exstruct.engine.DestinationOptions","text":"<p>               Bases: <code>BaseModel</code></p> <p>Destinations for optional side outputs.</p>"},{"location":"api/#exstruct.engine.ColorsOptions","title":"exstruct.engine.ColorsOptions","text":"<p>               Bases: <code>BaseModel</code></p> <p>Color extraction options.</p> <p>Examples:</p> <pre><code>&gt;&gt;&gt; ColorsOptions(\n...     include_default_background=False,\n...     ignore_colors=[\"#FFFFFF\", \"AD3815\", \"theme:1:0.2\", \"indexed:64\", \"auto\"],\n... )\n</code></pre>"},{"location":"api/#exstruct.engine.ColorsOptions.ignore_colors_set","title":"ignore_colors_set","text":"<pre><code>ignore_colors_set() -&gt; set[str]\n</code></pre> <p>Return ignore_colors as a set of normalized strings.</p> <p>Returns:</p> Type Description <code>set[str]</code> <p>Set of color keys to ignore.</p>"},{"location":"api/#models","title":"Models","text":"<p>See generated/models.md for the detailed model fields (run <code>python scripts/gen_model_docs.py</code> to refresh).</p>"},{"location":"api/#model-helpers-sheetdata-workbookdata","title":"Model helpers (SheetData / WorkbookData)","text":"<ul> <li><code>to_json(pretty=False, indent=None)</code> \u2192 JSON string (pretty when requested)</li> <li><code>to_yaml()</code> \u2192 YAML string (requires <code>pyyaml</code>)</li> <li><code>to_toon()</code> \u2192 TOON string (requires <code>python-toon</code>)</li> <li><code>save(path, pretty=False, indent=None)</code> \u2192 infers format from suffix (<code>.json/.yaml/.yml/.toon</code>)</li> <li><code>WorkbookData.__getitem__(name)</code> \u2192 get a SheetData by name</li> <li><code>WorkbookData.__iter__()</code> \u2192 yields <code>(sheet_name, SheetData)</code> in order</li> </ul> <p>Example:</p> <pre><code>wb = extract(\"input.xlsx\")\nfirst = wb[\"Sheet1\"]\nfor name, sheet in wb:\n    print(name, len(sheet.rows))\nwb.save(\"out.json\", pretty=True)\nfirst.save(\"sheet.yaml\")  # requires pyyaml\n</code></pre>"},{"location":"api/#error-handling","title":"Error Handling","text":"<ul> <li>Exception types:</li> <li><code>SerializationError</code>: Unsupported format requested (<code>serialize_workbook</code>, export APIs).</li> <li><code>MissingDependencyError</code>: Optional dependency (<code>pyyaml</code> / <code>python-toon</code> / <code>pypdfium2</code>) is missing; message includes install instructions.</li> <li><code>RenderError</code>: Excel/COM is unavailable or PDF/PNG rendering fails.</li> <li><code>PrintAreaError</code> (ValueError-compatible): <code>export_auto_page_breaks</code> invoked when no <code>auto_print_areas</code> are available.</li> <li><code>OutputError</code>: Writing output to disk/stream failed (original exception kept in <code>__cause__</code>).</li> <li><code>ValueError</code>: Invalid inputs such as an unsupported <code>mode</code>.</li> <li>Excel COM unavailable: extraction falls back to cells + <code>table_candidates</code>; <code>shapes</code>/<code>charts</code> are empty, warning is logged.</li> <li>No print areas: <code>export_print_areas_as</code> writes nothing and returns <code>{}</code>; this is not an error.</li> <li>Auto page-break export: <code>export_auto_page_breaks</code> raises <code>PrintAreaError</code> if no auto page-break areas are present (enable them via <code>DestinationOptions.auto_page_breaks_dir</code>).</li> <li>CLI mirrors these behaviors: exits non-zero on failures, prints messages in English.</li> </ul>"},{"location":"api/#tuning-examples","title":"Tuning Examples","text":"<ul> <li>Reduce false positives (layout frames):</li> </ul> <pre><code>set_table_detection_params(table_score_threshold=0.4, coverage_min=0.25)\n</code></pre> <ul> <li>Recover missed tiny tables:</li> </ul> <pre><code>set_table_detection_params(density_min=0.03, min_nonempty_cells=2)\n</code></pre>"},{"location":"cli/","title":"CLI User Guide","text":"<p>This page explains how to run ExStruct from the command line, what each flag does, and common workflows. The CLI wraps <code>process_excel</code> under the hood.</p>"},{"location":"cli/#basic-usage","title":"Basic usage","text":"<pre><code>exstruct INPUT.xlsx &gt; out.json              # compact JSON to stdout\nexstruct INPUT.xlsx -o out.json --pretty    # pretty JSON to a file\nexstruct INPUT.xlsx --format yaml           # YAML output (needs pyyaml)\nexstruct INPUT.xlsx --format toon           # TOON output (needs python-toon)\n</code></pre> <ul> <li><code>INPUT.xlsx</code> supports <code>.xlsx/.xlsm/.xls</code>.</li> <li>Exit code <code>0</code> on success, <code>1</code> on failure.</li> </ul>"},{"location":"cli/#options","title":"Options","text":"Flag Description <code>-o, --output PATH</code> Output path. Omit to write to stdout. <code>-f, --format {json,yaml,yml,toon}</code> Serialization format (default: <code>json</code>). <code>-m, --mode {light,standard,verbose}</code> Extraction detail level.- light: cells + table candidates + print areas (no COM shapes/charts).- standard: shapes with text/arrows + charts + print areas.- verbose: all shapes/charts with size + hyperlinks. <code>--pretty</code> Pretty-print JSON (indent=2). <code>--image</code> Render per-sheet PNGs (requires Excel + COM + <code>pypdfium2</code>). <code>--pdf</code> Render PDF (requires Excel + COM + <code>pypdfium2</code>). <code>--dpi INT</code> DPI for rendered images (default: 144). <code>--sheets-dir DIR</code> Write one file per sheet (format follows <code>--format</code>). <code>--print-areas-dir DIR</code> Write one file per print area (format follows <code>--format</code>)."},{"location":"cli/#common-workflows","title":"Common workflows","text":"<p>Split per sheet and keep a combined JSON:</p> <pre><code>exstruct sample.xlsx -o out.json --sheets-dir sheets/ --pretty\n</code></pre> <p>Export print areas (writes nothing if none exist):</p> <pre><code>exstruct sample.xlsx --print-areas-dir areas/\n</code></pre> <p>Verbose mode with hyperlinks, plus per-sheet YAML:</p> <pre><code>exstruct sample.xlsx --mode verbose --format yaml --sheets-dir sheets_yaml/  # needs pyyaml\n</code></pre> <p>Render PDF/PNG (Windows + Excel + <code>pypdfium2</code> required):</p> <pre><code>exstruct sample.xlsx --pdf --image --dpi 144 -o out.json\n</code></pre>"},{"location":"cli/#notes","title":"Notes","text":"<ul> <li>Optional dependencies are lazy-imported. Missing packages raise a <code>MissingDependencyError</code> with install hints.</li> <li>On non-COM environments, shapes/charts are empty and print areas come from openpyxl; commands still succeed.</li> <li><code>--sheets-dir</code> and <code>--print-areas-dir</code> accept existing or new directories (created if missing).</li> </ul>"},{"location":"com-vs-ooxml-implementation/","title":"COM vs OOXML \u5b9f\u88c5\u6bd4\u8f03\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8","text":"<p>ExStruct \u306f Windows \u74b0\u5883\u3067\u306f Excel COM API\u3001Linux/macOS \u74b0\u5883\u3067\u306f OOXML (Office Open XML) \u30d1\u30fc\u30b5\u30fc\u3092\u4f7f\u7528\u3057\u3066 Excel \u30d5\u30a1\u30a4\u30eb\u304b\u3089 Shape \u3068 Chart \u3092\u62bd\u51fa\u3057\u307e\u3059\u3002\u672c\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u3067\u306f\u3001\u4e21\u5b9f\u88c5\u306e\u8a73\u7d30\u306a\u6a5f\u80fd\u6bd4\u8f03\u3068\u5b9f\u88c5\u65b9\u6cd5\u306e\u9055\u3044\u3092\u8aac\u660e\u3057\u307e\u3059\u3002</p>"},{"location":"com-vs-ooxml-implementation/#_1","title":"\u76ee\u6b21","text":"<ol> <li>\u30a2\u30fc\u30ad\u30c6\u30af\u30c1\u30e3\u6982\u8981</li> <li>Shape \u62bd\u51fa\u6a5f\u80fd</li> <li>Chart \u62bd\u51fa\u6a5f\u80fd</li> <li>\u5b9f\u88c5\u65b9\u6cd5\u306e\u6bd4\u8f03</li> <li>\u6a5f\u80fd\u5bfe\u5fdc\u8868</li> <li>\u5236\u9650\u4e8b\u9805\u3068\u6ce8\u610f\u70b9</li> </ol>"},{"location":"com-vs-ooxml-implementation/#_2","title":"\u30a2\u30fc\u30ad\u30c6\u30af\u30c1\u30e3\u6982\u8981","text":""},{"location":"com-vs-ooxml-implementation/#com-windows","title":"COM \u5b9f\u88c5 (Windows)","text":"<pre><code>Excel Application (COM)\n    \u2193\nxlwings \u30e9\u30a4\u30d6\u30e9\u30ea\n    \u2193\nshapes.py / charts.py\n    \u2193\nPydantic \u30e2\u30c7\u30eb (Shape, Chart)\n</code></pre> <ul> <li>\u4f9d\u5b58: Microsoft Excel \u304c\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3055\u308c\u305f Windows \u74b0\u5883</li> <li>\u5229\u70b9: Excel \u306e\u5168\u6a5f\u80fd\u306b\u30a2\u30af\u30bb\u30b9\u53ef\u80fd\u3001\u9ad8\u7cbe\u5ea6</li> <li>\u6b20\u70b9: Windows \u9650\u5b9a\u3001Excel \u30e9\u30a4\u30bb\u30f3\u30b9\u5fc5\u8981</li> </ul>"},{"location":"com-vs-ooxml-implementation/#ooxml","title":"OOXML \u5b9f\u88c5 (\u30af\u30ed\u30b9\u30d7\u30e9\u30c3\u30c8\u30d5\u30a9\u30fc\u30e0)","text":"<pre><code>.xlsx \u30d5\u30a1\u30a4\u30eb (ZIP \u30a2\u30fc\u30ab\u30a4\u30d6)\n    \u2193\nxml.etree.ElementTree\n    \u2193\ndrawing.py / chart.py\n    \u2193\nPydantic \u30e2\u30c7\u30eb (Shape, Chart)\n</code></pre> <ul> <li>\u4f9d\u5b58: Python \u6a19\u6e96\u30e9\u30a4\u30d6\u30e9\u30ea\u306e\u307f</li> <li>\u5229\u70b9: \u5168\u30d7\u30e9\u30c3\u30c8\u30d5\u30a9\u30fc\u30e0\u5bfe\u5fdc\u3001Excel \u4e0d\u8981</li> <li>\u6b20\u70b9: \u4e00\u90e8\u6a5f\u80fd\u304c\u5236\u9650\u3055\u308c\u308b</li> </ul>"},{"location":"com-vs-ooxml-implementation/#shape","title":"Shape \u62bd\u51fa\u6a5f\u80fd","text":""},{"location":"com-vs-ooxml-implementation/#1-l-t","title":"1. \u4f4d\u7f6e\u60c5\u5831 (l, t)","text":""},{"location":"com-vs-ooxml-implementation/#com","title":"COM \u5b9f\u88c5","text":"<pre><code># shapes.py\nshape_obj = Shape(\n    l=int(shp.left),\n    t=int(shp.top),\n    ...\n)\n</code></pre> <ul> <li><code>xlwings.Shape.left</code> / <code>xlwings.Shape.top</code> \u30d7\u30ed\u30d1\u30c6\u30a3\u3092\u4f7f\u7528</li> <li>\u5358\u4f4d: \u30dd\u30a4\u30f3\u30c8 (1/72 \u30a4\u30f3\u30c1)</li> </ul>"},{"location":"com-vs-ooxml-implementation/#ooxml_1","title":"OOXML \u5b9f\u88c5","text":"<pre><code># drawing.py\ndef _get_xfrm_position(elem: Element) -&gt; tuple[int, int, int, int] | None:\n    xfrm = elem.find(\".//a:xfrm\", NS)\n    off = xfrm.find(\"a:off\", NS)\n    x = int(off.get(\"x\", \"0\"))\n    y = int(off.get(\"y\", \"0\"))\n    return (emu_to_pixels(x), emu_to_pixels(y), ...)\n</code></pre> <ul> <li>DrawingML \u306e <code>&lt;a:xfrm&gt;&lt;a:off&gt;</code> \u8981\u7d20\u304b\u3089\u53d6\u5f97</li> <li>\u5358\u4f4d: EMU (English Metric Units) \u2192 \u30d4\u30af\u30bb\u30eb\u306b\u5909\u63db</li> <li>\u5909\u63db\u5f0f: <code>pixels = emu / 914400 * 96</code></li> </ul>"},{"location":"com-vs-ooxml-implementation/#2-w-h","title":"2. \u30b5\u30a4\u30ba\u60c5\u5831 (w, h)","text":""},{"location":"com-vs-ooxml-implementation/#com_1","title":"COM \u5b9f\u88c5","text":"<pre><code>w=int(shp.width) if mode == \"verbose\" or shape_type_str == \"Group\" else None,\nh=int(shp.height) if mode == \"verbose\" or shape_type_str == \"Group\" else None,\n</code></pre>"},{"location":"com-vs-ooxml-implementation/#ooxml_2","title":"OOXML \u5b9f\u88c5","text":"<pre><code>ext = xfrm.find(\"a:ext\", NS)\ncx = int(ext.get(\"cx\", \"0\"))\ncy = int(ext.get(\"cy\", \"0\"))\nreturn (..., emu_to_pixels(cx), emu_to_pixels(cy))\n</code></pre> <ul> <li><code>&lt;a:ext cx=\"...\" cy=\"...\"&gt;</code> \u304b\u3089\u53d6\u5f97</li> <li>verbose \u30e2\u30fc\u30c9\u307e\u305f\u306f\u30b0\u30eb\u30fc\u30d7\u56f3\u5f62\u306e\u5834\u5408\u306e\u307f\u51fa\u529b</li> </ul>"},{"location":"com-vs-ooxml-implementation/#3","title":"3. \u30c6\u30ad\u30b9\u30c8\u62bd\u51fa","text":""},{"location":"com-vs-ooxml-implementation/#com_2","title":"COM \u5b9f\u88c5","text":"<pre><code>try:\n    text = shp.text.strip() if shp.text else \"\"\nexcept Exception:\n    text = \"\"\n</code></pre> <ul> <li><code>xlwings.Shape.text</code> \u30d7\u30ed\u30d1\u30c6\u30a3\u3092\u4f7f\u7528</li> </ul>"},{"location":"com-vs-ooxml-implementation/#ooxml_3","title":"OOXML \u5b9f\u88c5","text":"<pre><code>def _get_text_from_element(elem: Element) -&gt; str:\n    texts: list[str] = []\n    for t_elem in elem.findall(\".//a:t\", NS):\n        if t_elem.text:\n            texts.append(t_elem.text)\n    return \"\".join(texts).strip()\n</code></pre> <ul> <li><code>&lt;a:t&gt;</code> \u8981\u7d20\uff08\u30c6\u30ad\u30b9\u30c8\u30e9\u30f3\uff09\u3092\u5168\u3066\u53ce\u96c6\u3057\u3066\u7d50\u5408</li> <li>\u30ea\u30c3\u30c1\u30c6\u30ad\u30b9\u30c8\u306e\u66f8\u5f0f\u60c5\u5831\u306f\u7121\u8996</li> </ul>"},{"location":"com-vs-ooxml-implementation/#4-type","title":"4. \u56f3\u5f62\u7a2e\u5225 (type)","text":""},{"location":"com-vs-ooxml-implementation/#com_3","title":"COM \u5b9f\u88c5","text":"<pre><code>type_num = shp.api.Type\nshape_type_str = MSO_SHAPE_TYPE_MAP.get(type_num, f\"Unknown({type_num})\")\nastype_num = shp.api.AutoShapeType\nautoshape_type_str = MSO_AUTO_SHAPE_TYPE_MAP.get(astype_num, ...)\ntype_label = f\"{shape_type_str}-{autoshape_type_str}\"\n</code></pre> <ul> <li><code>MsoShapeType</code> \u3068 <code>MsoAutoShapeType</code> \u306e\u7d44\u307f\u5408\u308f\u305b</li> <li>\u4f8b: <code>\"AutoShape-FlowchartProcess\"</code></li> </ul>"},{"location":"com-vs-ooxml-implementation/#ooxml_4","title":"OOXML \u5b9f\u88c5","text":"<pre><code>def _get_preset_geometry(elem: Element) -&gt; str | None:\n    prst_geom = elem.find(\".//a:prstGeom\", NS)\n    return prst_geom.get(\"prst\") if prst_geom is not None else None\n\n# PRESET_GEOM_MAP \u3067\u5909\u63db\nPRESET_GEOM_MAP = {\n    \"flowChartProcess\": \"AutoShape-FlowchartProcess\",\n    \"rect\": \"AutoShape-Rectangle\",\n    ...\n}\n</code></pre> <ul> <li><code>&lt;a:prstGeom prst=\"...\"&gt;</code> \u5c5e\u6027\u304b\u3089\u53d6\u5f97</li> <li>\u30de\u30c3\u30d4\u30f3\u30b0\u30c6\u30fc\u30d6\u30eb\u3067 COM \u4e92\u63db\u306e\u540d\u524d\u306b\u5909\u63db</li> </ul>"},{"location":"com-vs-ooxml-implementation/#5-shape-id","title":"5. Shape ID \u5272\u308a\u5f53\u3066","text":""},{"location":"com-vs-ooxml-implementation/#com_4","title":"COM \u5b9f\u88c5","text":"<pre><code>node_index = 0\nfor shp in iter_shapes_recursive(root):\n    if not is_relationship_geom:\n        node_index += 1\n        shape_id = node_index\n    if excel_name:\n        if shape_id is not None:\n            excel_names.append((excel_name, shape_id))\n</code></pre> <ul> <li>\u975e\u30b3\u30cd\u30af\u30bf\u30fc\u56f3\u5f62\u306b\u9023\u756a ID \u3092\u5272\u308a\u5f53\u3066</li> <li>Excel \u5185\u90e8\u540d\u3068 ID \u306e\u30de\u30c3\u30d4\u30f3\u30b0\u3092\u4fdd\u6301</li> </ul>"},{"location":"com-vs-ooxml-implementation/#ooxml_5","title":"OOXML \u5b9f\u88c5","text":"<pre><code>def _assign_shape_ids(parse_results: list[_ShapeParseResult]) -&gt; None:\n    excel_id_to_node_id: dict[str, int] = {}\n    node_index = 0\n    # First pass: assign node IDs to non-connector shapes\n    for result in parse_results:\n        if not result.is_connector and result.excel_id:\n            node_index += 1\n            result.shape.id = node_index\n            excel_id_to_node_id[result.excel_id] = node_index\n</code></pre> <ul> <li><code>&lt;xdr:cNvPr id=\"...\"&gt;</code> \u304b\u3089 Excel ID \u3092\u53d6\u5f97</li> <li>\u975e\u30b3\u30cd\u30af\u30bf\u30fc\u56f3\u5f62\u306b\u9023\u756a ID \u3092\u5272\u308a\u5f53\u3066</li> <li>Excel ID \u2192 Node ID \u306e\u30de\u30c3\u30d4\u30f3\u30b0\u3092\u69cb\u7bc9</li> </ul>"},{"location":"com-vs-ooxml-implementation/#6-direction","title":"6. \u30b3\u30cd\u30af\u30bf\u30fc\u65b9\u5411 (direction)","text":""},{"location":"com-vs-ooxml-implementation/#com_5","title":"COM \u5b9f\u88c5","text":"<pre><code>def compute_line_angle_deg(w: float, h: float) -&gt; float:\n    return math.degrees(math.atan2(h, w)) % 360.0\n\ndef angle_to_compass(angle: float) -&gt; str:\n    dirs = [\"E\", \"NE\", \"N\", \"NW\", \"W\", \"SW\", \"S\", \"SE\"]\n    idx = int(((angle + 22.5) % 360) // 45)\n    return dirs[idx]\n\nangle = compute_line_angle_deg(float(shp.width), float(shp.height))\nshape_obj.direction = angle_to_compass(angle)\n</code></pre>"},{"location":"com-vs-ooxml-implementation/#ooxml_6","title":"OOXML \u5b9f\u88c5","text":"<pre><code>def _compute_direction(width: int, height: int) -&gt; str | None:\n    angle = math.degrees(math.atan2(-height, width))\n    if angle &lt; 0:\n        angle += 360\n    # Map angle to compass direction\n    if 337.5 &lt;= angle or angle &lt; 22.5:\n        return \"E\"\n    elif 22.5 &lt;= angle &lt; 67.5:\n        return \"NE\"\n    ...\n</code></pre> <ul> <li>\u4e21\u5b9f\u88c5\u3068\u3082 <code>atan2</code> \u3067\u89d2\u5ea6\u3092\u8a08\u7b97\u3057\u30018\u65b9\u4f4d\u306b\u5909\u63db</li> <li>\u5ea7\u6a19\u7cfb\u306e\u9055\u3044\u306b\u3088\u308a\u7b26\u53f7\u304c\u7570\u306a\u308b</li> </ul>"},{"location":"com-vs-ooxml-implementation/#7-begin_arrow_style-end_arrow_style","title":"7. \u77e2\u5370\u30b9\u30bf\u30a4\u30eb (begin_arrow_style, end_arrow_style)","text":""},{"location":"com-vs-ooxml-implementation/#com_6","title":"COM \u5b9f\u88c5","text":"<pre><code>begin_style = int(shp.api.Line.BeginArrowheadStyle)\nend_style = int(shp.api.Line.EndArrowheadStyle)\nshape_obj.begin_arrow_style = begin_style\nshape_obj.end_arrow_style = end_style\n</code></pre> <ul> <li><code>MsoArrowheadStyle</code> \u5217\u6319\u5024\u3092\u76f4\u63a5\u4f7f\u7528</li> </ul>"},{"location":"com-vs-ooxml-implementation/#ooxml_7","title":"OOXML \u5b9f\u88c5","text":"<pre><code>ARROW_HEAD_MAP: dict[str, int] = {\n    \"none\": 1,\n    \"triangle\": 2,\n    \"stealth\": 3,\n    \"diamond\": 4,\n    \"oval\": 5,\n    \"arrow\": 2,\n}\n\ndef _get_arrow_styles(elem: Element) -&gt; tuple[int | None, int | None]:\n    ln = elem.find(\".//a:ln\", NS)\n    head_end = ln.find(\"a:headEnd\", NS)\n    tail_end = ln.find(\"a:tailEnd\", NS)\n    head_type = head_end.get(\"type\", \"none\")\n    begin_style = ARROW_HEAD_MAP.get(head_type, 1)\n    ...\n</code></pre> <ul> <li><code>&lt;a:ln&gt;&lt;a:headEnd type=\"...\"&gt;</code> \u304b\u3089\u53d6\u5f97</li> <li>OOXML \u540d\u3092 COM \u4e92\u63db\u306e\u6570\u5024\u306b\u5909\u63db</li> </ul>"},{"location":"com-vs-ooxml-implementation/#8-begin_id-end_id","title":"8. \u30b3\u30cd\u30af\u30bf\u30fc\u63a5\u7d9a\u60c5\u5831 (begin_id, end_id)","text":""},{"location":"com-vs-ooxml-implementation/#com_7","title":"COM \u5b9f\u88c5","text":"<pre><code>connector = shp.api.ConnectorFormat\nbegin_shape = connector.BeginConnectedShape\nif begin_shape is not None:\n    begin_name = getattr(begin_shape, \"Name\", None)\n# \u5f8c\u3067\u540d\u524d\u304b\u3089 ID \u306b\u5909\u63db\nshape_obj.begin_id = name_to_id.get(begin_name)\n</code></pre> <ul> <li><code>ConnectorFormat.BeginConnectedShape</code> / <code>EndConnectedShape</code> \u3092\u4f7f\u7528</li> <li>\u63a5\u7d9a\u5148\u56f3\u5f62\u306e\u540d\u524d\u3092\u53d6\u5f97\u3057\u3001ID \u30de\u30c3\u30d4\u30f3\u30b0\u3067\u5909\u63db</li> </ul>"},{"location":"com-vs-ooxml-implementation/#ooxml_8","title":"OOXML \u5b9f\u88c5","text":"<pre><code>def _get_connector_endpoints(elem: Element) -&gt; tuple[str | None, str | None]:\n    cnv_cxn_sp_pr = elem.find(\"xdr:nvCxnSpPr/xdr:cNvCxnSpPr\", NS)\n    st_cxn = cnv_cxn_sp_pr.find(\"a:stCxn\", NS)\n    end_cxn = cnv_cxn_sp_pr.find(\"a:endCxn\", NS)\n    start_id = st_cxn.get(\"id\") if st_cxn is not None else None\n    end_id = end_cxn.get(\"id\") if end_cxn is not None else None\n    return (start_id, end_id)\n\n# Second pass: resolve connector endpoints\nfor result in parse_results:\n    if result.is_connector:\n        if result.start_cxn_id and result.start_cxn_id in excel_id_to_node_id:\n            result.shape.begin_id = excel_id_to_node_id[result.start_cxn_id]\n</code></pre> <ul> <li><code>&lt;a:stCxn id=\"...\"&gt;</code> / <code>&lt;a:endCxn id=\"...\"&gt;</code> \u304b\u3089 Excel ID \u3092\u53d6\u5f97</li> <li>Excel ID \u2192 Node ID \u30de\u30c3\u30d4\u30f3\u30b0\u3067\u5909\u63db</li> </ul>"},{"location":"com-vs-ooxml-implementation/#9-rotation","title":"9. \u56de\u8ee2 (rotation)","text":""},{"location":"com-vs-ooxml-implementation/#com_8","title":"COM \u5b9f\u88c5","text":"<pre><code>rot = float(shp.api.Rotation)\nif abs(rot) &gt; 1e-6:\n    shape_obj.rotation = rot\n</code></pre>"},{"location":"com-vs-ooxml-implementation/#ooxml_9","title":"OOXML \u5b9f\u88c5","text":"<pre><code>def _get_rotation(elem: Element) -&gt; float | None:\n    xfrm = elem.find(\".//a:xfrm\", NS)\n    rot_str = xfrm.get(\"rot\")\n    # OOXML rotation is in 1/60000 of a degree\n    rot_emu = int(rot_str)\n    rot_deg = rot_emu / 60000.0\n    return rot_deg if abs(rot_deg) &gt;= 1e-6 else None\n</code></pre> <ul> <li>OOXML \u306f 1/60000 \u5ea6\u5358\u4f4d\u3067\u683c\u7d0d</li> <li>\u5ea6\u306b\u5909\u63db\u3057\u3066\u8fd4\u5374</li> </ul>"},{"location":"com-vs-ooxml-implementation/#10","title":"10. \u30b0\u30eb\u30fc\u30d7\u56f3\u5f62\u306e\u30d5\u30e9\u30c3\u30c8\u5316","text":""},{"location":"com-vs-ooxml-implementation/#com_9","title":"COM \u5b9f\u88c5","text":"<pre><code>def iter_shapes_recursive(shp: xw.Shape) -&gt; Iterator[xw.Shape]:\n    yield shp\n    if shp.api.Type == 6:  # Group\n        items = shp.api.GroupItems\n        for i in range(1, items.Count + 1):\n            inner = items.Item(i)\n            xl_shape = shp.parent.shapes[inner.Name]\n            yield from iter_shapes_recursive(xl_shape)\n</code></pre>"},{"location":"com-vs-ooxml-implementation/#ooxml_10","title":"OOXML \u5b9f\u88c5","text":"<pre><code>def _parse_group_shapes(grp_sp: Element, mode: str) -&gt; list[_ShapeParseResult]:\n    results: list[_ShapeParseResult] = []\n    for sp in grp_sp.findall(\"xdr:sp\", NS):\n        result = _parse_shape_element(sp, mode, is_cxn_sp=False)\n        if result is not None:\n            results.append(result)\n    for cxn_sp in grp_sp.findall(\"xdr:cxnSp\", NS):\n        result = _parse_shape_element(cxn_sp, mode, is_cxn_sp=True)\n        if result is not None:\n            results.append(result)\n    # Recursively parse nested groups\n    for nested_grp in grp_sp.findall(\"xdr:grpSp\", NS):\n        results.extend(_parse_group_shapes(nested_grp, mode))\n    return results\n</code></pre> <ul> <li>\u4e21\u5b9f\u88c5\u3068\u3082\u518d\u5e30\u7684\u306b\u30b0\u30eb\u30fc\u30d7\u5185\u306e\u56f3\u5f62\u3092\u5c55\u958b</li> <li>\u30cd\u30b9\u30c8\u3055\u308c\u305f\u30b0\u30eb\u30fc\u30d7\u3082\u5bfe\u5fdc</li> </ul>"},{"location":"com-vs-ooxml-implementation/#11","title":"11. \u51fa\u529b\u30e2\u30fc\u30c9\u30d5\u30a3\u30eb\u30bf\u30ea\u30f3\u30b0","text":""},{"location":"com-vs-ooxml-implementation/#com_10","title":"COM \u5b9f\u88c5","text":"<pre><code>def _should_include_shape(\n    text: str, shape_type_num: int | None, ..., output_mode: str = \"standard\"\n) -&gt; bool:\n    if output_mode == \"light\":\n        return False\n    is_relationship = (shape_type_num in (3, 9) or \n                       \"Arrow\" in autoshape_type_str or ...)\n    if output_mode == \"standard\":\n        return bool(text) or is_relationship\n    return True  # verbose\n</code></pre>"},{"location":"com-vs-ooxml-implementation/#ooxml_11","title":"OOXML \u5b9f\u88c5","text":"<pre><code>def _should_include_shape(text: str, type_label: str, is_connector: bool, mode: str) -&gt; bool:\n    if mode == \"light\":\n        return False\n    if mode == \"verbose\":\n        return True\n    # standard mode\n    if text:\n        return True\n    if is_connector:\n        return True\n    if type_label and \"Arrow\" in type_label:\n        return True\n    return False\n</code></pre> \u30e2\u30fc\u30c9 \u51fa\u529b\u5185\u5bb9 light Shape \u62bd\u51fa\u3092\u30b9\u30ad\u30c3\u30d7 standard \u30c6\u30ad\u30b9\u30c8\u3042\u308a or \u30b3\u30cd\u30af\u30bf\u30fc/\u77e2\u5370 verbose \u5168\u3066\u306e Shape"},{"location":"com-vs-ooxml-implementation/#chart","title":"Chart \u62bd\u51fa\u6a5f\u80fd","text":""},{"location":"com-vs-ooxml-implementation/#1-chart_type","title":"1. \u30c1\u30e3\u30fc\u30c8\u7a2e\u5225 (chart_type)","text":""},{"location":"com-vs-ooxml-implementation/#com_11","title":"COM \u5b9f\u88c5","text":"<pre><code>chart_com = sheet.api.ChartObjects(ch.name).Chart\nchart_type_num = chart_com.ChartType\nchart_type_label = XL_CHART_TYPE_MAP.get(chart_type_num, f\"unknown_{chart_type_num}\")\n</code></pre> <ul> <li><code>XlChartType</code> \u5217\u6319\u5024\u3092\u4f7f\u7528</li> </ul>"},{"location":"com-vs-ooxml-implementation/#ooxml_12","title":"OOXML \u5b9f\u88c5","text":"<pre><code>CHART_TYPE_MAP = {\n    \"lineChart\": \"Line\",\n    \"barChart\": \"Bar\",\n    \"pieChart\": \"Pie\",\n    ...\n}\n\ndef _get_chart_type(plot_area: Element) -&gt; str:\n    for tag, type_name in CHART_TYPE_MAP.items():\n        if plot_area.find(f\"c:{tag}\", NS) is not None:\n            return type_name\n    return \"unknown\"\n</code></pre> <ul> <li><code>&lt;c:plotArea&gt;</code> \u5185\u306e\u30c1\u30e3\u30fc\u30c8\u8981\u7d20\u30bf\u30b0\u3067\u5224\u5b9a</li> </ul>"},{"location":"com-vs-ooxml-implementation/#2-title","title":"2. \u30bf\u30a4\u30c8\u30eb (title)","text":""},{"location":"com-vs-ooxml-implementation/#com_12","title":"COM \u5b9f\u88c5","text":"<pre><code>title = chart_com.ChartTitle.Text if chart_com.HasTitle else None\n</code></pre>"},{"location":"com-vs-ooxml-implementation/#ooxml_13","title":"OOXML \u5b9f\u88c5","text":"<pre><code>def _get_chart_title(chart_elem: Element) -&gt; str | None:\n    title_elem = chart_elem.find(\".//c:title\", NS)\n    # Try rich text first\n    for t_elem in title_elem.findall(\".//a:t\", NS):\n        if t_elem.text:\n            return t_elem.text.strip()\n    # Try string reference\n    str_ref = title_elem.find(\".//c:strRef/c:strCache/c:pt/c:v\", NS)\n    if str_ref is not None and str_ref.text:\n        return str_ref.text.strip()\n    return None\n</code></pre> <ul> <li>\u30ea\u30c3\u30c1\u30c6\u30ad\u30b9\u30c8\u307e\u305f\u306f\u30bb\u30eb\u53c2\u7167\u304b\u3089\u30bf\u30a4\u30c8\u30eb\u3092\u53d6\u5f97</li> </ul>"},{"location":"com-vs-ooxml-implementation/#3-y-y_axis_title-y_axis_range","title":"3. Y\u8ef8\u60c5\u5831 (y_axis_title, y_axis_range)","text":""},{"location":"com-vs-ooxml-implementation/#com_13","title":"COM \u5b9f\u88c5","text":"<pre><code>y_axis = chart_com.Axes(2, 1)  # xlValue, xlPrimary\nif y_axis.HasTitle:\n    y_axis_title = y_axis.AxisTitle.Text\ny_axis_range = [y_axis.MinimumScale, y_axis.MaximumScale]\n</code></pre>"},{"location":"com-vs-ooxml-implementation/#ooxml_14","title":"OOXML \u5b9f\u88c5","text":"<pre><code>def _get_axis_title(plot_area: Element, axis_type: str) -&gt; str:\n    axis = plot_area.find(f\"c:{axis_type}\", NS)\n    title = axis.find(\"c:title\", NS)\n    for t_elem in title.findall(\".//a:t\", NS):\n        if t_elem.text:\n            return t_elem.text.strip()\n    return \"\"\n\ndef _get_axis_range(plot_area: Element, axis_type: str) -&gt; list[float]:\n    axis = plot_area.find(f\"c:{axis_type}\", NS)\n    scaling = axis.find(\"c:scaling\", NS)\n    min_elem = scaling.find(\"c:min\", NS)\n    max_elem = scaling.find(\"c:max\", NS)\n    ...\n</code></pre> <ul> <li><code>&lt;c:valAx&gt;</code> \u8981\u7d20\u304b\u3089\u8ef8\u60c5\u5831\u3092\u53d6\u5f97</li> </ul>"},{"location":"com-vs-ooxml-implementation/#4-series","title":"4. \u7cfb\u5217\u30c7\u30fc\u30bf (series)","text":""},{"location":"com-vs-ooxml-implementation/#com_14","title":"COM \u5b9f\u88c5","text":"<pre><code>for s in chart_com.SeriesCollection():\n    parsed = parse_series_formula(getattr(s, \"Formula\", \"\"))\n    # =SERIES(name, x_range, y_range, plot_order) \u3092\u30d1\u30fc\u30b9\n    series_list.append(ChartSeries(\n        name=s.Name,\n        name_range=parsed[\"name_range\"],\n        x_range=parsed[\"x_range\"],\n        y_range=parsed[\"y_range\"],\n    ))\n</code></pre> <ul> <li><code>=SERIES(...)</code> \u6570\u5f0f\u3092\u30d1\u30fc\u30b9\u3057\u3066\u7bc4\u56f2\u3092\u62bd\u51fa</li> </ul>"},{"location":"com-vs-ooxml-implementation/#ooxml_15","title":"OOXML \u5b9f\u88c5","text":"<pre><code>def _get_series_data(ser_elem: Element) -&gt; ChartSeries:\n    name, name_range = _extract_series_name(ser_elem)\n    x_range = _extract_range_from_ref(ser_elem.find(\"c:cat\", NS), [\"c:strRef\", \"c:numRef\"])\n    y_range = _extract_range_from_ref(ser_elem.find(\"c:val\", NS), [\"c:numRef\"])\n    return ChartSeries(name=name, name_range=name_range, x_range=x_range, y_range=y_range)\n</code></pre> <ul> <li><code>&lt;c:ser&gt;</code> \u8981\u7d20\u304b\u3089\u76f4\u63a5\u7bc4\u56f2\u53c2\u7167\u3092\u53d6\u5f97</li> </ul>"},{"location":"com-vs-ooxml-implementation/#_3","title":"\u5b9f\u88c5\u65b9\u6cd5\u306e\u6bd4\u8f03","text":""},{"location":"com-vs-ooxml-implementation/#_4","title":"\u30c7\u30fc\u30bf\u30a2\u30af\u30bb\u30b9\u65b9\u5f0f","text":"\u9805\u76ee COM OOXML \u30a2\u30af\u30bb\u30b9\u65b9\u5f0f \u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u30e2\u30c7\u30eb XML \u30d1\u30fc\u30b9 \u30c7\u30fc\u30bf\u30bd\u30fc\u30b9 Excel \u30d7\u30ed\u30bb\u30b9 ZIP \u5185 XML \u30d5\u30a1\u30a4\u30eb \u5ea7\u6a19\u5358\u4f4d \u30dd\u30a4\u30f3\u30c8 EMU \u578b\u60c5\u5831 \u5217\u6319\u5024 (int) \u6587\u5b57\u5217\u5c5e\u6027"},{"location":"com-vs-ooxml-implementation/#ooxml_16","title":"\u30d5\u30a1\u30a4\u30eb\u69cb\u9020 (OOXML)","text":"<pre><code>sample.xlsx (ZIP)\n\u251c\u2500\u2500 xl/\n\u2502   \u251c\u2500\u2500 workbook.xml           # \u30d6\u30c3\u30af\u60c5\u5831\n\u2502   \u251c\u2500\u2500 worksheets/\n\u2502   \u2502   \u2514\u2500\u2500 sheet1.xml         # \u30b7\u30fc\u30c8\u30c7\u30fc\u30bf\n\u2502   \u251c\u2500\u2500 drawings/\n\u2502   \u2502   \u2514\u2500\u2500 drawing1.xml       # \u56f3\u5f62\u5b9a\u7fa9 (DrawingML)\n\u2502   \u251c\u2500\u2500 charts/\n\u2502   \u2502   \u2514\u2500\u2500 chart1.xml         # \u30c1\u30e3\u30fc\u30c8\u5b9a\u7fa9 (ChartML)\n\u2502   \u2514\u2500\u2500 _rels/\n\u2502       \u2514\u2500\u2500 workbook.xml.rels  # \u30ea\u30ec\u30fc\u30b7\u30e7\u30f3\u30b7\u30c3\u30d7\n\u2514\u2500\u2500 [Content_Types].xml\n</code></pre>"},{"location":"com-vs-ooxml-implementation/#xml","title":"XML \u540d\u524d\u7a7a\u9593","text":"<pre><code># DrawingML\nNS = {\n    \"xdr\": \"http://schemas.openxmlformats.org/drawingml/2006/spreadsheetDrawing\",\n    \"a\": \"http://schemas.openxmlformats.org/drawingml/2006/main\",\n}\n\n# ChartML\nNS = {\n    \"c\": \"http://schemas.openxmlformats.org/drawingml/2006/chart\",\n    \"a\": \"http://schemas.openxmlformats.org/drawingml/2006/main\",\n}\n</code></pre>"},{"location":"com-vs-ooxml-implementation/#_5","title":"\u6a5f\u80fd\u5bfe\u5fdc\u8868","text":""},{"location":"com-vs-ooxml-implementation/#shape_1","title":"Shape \u6a5f\u80fd","text":"\u6a5f\u80fd COM OOXML \u5099\u8003 \u4f4d\u7f6e (l, t) \u2713 \u2713 \u30b5\u30a4\u30ba (w, h) \u2713 \u2713 verbose/Group \u306e\u307f \u30c6\u30ad\u30b9\u30c8 \u2713 \u2713 \u7a2e\u5225 (type) \u2713 \u2713 \u30de\u30c3\u30d4\u30f3\u30b0\u30c6\u30fc\u30d6\u30eb\u3067\u4e92\u63db ID \u5272\u308a\u5f53\u3066 \u2713 \u2713 \u65b9\u5411 (direction) \u2713 \u2713 \u30b3\u30cd\u30af\u30bf\u30fc/\u7dda\u306e\u307f \u77e2\u5370\u30b9\u30bf\u30a4\u30eb \u2713 \u2713 \u30b3\u30cd\u30af\u30bf\u30fc\u63a5\u7d9a (begin_id, end_id) \u2713 \u2713 \u56de\u8ee2 (rotation) \u2713 \u2713 \u30b0\u30eb\u30fc\u30d7\u30d5\u30e9\u30c3\u30c8\u5316 \u2713 \u2713 \u518d\u5e30\u7684\u306b\u5c55\u958b \u30e2\u30fc\u30c9\u30d5\u30a3\u30eb\u30bf\u30ea\u30f3\u30b0 \u2713 \u2713 light/standard/verbose"},{"location":"com-vs-ooxml-implementation/#chart_1","title":"Chart \u6a5f\u80fd","text":"\u6a5f\u80fd COM OOXML \u5099\u8003 \u4f4d\u7f6e (l, t) \u2713 \u2713 \u30b5\u30a4\u30ba (w, h) \u2713 \u2713 verbose \u306e\u307f \u30c1\u30e3\u30fc\u30c8\u7a2e\u5225 \u2713 \u2713 \u30bf\u30a4\u30c8\u30eb \u2713 \u2713 Y\u8ef8\u30bf\u30a4\u30c8\u30eb \u2713 \u2713 Y\u8ef8\u7bc4\u56f2 \u2713 \u2713 \u7cfb\u5217\u540d \u2713 \u2713 \u7cfb\u5217\u7bc4\u56f2 (x_range, y_range) \u2713 \u2713"},{"location":"com-vs-ooxml-implementation/#ooxml_17","title":"OOXML \u3067\u5b9f\u88c5\u3067\u304d\u306a\u3044/\u56f0\u96e3\u306a\u6a5f\u80fd","text":"<p>OOXML (Office Open XML) \u306f\u30d5\u30a1\u30a4\u30eb\u30d5\u30a9\u30fc\u30de\u30c3\u30c8\u4ed5\u69d8\u3067\u3042\u308a\u3001Excel \u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306e\u52d5\u7684\u306a\u8a08\u7b97\u6a5f\u80fd\u306b\u306f\u30a2\u30af\u30bb\u30b9\u3067\u304d\u307e\u305b\u3093\u3002\u4ee5\u4e0b\u306b\u3001OOXML \u3067\u5b9f\u88c5\u304c\u4e0d\u53ef\u80fd\u307e\u305f\u306f\u56f0\u96e3\u306a\u6a5f\u80fd\u3068\u305d\u306e\u6280\u8853\u7684\u7406\u7531\u3092\u8aac\u660e\u3057\u307e\u3059\u3002</p>"},{"location":"com-vs-ooxml-implementation/#1-y","title":"1. \u81ea\u52d5\u8a08\u7b97\u3055\u308c\u305f Y \u8ef8\u7bc4\u56f2","text":""},{"location":"com-vs-ooxml-implementation/#_6","title":"\u6a5f\u80fd\u6982\u8981","text":"<p>\u30c1\u30e3\u30fc\u30c8\u306e Y \u8ef8\u7bc4\u56f2\uff08\u6700\u5c0f\u5024\u30fb\u6700\u5927\u5024\uff09\u306f\u3001Excel \u304c\u7cfb\u5217\u30c7\u30fc\u30bf\u306b\u57fa\u3065\u3044\u3066\u81ea\u52d5\u8a08\u7b97\u3059\u308b\u5834\u5408\u304c\u3042\u308a\u307e\u3059\u3002</p>"},{"location":"com-vs-ooxml-implementation/#com_15","title":"COM \u5b9f\u88c5","text":"<pre><code>y_axis = chart_com.Axes(2, 1)  # xlValue, xlPrimary\ny_axis_range = [y_axis.MinimumScale, y_axis.MaximumScale]\n</code></pre> <ul> <li>Excel \u30d7\u30ed\u30bb\u30b9\u304c\u8a08\u7b97\u3057\u305f\u5b9f\u969b\u306e\u5024\u3092\u53d6\u5f97</li> </ul>"},{"location":"com-vs-ooxml-implementation/#ooxml_18","title":"OOXML \u306e\u5236\u9650","text":"<pre><code>&lt;!-- \u81ea\u52d5\u30b9\u30b1\u30fc\u30eb\u306e\u5834\u5408\u3001min/max \u8981\u7d20\u304c\u5b58\u5728\u3057\u306a\u3044 --&gt;\n&lt;c:scaling&gt;\n  &lt;c:orientation val=\"minMax\"/&gt;\n  &lt;!-- &lt;c:min val=\"...\"/&gt; \u304c\u7701\u7565\u3055\u308c\u308b --&gt;\n  &lt;!-- &lt;c:max val=\"...\"/&gt; \u304c\u7701\u7565\u3055\u308c\u308b --&gt;\n&lt;/c:scaling&gt;\n</code></pre>"},{"location":"com-vs-ooxml-implementation/#_7","title":"\u5b9f\u88c5\u4e0d\u53ef\u80fd\u306a\u7406\u7531","text":"<ul> <li>OOXML \u30d5\u30a1\u30a4\u30eb\u306b\u306f\u300c\u81ea\u52d5\u300d\u3068\u3044\u3046\u8a2d\u5b9a\u306e\u307f\u304c\u4fdd\u5b58\u3055\u308c\u308b</li> <li>\u5b9f\u969b\u306e min/max \u5024\u306f Excel \u304c\u63cf\u753b\u6642\u306b\u52d5\u7684\u306b\u8a08\u7b97\u3059\u308b</li> <li>\u8a08\u7b97\u306b\u306f\u7cfb\u5217\u30c7\u30fc\u30bf\u306e\u89e3\u6790\u3001\u9069\u5207\u306a\u76ee\u76db\u308a\u9593\u9694\u306e\u6c7a\u5b9a\u306a\u3069\u8907\u96d1\u306a\u30ed\u30b8\u30c3\u30af\u304c\u5fc5\u8981</li> <li>Excel \u306e\u81ea\u52d5\u30b9\u30b1\u30fc\u30ea\u30f3\u30b0\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\u306f\u975e\u516c\u958b</li> </ul>"},{"location":"com-vs-ooxml-implementation/#_8","title":"\u73fe\u5728\u306e\u52d5\u4f5c","text":"<ul> <li>OOXML: <code>&lt;c:min&gt;</code> / <code>&lt;c:max&gt;</code> \u8981\u7d20\u304c\u5b58\u5728\u3059\u308b\u5834\u5408\u306e\u307f\u5024\u3092\u8fd4\u3059</li> <li>\u81ea\u52d5\u30b9\u30b1\u30fc\u30eb\u306e\u5834\u5408\u306f\u7a7a\u30ea\u30b9\u30c8 <code>[]</code> \u3092\u8fd4\u3059</li> </ul>"},{"location":"com-vs-ooxml-implementation/#2","title":"2. \u30bb\u30eb\u53c2\u7167\u304b\u3089\u89e3\u6c7a\u3055\u308c\u305f\u30bf\u30a4\u30c8\u30eb/\u30e9\u30d9\u30eb","text":""},{"location":"com-vs-ooxml-implementation/#_9","title":"\u6a5f\u80fd\u6982\u8981","text":"<p>\u30c1\u30e3\u30fc\u30c8\u306e\u30bf\u30a4\u30c8\u30eb\u3084\u8ef8\u30e9\u30d9\u30eb\u306f\u3001\u30bb\u30eb\u53c2\u7167\uff08\u4f8b: <code>=Sheet1!$A$1</code>\uff09\u3067\u6307\u5b9a\u3067\u304d\u307e\u3059\u3002</p>"},{"location":"com-vs-ooxml-implementation/#com_16","title":"COM \u5b9f\u88c5","text":"<pre><code>title = chart_com.ChartTitle.Text  # \u89e3\u6c7a\u6e08\u307f\u306e\u6587\u5b57\u5217\n</code></pre> <ul> <li>Excel \u304c\u53c2\u7167\u3092\u89e3\u6c7a\u3057\u3001\u5b9f\u969b\u306e\u30c6\u30ad\u30b9\u30c8\u3092\u8fd4\u3059</li> </ul>"},{"location":"com-vs-ooxml-implementation/#ooxml_19","title":"OOXML \u306e\u5236\u9650","text":"<pre><code>&lt;c:title&gt;\n  &lt;c:tx&gt;\n    &lt;c:strRef&gt;\n      &lt;c:f&gt;Sheet1!$A$1&lt;/c:f&gt;\n      &lt;!-- \u30ad\u30e3\u30c3\u30b7\u30e5\u304c\u306a\u3044\u5834\u5408\u3001\u5024\u304c\u4e0d\u660e --&gt;\n    &lt;/c:strRef&gt;\n  &lt;/c:tx&gt;\n&lt;/c:title&gt;\n</code></pre>"},{"location":"com-vs-ooxml-implementation/#_10","title":"\u5b9f\u88c5\u56f0\u96e3\u306a\u7406\u7531","text":"<ul> <li>OOXML \u306b\u306f\u30bb\u30eb\u53c2\u7167\u306e\u6570\u5f0f\u306e\u307f\u304c\u4fdd\u5b58\u3055\u308c\u308b</li> <li>\u53c2\u7167\u5148\u306e\u30bb\u30eb\u5024\u3092\u53d6\u5f97\u3059\u308b\u306b\u306f\u3001\u30b7\u30fc\u30c8\u30c7\u30fc\u30bf\uff08<code>xl/worksheets/sheet*.xml</code>\uff09\u3092\u30d1\u30fc\u30b9\u3059\u308b\u5fc5\u8981\u304c\u3042\u308b</li> <li>\u6570\u5f0f\u304c\u8907\u96d1\u306a\u5834\u5408\uff08\u4f8b: <code>=CONCATENATE(A1, B1)</code>\uff09\u3001\u6570\u5f0f\u30a8\u30f3\u30b8\u30f3\u304c\u5fc5\u8981</li> <li>\u73fe\u5728\u306e\u5b9f\u88c5\u3067\u306f <code>&lt;c:strCache&gt;</code> \u306e\u30ad\u30e3\u30c3\u30b7\u30e5\u5024\u3092\u4f7f\u7528\u3059\u308b\u304c\u3001\u30ad\u30e3\u30c3\u30b7\u30e5\u304c\u53e4\u3044\u53ef\u80fd\u6027\u304c\u3042\u308b</li> </ul>"},{"location":"com-vs-ooxml-implementation/#_11","title":"\u73fe\u5728\u306e\u52d5\u4f5c","text":"<ul> <li>OOXML: \u30ad\u30e3\u30c3\u30b7\u30e5\u5024 <code>&lt;c:strCache&gt;&lt;c:pt&gt;&lt;c:v&gt;</code> \u3092\u512a\u5148\u7684\u306b\u4f7f\u7528</li> <li>\u30ad\u30e3\u30c3\u30b7\u30e5\u304c\u306a\u3044\u5834\u5408\u306f <code>None</code> \u3092\u8fd4\u3059</li> </ul>"},{"location":"com-vs-ooxml-implementation/#3_1","title":"3. \u52d5\u7684\u306b\u8a08\u7b97\u3055\u308c\u308b\u30d5\u30a9\u30f3\u30c8/\u30b9\u30bf\u30a4\u30eb\u60c5\u5831","text":""},{"location":"com-vs-ooxml-implementation/#_12","title":"\u6a5f\u80fd\u6982\u8981","text":"<p>\u56f3\u5f62\u306e\u30c6\u30ad\u30b9\u30c8\u306b\u306f\u3001\u30c6\u30fc\u30de\u3084\u30b9\u30bf\u30a4\u30eb\u306b\u57fa\u3065\u3044\u3066\u52d5\u7684\u306b\u6c7a\u5b9a\u3055\u308c\u308b\u30d5\u30a9\u30f3\u30c8\u60c5\u5831\u304c\u3042\u308a\u307e\u3059\u3002</p>"},{"location":"com-vs-ooxml-implementation/#com_17","title":"COM \u5b9f\u88c5","text":"<pre><code>font = shp.api.TextFrame.Characters.Font\nfont_name = font.Name  # \u89e3\u6c7a\u6e08\u307f\u306e\u30d5\u30a9\u30f3\u30c8\u540d\nfont_size = font.Size  # \u89e3\u6c7a\u6e08\u307f\u306e\u30b5\u30a4\u30ba\n</code></pre>"},{"location":"com-vs-ooxml-implementation/#ooxml_20","title":"OOXML \u306e\u5236\u9650","text":"<pre><code>&lt;a:rPr&gt;\n  &lt;a:latin typeface=\"+mn-lt\"/&gt;  &lt;!-- \u30c6\u30fc\u30de\u30d5\u30a9\u30f3\u30c8\u53c2\u7167 --&gt;\n&lt;/a:rPr&gt;\n</code></pre>"},{"location":"com-vs-ooxml-implementation/#_13","title":"\u5b9f\u88c5\u56f0\u96e3\u306a\u7406\u7531","text":"<ul> <li><code>+mn-lt</code> \u306f\u30c6\u30fc\u30de\u306e\u300c\u672c\u6587\u30d5\u30a9\u30f3\u30c8\uff08\u30e9\u30c6\u30f3\u6587\u5b57\uff09\u300d\u3078\u306e\u53c2\u7167</li> <li>\u5b9f\u969b\u306e\u30d5\u30a9\u30f3\u30c8\u540d\u3092\u89e3\u6c7a\u3059\u308b\u306b\u306f <code>xl/theme/theme1.xml</code> \u306e\u30d1\u30fc\u30b9\u304c\u5fc5\u8981</li> <li>\u30c6\u30fc\u30de\u306e\u7d99\u627f\u3001\u30aa\u30fc\u30d0\u30fc\u30e9\u30a4\u30c9\u3001\u30ed\u30b1\u30fc\u30eb\u4f9d\u5b58\u306e\u51e6\u7406\u304c\u8907\u96d1</li> <li>ExStruct \u306e\u73fe\u5728\u306e\u30b9\u30b3\u30fc\u30d7\u5916\uff08\u30c6\u30ad\u30b9\u30c8\u5185\u5bb9\u306e\u307f\u62bd\u51fa\uff09</li> </ul>"},{"location":"com-vs-ooxml-implementation/#_14","title":"\u73fe\u5728\u306e\u52d5\u4f5c","text":"<ul> <li>OOXML: \u30d5\u30a9\u30f3\u30c8\u60c5\u5831\u306f\u62bd\u51fa\u3057\u306a\u3044\uff08\u30c6\u30ad\u30b9\u30c8\u5185\u5bb9\u306e\u307f\uff09</li> </ul>"},{"location":"com-vs-ooxml-implementation/#4-ole","title":"4. OLE \u30aa\u30d6\u30b8\u30a7\u30af\u30c8 / \u57cb\u3081\u8fbc\u307f\u30aa\u30d6\u30b8\u30a7\u30af\u30c8","text":""},{"location":"com-vs-ooxml-implementation/#_15","title":"\u6a5f\u80fd\u6982\u8981","text":"<p>Excel \u306b\u306f\u4ed6\u306e\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\uff08Word\u3001PowerPoint\u3001PDF \u306a\u3069\uff09\u306e\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u57cb\u3081\u8fbc\u3080\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002</p>"},{"location":"com-vs-ooxml-implementation/#com_18","title":"COM \u5b9f\u88c5","text":"<pre><code>if shp.api.Type == 12:  # msoOLEControlObject\n    ole = shp.api.OLEFormat\n    # OLE \u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306b\u30a2\u30af\u30bb\u30b9\u53ef\u80fd\n</code></pre>"},{"location":"com-vs-ooxml-implementation/#ooxml_21","title":"OOXML \u306e\u5236\u9650","text":"<pre><code>&lt;mc:AlternateContent&gt;\n  &lt;mc:Choice Requires=\"v\"&gt;\n    &lt;!-- VML \u5f62\u5f0f\u306e OLE \u30aa\u30d6\u30b8\u30a7\u30af\u30c8 --&gt;\n  &lt;/mc:Choice&gt;\n&lt;/mc:AlternateContent&gt;\n</code></pre>"},{"location":"com-vs-ooxml-implementation/#_16","title":"\u5b9f\u88c5\u4e0d\u53ef\u80fd\u306a\u7406\u7531","text":"<ul> <li>OLE \u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306f\u30d0\u30a4\u30ca\u30ea\u5f62\u5f0f\u3067\u57cb\u3081\u8fbc\u307e\u308c\u308b</li> <li>\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306e\u5185\u5bb9\u3092\u89e3\u91c8\u3059\u308b\u306b\u306f\u3001\u5404\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u56fa\u6709\u306e\u30d1\u30fc\u30b5\u30fc\u304c\u5fc5\u8981</li> <li>\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u4e0a\u306e\u7406\u7531\u304b\u3089\u3001OLE \u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306e\u81ea\u52d5\u5b9f\u884c\u306f\u5371\u967a</li> <li>ExStruct \u306e\u30b9\u30b3\u30fc\u30d7\u5916\uff08Shape/Chart \u306e\u307f\u5bfe\u8c61\uff09</li> </ul>"},{"location":"com-vs-ooxml-implementation/#_17","title":"\u73fe\u5728\u306e\u52d5\u4f5c","text":"<ul> <li>OOXML: OLE \u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306f\u30b9\u30ad\u30c3\u30d7\uff08\u62bd\u51fa\u5bfe\u8c61\u5916\uff09</li> </ul>"},{"location":"com-vs-ooxml-implementation/#5-vba","title":"5. \u30de\u30af\u30ed / VBA \u30b3\u30fc\u30c9","text":""},{"location":"com-vs-ooxml-implementation/#_18","title":"\u6a5f\u80fd\u6982\u8981","text":"<p><code>.xlsm</code> \u30d5\u30a1\u30a4\u30eb\u306b\u306f VBA \u30de\u30af\u30ed\u304c\u542b\u307e\u308c\u308b\u5834\u5408\u304c\u3042\u308a\u307e\u3059\u3002</p>"},{"location":"com-vs-ooxml-implementation/#com_19","title":"COM \u5b9f\u88c5","text":"<pre><code># VBA \u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306b\u30a2\u30af\u30bb\u30b9\u53ef\u80fd\uff08\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u8a2d\u5b9a\u306b\u3088\u308b\uff09\nvba = workbook.api.VBProject\n</code></pre>"},{"location":"com-vs-ooxml-implementation/#ooxml_22","title":"OOXML \u306e\u5236\u9650","text":"<ul> <li>VBA \u30b3\u30fc\u30c9\u306f <code>xl/vbaProject.bin</code> \u306b\u30d0\u30a4\u30ca\u30ea\u5f62\u5f0f\u3067\u4fdd\u5b58</li> <li>OOXML \u6a19\u6e96\u306e\u4e00\u90e8\u3067\u306f\u306a\u3044\uff08Microsoft \u62e1\u5f35\uff09</li> </ul>"},{"location":"com-vs-ooxml-implementation/#_19","title":"\u5b9f\u88c5\u4e0d\u53ef\u80fd\u306a\u7406\u7531","text":"<ul> <li>VBA \u30d0\u30a4\u30ca\u30ea\u5f62\u5f0f\u306f\u975e\u516c\u958b\u4ed5\u69d8</li> <li>\u30de\u30af\u30ed\u306e\u5b9f\u884c\u306b\u306f VBA \u30e9\u30f3\u30bf\u30a4\u30e0\u304c\u5fc5\u8981</li> <li>\u30bb\u30ad\u30e5\u30ea\u30c6\u30a3\u30ea\u30b9\u30af\u304c\u9ad8\u3044</li> <li>ExStruct \u306e\u30b9\u30b3\u30fc\u30d7\u5916</li> </ul>"},{"location":"com-vs-ooxml-implementation/#_20","title":"\u73fe\u5728\u306e\u52d5\u4f5c","text":"<ul> <li>OOXML: \u30de\u30af\u30ed\u306f\u7121\u8996\uff08\u30c7\u30fc\u30bf\u62bd\u51fa\u306e\u307f\uff09</li> </ul>"},{"location":"com-vs-ooxml-implementation/#6","title":"6. \u6761\u4ef6\u4ed8\u304d\u66f8\u5f0f\u306e\u8a55\u4fa1\u7d50\u679c","text":""},{"location":"com-vs-ooxml-implementation/#_21","title":"\u6a5f\u80fd\u6982\u8981","text":"<p>\u30bb\u30eb\u3084\u56f3\u5f62\u306b\u306f\u6761\u4ef6\u4ed8\u304d\u66f8\u5f0f\u304c\u9069\u7528\u3055\u308c\u3001\u30c7\u30fc\u30bf\u306b\u5fdc\u3058\u3066\u8272\u3084\u30b9\u30bf\u30a4\u30eb\u304c\u5909\u5316\u3057\u307e\u3059\u3002</p>"},{"location":"com-vs-ooxml-implementation/#com_20","title":"COM \u5b9f\u88c5","text":"<pre><code># \u73fe\u5728\u306e\u8868\u793a\u72b6\u614b\u3092\u53d6\u5f97\ninterior_color = cell.api.DisplayFormat.Interior.Color\n</code></pre>"},{"location":"com-vs-ooxml-implementation/#ooxml_23","title":"OOXML \u306e\u5236\u9650","text":"<pre><code>&lt;conditionalFormatting&gt;\n  &lt;cfRule type=\"cellIs\" operator=\"greaterThan\"&gt;\n    &lt;formula&gt;100&lt;/formula&gt;\n  &lt;/cfRule&gt;\n&lt;/conditionalFormatting&gt;\n</code></pre>"},{"location":"com-vs-ooxml-implementation/#_22","title":"\u5b9f\u88c5\u4e0d\u53ef\u80fd\u306a\u7406\u7531","text":"<ul> <li>OOXML \u306b\u306f\u30eb\u30fc\u30eb\u5b9a\u7fa9\u306e\u307f\u304c\u4fdd\u5b58\u3055\u308c\u308b</li> <li>\u5b9f\u969b\u306e\u8a55\u4fa1\u7d50\u679c\u306f Excel \u304c\u52d5\u7684\u306b\u8a08\u7b97</li> <li>\u6761\u4ef6\u5f0f\u306e\u8a55\u4fa1\u306b\u306f\u6570\u5f0f\u30a8\u30f3\u30b8\u30f3\u304c\u5fc5\u8981</li> <li>ExStruct \u306e\u30b9\u30b3\u30fc\u30d7\u5916\uff08\u66f8\u5f0f\u60c5\u5831\u306f\u62bd\u51fa\u5bfe\u8c61\u5916\uff09</li> </ul>"},{"location":"com-vs-ooxml-implementation/#_23","title":"\u73fe\u5728\u306e\u52d5\u4f5c","text":"<ul> <li>OOXML: \u6761\u4ef6\u4ed8\u304d\u66f8\u5f0f\u306f\u7121\u8996</li> </ul>"},{"location":"com-vs-ooxml-implementation/#7","title":"7. \u6570\u5f0f\u306e\u8a08\u7b97\u7d50\u679c\uff08\u30ad\u30e3\u30c3\u30b7\u30e5\u306a\u3057\u306e\u5834\u5408\uff09","text":""},{"location":"com-vs-ooxml-implementation/#_24","title":"\u6a5f\u80fd\u6982\u8981","text":"<p>\u30bb\u30eb\u306b\u6570\u5f0f\u304c\u542b\u307e\u308c\u308b\u5834\u5408\u3001\u8a08\u7b97\u7d50\u679c\u304c\u5fc5\u8981\u306b\u306a\u308b\u3053\u3068\u304c\u3042\u308a\u307e\u3059\u3002</p>"},{"location":"com-vs-ooxml-implementation/#com_21","title":"COM \u5b9f\u88c5","text":"<pre><code>value = cell.value  # \u8a08\u7b97\u6e08\u307f\u306e\u5024\nformula = cell.formula  # \u6570\u5f0f\n</code></pre>"},{"location":"com-vs-ooxml-implementation/#ooxml_24","title":"OOXML \u306e\u5236\u9650","text":"<pre><code>&lt;c:v&gt;123&lt;/c:v&gt;  &lt;!-- \u30ad\u30e3\u30c3\u30b7\u30e5\u5024 --&gt;\n&lt;c:f&gt;SUM(A1:A10)&lt;/c:f&gt;  &lt;!-- \u6570\u5f0f --&gt;\n</code></pre>"},{"location":"com-vs-ooxml-implementation/#_25","title":"\u5b9f\u88c5\u56f0\u96e3\u306a\u7406\u7531","text":"<ul> <li>OOXML \u306b\u306f\u30ad\u30e3\u30c3\u30b7\u30e5\u5024\u304c\u4fdd\u5b58\u3055\u308c\u308b\u304c\u3001\u30d5\u30a1\u30a4\u30eb\u4fdd\u5b58\u5f8c\u306b\u5143\u30c7\u30fc\u30bf\u304c\u5909\u66f4\u3055\u308c\u305f\u5834\u5408\u306f\u53e4\u3044</li> <li>\u6570\u5f0f\u3092\u518d\u8a08\u7b97\u3059\u308b\u306b\u306f\u5b8c\u5168\u306a\u6570\u5f0f\u30a8\u30f3\u30b8\u30f3\u304c\u5fc5\u8981</li> <li>Excel \u306e\u6570\u5f0f\u306f 400 \u4ee5\u4e0a\u306e\u95a2\u6570\u3092\u30b5\u30dd\u30fc\u30c8</li> <li>\u5916\u90e8\u53c2\u7167\u3001\u540d\u524d\u4ed8\u304d\u7bc4\u56f2\u3001\u914d\u5217\u6570\u5f0f\u306a\u3069\u8907\u96d1\u306a\u6a5f\u80fd\u304c\u3042\u308b</li> </ul>"},{"location":"com-vs-ooxml-implementation/#_26","title":"\u73fe\u5728\u306e\u52d5\u4f5c","text":"<ul> <li>OOXML: \u30ad\u30e3\u30c3\u30b7\u30e5\u5024\u3092\u4f7f\u7528\uff08\u5b58\u5728\u3059\u308b\u5834\u5408\uff09</li> <li>\u30ad\u30e3\u30c3\u30b7\u30e5\u304c\u306a\u3044\u5834\u5408\u306f\u6570\u5f0f\u6587\u5b57\u5217\u3092\u8fd4\u3059</li> </ul>"},{"location":"com-vs-ooxml-implementation/#8","title":"8. \u8907\u5408\u30c1\u30e3\u30fc\u30c8\u306e\u8a73\u7d30\u306a\u7a2e\u5225\u5224\u5b9a","text":""},{"location":"com-vs-ooxml-implementation/#_27","title":"\u6a5f\u80fd\u6982\u8981","text":"<p>Excel \u3067\u306f\u8907\u6570\u306e\u30c1\u30e3\u30fc\u30c8\u7a2e\u5225\u3092\u7d44\u307f\u5408\u308f\u305b\u305f\u8907\u5408\u30c1\u30e3\u30fc\u30c8\u3092\u4f5c\u6210\u3067\u304d\u307e\u3059\u3002</p>"},{"location":"com-vs-ooxml-implementation/#com_22","title":"COM \u5b9f\u88c5","text":"<pre><code>chart_type = chart_com.ChartType  # \u4e3b\u8981\u306a\u30c1\u30e3\u30fc\u30c8\u7a2e\u5225\n# \u5404\u7cfb\u5217\u3054\u3068\u306e\u7a2e\u5225\u3082\u53d6\u5f97\u53ef\u80fd\nfor series in chart_com.SeriesCollection():\n    series_type = series.ChartType\n</code></pre>"},{"location":"com-vs-ooxml-implementation/#ooxml_25","title":"OOXML \u306e\u5236\u9650","text":"<pre><code>&lt;c:plotArea&gt;\n  &lt;c:barChart&gt;...&lt;/c:barChart&gt;\n  &lt;c:lineChart&gt;...&lt;/c:lineChart&gt;  &lt;!-- \u8907\u6570\u306e\u30c1\u30e3\u30fc\u30c8\u8981\u7d20 --&gt;\n&lt;/c:plotArea&gt;\n</code></pre>"},{"location":"com-vs-ooxml-implementation/#_28","title":"\u5b9f\u88c5\u56f0\u96e3\u306a\u7406\u7531","text":"<ul> <li>OOXML \u3067\u306f\u8907\u6570\u306e\u30c1\u30e3\u30fc\u30c8\u8981\u7d20\u304c\u4e26\u5217\u306b\u5b58\u5728</li> <li>\u3069\u308c\u304c\u300c\u4e3b\u8981\u300d\u304b\u306e\u5224\u5b9a\u30ed\u30b8\u30c3\u30af\u304c\u4e0d\u660e\u78ba</li> <li>COM \u306f Excel \u306e\u5185\u90e8\u5224\u5b9a\u7d50\u679c\u3092\u8fd4\u3059\u304c\u3001\u305d\u306e\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\u306f\u975e\u516c\u958b</li> </ul>"},{"location":"com-vs-ooxml-implementation/#_29","title":"\u73fe\u5728\u306e\u52d5\u4f5c","text":"<ul> <li>OOXML: \u6700\u521d\u306b\u898b\u3064\u304b\u3063\u305f\u30c1\u30e3\u30fc\u30c8\u7a2e\u5225\u3092\u8fd4\u3059</li> <li>\u8907\u5408\u30c1\u30e3\u30fc\u30c8\u306e\u5834\u5408\u3001\u5b9f\u969b\u306e\u4e3b\u8981\u7a2e\u5225\u3068\u7570\u306a\u308b\u53ef\u80fd\u6027\u304c\u3042\u308b</li> </ul>"},{"location":"com-vs-ooxml-implementation/#_30","title":"\u5236\u9650\u4e8b\u9805\u3068\u6ce8\u610f\u70b9","text":""},{"location":"com-vs-ooxml-implementation/#ooxml_26","title":"OOXML \u5b9f\u88c5\u306e\u5236\u9650\uff08\u305d\u306e\u4ed6\uff09","text":"<ol> <li>\u5ea7\u6a19\u7cbe\u5ea6</li> <li>EMU \u2192 \u30d4\u30af\u30bb\u30eb\u5909\u63db\u3067\u82e5\u5e72\u306e\u8aa4\u5dee\u304c\u751f\u3058\u308b\u53ef\u80fd\u6027</li> <li> <p>COM \u306f Excel \u5185\u90e8\u306e\u6b63\u78ba\u306a\u5024\u3092\u53d6\u5f97</p> </li> <li> <p>\u56f3\u5f62\u7a2e\u5225\u30de\u30c3\u30d4\u30f3\u30b0</p> </li> <li>\u5168\u3066\u306e <code>MsoAutoShapeType</code> \u306b\u5bfe\u5fdc\u3059\u308b\u30de\u30c3\u30d4\u30f3\u30b0\u304c\u5fc5\u8981</li> <li> <p>\u672a\u77e5\u306e\u7a2e\u5225\u306f <code>AutoShape-{prst}</code> \u5f62\u5f0f\u3067\u51fa\u529b</p> </li> <li> <p>\u30c1\u30e3\u30fc\u30c8\u7a2e\u5225</p> </li> <li>\u8907\u5408\u30c1\u30e3\u30fc\u30c8\u306e\u5834\u5408\u3001\u6700\u521d\u306b\u898b\u3064\u304b\u3063\u305f\u7a2e\u5225\u3092\u8fd4\u3059</li> <li>COM \u306f\u4e3b\u8981\u306a\u30c1\u30e3\u30fc\u30c8\u7a2e\u5225\u3092\u8fd4\u3059</li> </ol>"},{"location":"com-vs-ooxml-implementation/#_31","title":"\u4f7f\u3044\u5206\u3051\u306e\u6307\u91dd","text":"\u74b0\u5883 \u63a8\u5968\u5b9f\u88c5 \u7406\u7531 Windows + Excel COM \u9ad8\u7cbe\u5ea6\u3001\u5168\u6a5f\u80fd\u5bfe\u5fdc Windows (Excel \u306a\u3057) OOXML Excel \u4e0d\u8981 Linux / macOS OOXML \u552f\u4e00\u306e\u9078\u629e\u80a2 CI/CD \u74b0\u5883 OOXML \u30d8\u30c3\u30c9\u30ec\u30b9\u5b9f\u884c\u53ef\u80fd"},{"location":"com-vs-ooxml-implementation/#_32","title":"\u30d5\u30a9\u30fc\u30eb\u30d0\u30c3\u30af\u52d5\u4f5c","text":"<p><code>integrate.py</code> \u3067\u306f\u81ea\u52d5\u7684\u306b\u30d5\u30a9\u30fc\u30eb\u30d0\u30c3\u30af\u304c\u884c\u308f\u308c\u307e\u3059\uff1a</p> <pre><code># COM \u304c\u5229\u7528\u53ef\u80fd\u306a\u5834\u5408\nif _is_com_available():\n    shapes = get_shapes_with_position(workbook, mode)\n    charts = get_charts(sheet, mode)\n# COM \u304c\u5229\u7528\u4e0d\u53ef\u306e\u5834\u5408\nelse:\n    shapes = get_shapes_ooxml(xlsx_path, mode)\n    charts = get_charts_ooxml(xlsx_path, mode)\n</code></pre>"},{"location":"com-vs-ooxml-implementation/#_33","title":"\u53c2\u8003\u8cc7\u6599","text":"<ul> <li>ECMA-376 Office Open XML File Formats</li> <li>DrawingML Reference</li> <li>xlwings Documentation</li> <li>MsoShapeType Enumeration</li> </ul>"},{"location":"concept/","title":"Concept / Why ExStruct?","text":""},{"location":"concept/#what-problem-does-exstruct-solve","title":"What problem does ExStruct solve?","text":"<p>Real-world Excel files contain much more than cell values:</p> <ul> <li>visually-crafted tables made with borders</li> <li>shapes, callouts, grouped objects</li> <li>charts with their series, axes, labels, and data ranges</li> <li>merged cells and layout structures</li> <li>spatial relationships that carry semantic meaning</li> </ul> <p>All of this is essential for understanding the actual information encoded in an Excel workbook. However, most Python libraries (openpyxl, pandas, etc.) can only access a small portion of this data.</p> <p>This leads to several common issues in automation, documentation processing, and RAG pipelines.</p>"},{"location":"concept/#the-invisible-structure-problem-of-excel","title":"The \u201cInvisible Structure\u201d Problem of Excel","text":""},{"location":"concept/#1-cells-alone-do-not-capture-the-real-meaning","title":"1. Cells alone do not capture the real meaning","text":"<p>Typical libraries can read cells, but not the richer objects that make Excel documents highly expressive.</p> Element Available in typical libraries? Available in ExStruct? Cell values \u25cb \u25cb Shapes (text, position, type) \u00d7 \u25ce Grouped shapes \u00d7 \u25ce Chart series / labels / axis ranges \u00d7\u301c\u25b3 \u25ce Heuristic table detection \u00d7 \u25ce <p>Most business documents rely on these structures to convey meaning. Without them, AI systems miss critical context.</p>"},{"location":"concept/#2-llms-and-rag-systems-struggle-with-excels-format-variability","title":"2. LLMs and RAG systems struggle with Excel\u2019s \u201cformat variability\u201d","text":"<p>Excel files often contain structural irregularities:</p> <ul> <li>tables made only with borders (not actual Table objects)</li> <li>inconsistent row/column spacing</li> <li>explanatory shapes placed near cells</li> <li>charts referencing off-sheet ranges</li> <li>camera-tool snapshots showing visualized cell values</li> </ul> <p>When given raw cell data or text-only extraction, LLMs lose the relational and contextual meaning.</p> <p>ExStruct exists to systematically expose these hidden relationships.</p>"},{"location":"concept/#3-without-excel-installed-high-fidelity-extraction-is-nearly-impossible","title":"3. Without Excel installed, high-fidelity extraction is nearly impossible","text":"<p>OpenXML parsing alone cannot reliably retrieve:</p> <ul> <li>shape positions or grouping</li> <li>chart metadata and axis structures</li> <li>camera-tool references</li> <li>layout-level semantics</li> </ul> <p>In practice, many enterprise environments do have Windows + Excel installed. ExStruct embraces this environment to provide maximum information extraction while still offering a fallback mode for non-Excel environments.</p>"},{"location":"concept/#exstruct-concept","title":"ExStruct Concept","text":"<p>\u201cConvert Excel workbooks into structured, machine-readable JSON that preserves their semantic meaning.\u201d</p> <p>ExStruct is designed specifically for extracting structural information for AI systems, automation pipelines, and document analysis.</p> <p>Key Features</p> <ol> <li>Full extraction of shapes, groups, arrows, callouts, and positions</li> <li>Chart metadata: series, values, labels, axis titles, ranges</li> <li>Automatic detection of \u201cvisual tables\u201d from borders and density</li> <li>Maximum fidelity when Excel is available; functional fallback when not</li> <li>Optimized output modes (light / standard / verbose) for RAG usage</li> <li>Multiple export formats: JSON, YAML, TOON</li> </ol>"},{"location":"concept/#why-exstruct","title":"Why ExStruct?","text":""},{"location":"concept/#excel-is-one-of-the-largest-semantic-black-boxes-in-enterprise-systems","title":"\u2714 Excel is one of the largest \u201csemantic black boxes\u201d in enterprise systems","text":"<ul> <li>Business-critical documents are frequently Excel-based:</li> <li>inspection checklists</li> <li>QC diagrams and cause\u2013effect charts</li> <li>SOP manuals</li> <li>analysis sheets</li> <li>reports with charts</li> <li>specification documents with annotations</li> </ul> <p>These files combine text + layout + shapes + charts, forming a rich structure that typical parsers cannot represent.</p> <p>For RAG and AI systems, this missing structure becomes a major bottleneck.</p>"},{"location":"concept/#what-exstruct-provides","title":"What ExStruct Provides","text":""},{"location":"concept/#1-a-structured-llm-friendly-json-representation","title":"1. A structured, LLM-friendly JSON representation","text":"<p>ExStruct outputs a unified structure containing:</p> <ul> <li>cells, rows, and sheets</li> <li>shapes, arrows, and SmartArt nodes (nested)</li> <li>chart series and metadata</li> <li>automatically detected table candidates</li> <li>layout geometry (positions, sizes)</li> </ul> <p>LLMs can reason over this representation far more effectively than raw text.</p>"},{"location":"concept/#2-a-programmatically-analyzable-view-of-excel-documents","title":"2. A programmatically analyzable view of Excel documents","text":"<p>By converting layout and object information to JSON, ExStruct unlocks new workflows:</p> <ul> <li>load tables into pandas</li> <li>reconstruct diagrams or charts outside Excel</li> <li>build searchable document repositories</li> <li>display Excel content in web UIs</li> <li>convert Excel documents to Markdown or other formats</li> </ul>"},{"location":"concept/#3-a-ready-to-use-foundation-for-rag-systems-and-document-automation","title":"3. A ready-to-use foundation for RAG systems and document automation","text":"<p>Once extracted, the workflow becomes:</p> <pre><code>Excel \u2192 ExStruct \u2192 JSON \u2192 Vector DB \u2192 RAG \u2192 Answer Generation\n</code></pre> <p>Previously, teams needed to build custom extraction logic for each document type. ExStruct provides a general solution that handles both standard Excel features and complex layouts.</p>"},{"location":"concept/#use-cases","title":"Use Cases","text":""},{"location":"concept/#rag-for-excel-manuals","title":"\u2714 RAG for Excel manuals","text":"<p>LLMs can reference both text and shape-based information (flows, diagrams, callouts).</p>"},{"location":"concept/#automated-extraction-of-inspectionoperation-checklists","title":"\u2714 Automated extraction of inspection/operation checklists","text":"<p>Visual tables become machine-readable through ExStruct\u2019s detection logic.</p>"},{"location":"concept/#structural-extraction-of-qc-diagrams-fishbone-charts","title":"\u2714 Structural extraction of QC diagrams / fishbone charts","text":"<p>Positions + text allow downstream tools or AI to reconstruct the logic.</p>"},{"location":"concept/#displaying-excel-files-in-web-applications","title":"\u2714 Displaying Excel files in web applications","text":"<p>JSON-based layout makes frontend rendering feasible without Excel.</p>"},{"location":"concept/#automated-reporting-and-analytics","title":"\u2714 Automated reporting and analytics","text":"<p>Chart series can be re-plotted or transformed into dashboards.</p>"},{"location":"concept/#summary","title":"Summary","text":"<p>ExStruct is built to:</p> <ul> <li>reveal the hidden structural elements in Excel files</li> <li>expose them through a consistent JSON representation</li> <li>enable AI and automation systems to understand Excel documents qualitatively</li> <li>support both maximum-fidelity (Excel-installed) and fallback (pure Python) extraction</li> <li>facilitate RAG pipelines, document analysis, and enterprise automation</li> </ul> <p>It is not just an Excel parser\u2014 it is a semantic extraction engine for the most commonly used business document format in the world.</p>"},{"location":"license-guide/","title":"\ud83d\udcc4 Corporate Usage License Guide: exstruct","text":"<p>_Version 0.2 / Last update: 2025-12-13</p>"},{"location":"license-guide/#toc","title":"TOC","text":"<ul> <li>\ud83d\udcc4 Corporate Usage License Guide: exstruct</li> <li>TOC</li> <li>Purpose of This Document</li> <li>License of exstruct</li> <li>What You ARE Allowed To Do DO<ul> <li>Use in commercial or internal software</li> <li>Modify the library</li> <li>Redistribute inside the company</li> <li>Embed into proprietary or closed-source systems</li> <li>In simple terms:</li> </ul> </li> <li>Required Compliance Points MUST<ul> <li>1 Preserve copyright notices</li> <li>2 Do not remove or alter the license text</li> <li>3 Do not use the author's name for endorsement</li> </ul> </li> <li>What You MUST NOT Do DON\u2019T<ul> <li>Use the author's name for advertising</li> <li>Distribute the library without the license</li> </ul> </li> <li>License Compatibility of Dependencies</li> <li>Redistribution Inside the Company</li> <li>Conclusion: exstruct Is Highly Suitable for Corporate Use</li> <li>Appendix: Full BSD-3-Clause License Text</li> <li>About This Document</li> </ul>"},{"location":"license-guide/#purpose-of-this-document","title":"Purpose of This Document","text":"<p>This document is intended to help corporate users\u2014including legal teams, IT departments, compliance officers, and internal developers\u2014understand the licensing implications of using exstruct within:</p> <ul> <li>Internal business systems</li> <li>Commercial products</li> <li>Proprietary applications</li> <li>Company-wide automation or RAG/AI pipelines</li> </ul> <p>It summarizes what is permitted, what is required, and what to be careful about when using exstruct in a corporate environment.</p>"},{"location":"license-guide/#1-license-of-exstruct","title":"1. License of exstruct","text":"<p>exstruct is released under the BSD-3-Clause License (Modified BSD License).</p> <p>The BSD-3-Clause license is a very permissive open-source license, allowing:</p> <ul> <li>commercial use</li> <li>modification</li> <li>redistribution</li> <li>integration into proprietary systems</li> <li>closed-source usage</li> </ul> <p>There are very few restrictions, making it one of the most corporate-friendly licenses available.</p>"},{"location":"license-guide/#2-what-you-are-allowed-to-do-do","title":"2. What You ARE Allowed To Do (DO)","text":"<p>Thanks to the permissive nature of BSD-3-Clause, the following actions are explicitly allowed.</p>"},{"location":"license-guide/#use-in-commercial-or-internal-software","title":"Use in commercial or internal software","text":"<p>You may freely integrate exstruct into internal tools, production systems, or customer-facing products.</p>"},{"location":"license-guide/#modify-the-library","title":"Modify the library","text":"<p>You may adapt or change the code for internal purposes without releasing your modifications.</p>"},{"location":"license-guide/#redistribute-inside-the-company","title":"Redistribute inside the company","text":"<p>Sharing the library with other teams, packaging it internally, or deploying it company-wide is allowed.</p>"},{"location":"license-guide/#embed-into-proprietary-or-closed-source-systems","title":"Embed into proprietary or closed-source systems","text":"<p>No obligation to open your own code.</p>"},{"location":"license-guide/#in-simple-terms","title":"In simple terms:","text":"<p>You have maximum freedom to use exstruct within your organization.</p>"},{"location":"license-guide/#3-required-compliance-points-must","title":"3. Required Compliance Points (MUST)","text":"<p>Although permissive, BSD-3-Clause includes three conditions you must follow.</p>"},{"location":"license-guide/#1-preserve-copyright-notices","title":"(1) Preserve copyright notices","text":"<p>Include the original <code>LICENSE</code> file when redistributing the library.</p>"},{"location":"license-guide/#2-do-not-remove-or-alter-the-license-text","title":"(2) Do not remove or alter the license text","text":"<p>The BSD license terms must remain intact in redistributed source or binary distributions.</p>"},{"location":"license-guide/#3-do-not-use-the-authors-name-for-endorsement","title":"(3) Do not use the author's name for endorsement","text":"<p>You may not claim that the author endorses your product unless you obtain explicit permission.</p>"},{"location":"license-guide/#4-what-you-must-not-do-dont","title":"4. What You MUST NOT Do (DON\u2019T)","text":"<p>BSD-3-Clause prohibits only a small number of actions.</p>"},{"location":"license-guide/#use-the-authors-name-for-advertising","title":"Use the author's name for advertising","text":"<p>Example of a prohibited statement:</p> <p>\u201cThis system is officially approved by harumiWeb!\u201d</p>"},{"location":"license-guide/#distribute-the-library-without-the-license","title":"Distribute the library without the license","text":"<p>The LICENSE file must remain included.</p>"},{"location":"license-guide/#5-license-compatibility-of-dependencies","title":"5. License Compatibility of Dependencies","text":"<p>All dependencies of exstruct use permissive licenses, fully compatible with BSD-3-Clause.</p> Dependency License Compatibility numpy BSD-3 \u25ce Fully compatible pandas BSD-3 \u25ce Fully compatible scipy BSD-3 \u25ce Fully compatible xlwings BSD-3 \u25ce Fully compatible openpyxl MIT \u25ce Fully compatible pydantic MIT \u25ce Fully compatible Pillow HPND / permissive \u25ce Fully compatible pypdfium2 Apache-2.0 \u25ce Compatible; no distribution obligations dev tools MIT / Apache \u25ce No issues <p>\u27a1 No GPL, LGPL, MPL, or other copyleft licenses are present.</p> <p>This means there is no risk of forced open-sourcing or contamination of proprietary software.</p>"},{"location":"license-guide/#6-redistribution-inside-the-company","title":"6. Redistribution Inside the Company","text":"<p>When redistributing exstruct (or modified versions) inside your organization:</p> Scenario Required Action Distributing exstruct unchanged Include <code>LICENSE</code> Distributing a modified version Include <code>LICENSE</code> (recommended: note modifications) Packaging into executables (PyInstaller, etc.) Include <code>LICENSE</code> somewhere in the distribution <p>Note: You do not need to include licenses of dependencies unless you redistribute their source code.</p>"},{"location":"license-guide/#7-conclusion-exstruct-is-highly-suitable-for-corporate-use","title":"7. Conclusion: exstruct Is Highly Suitable for Corporate Use","text":"<p>Based on the license structure:</p> <ul> <li>exstruct is safe for commercial use</li> <li>All dependencies are fully permissive</li> <li>There is zero copyleft risk</li> <li>Internal redistribution is allowed</li> <li>Integration into proprietary systems is allowed</li> </ul> <p>exstruct is a corporate-friendly open-source component with very low compliance risk.</p>"},{"location":"license-guide/#appendix-full-bsd-3-clause-license-text","title":"Appendix: Full BSD-3-Clause License Text","text":"<pre><code>BSD 3-Clause License\n\nCopyright (c) 2025, ExStruct Contributors\nAll rights reserved.\n\nRedistribution and use in source and binary forms, with or without\nmodification, are permitted provided that the following conditions are met:\n\n1. Redistributions of source code must retain the above copyright notice, this\n   list of conditions and the following disclaimer.\n\n2. Redistributions in binary form must reproduce the above copyright notice,\n   this list of conditions and the following disclaimer in the documentation\n   and/or other materials provided with the distribution.\n\n3. Neither the name of the copyright holder nor the names of its\n   contributors may be used to endorse or promote products derived from\n   this software without specific prior written permission.\n\nTHIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\"\nAND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE\nIMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE\nDISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE\nFOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL\nDAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\nSERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER\nCAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,\nOR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE\nOF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n</code></pre>"},{"location":"license-guide/#about-this-document","title":"About This Document","text":"<p>This guide is provided to assist legal, compliance, and IT governance teams in evaluating the use of exstruct within corporate environments.</p> <p>It is not a substitute for professional legal advice; consult your internal legal team if needed.</p>"},{"location":"mcp/","title":"MCP Server","text":"<p>This guide explains how to run ExStruct as an MCP (Model Context Protocol) server so AI agents can call it safely as a tool.</p>"},{"location":"mcp/#what-it-provides","title":"What it provides","text":"<ul> <li>Convert Excel into structured JSON (file output)</li> <li>Read large JSON outputs in chunks</li> <li>Pre-validate input files</li> </ul>"},{"location":"mcp/#installation","title":"Installation","text":"<pre><code>pip install exstruct[mcp]\n</code></pre>"},{"location":"mcp/#start-stdio","title":"Start (stdio)","text":"<pre><code>exstruct-mcp --root C:\\\\data --log-file C:\\\\logs\\\\exstruct-mcp.log --on-conflict rename\n</code></pre>"},{"location":"mcp/#key-options","title":"Key options","text":"<ul> <li><code>--root</code>: Allowed root directory (required)</li> <li><code>--deny-glob</code>: Deny glob patterns (repeatable)</li> <li><code>--log-level</code>: <code>DEBUG</code> / <code>INFO</code> / <code>WARNING</code> / <code>ERROR</code></li> <li><code>--log-file</code>: Log file path (stderr is still used by default)</li> <li><code>--on-conflict</code>: Output conflict policy (<code>overwrite</code> / <code>skip</code> / <code>rename</code>)</li> <li><code>--warmup</code>: Preload heavy imports to reduce first-call latency</li> </ul>"},{"location":"mcp/#tools","title":"Tools","text":"<ul> <li><code>exstruct_extract</code></li> <li><code>exstruct_read_json_chunk</code></li> <li><code>exstruct_validate_input</code></li> </ul>"},{"location":"mcp/#basic-flow","title":"Basic flow","text":"<ol> <li>Call <code>exstruct_extract</code> to generate the output JSON file</li> <li>Use <code>exstruct_read_json_chunk</code> to read only the parts you need</li> </ol>"},{"location":"mcp/#ai-agent-configuration-examples","title":"AI agent configuration examples","text":""},{"location":"mcp/#codex","title":"Codex","text":"<p><code>~/.codex/config.toml</code></p> <pre><code>[mcp_servers.exstruct]\ncommand = \"exstruct-mcp\"\nargs = [\"--root\", \"C:\\\\data\", \"--log-file\", \"C:\\\\logs\\\\exstruct-mcp.log\", \"--on-conflict\", \"rename\"]\n</code></pre>"},{"location":"mcp/#github-copilot-claude-desktop-gemini-cli","title":"GitHub Copilot / Claude Desktop / Gemini CLI","text":"<p>Register an MCP server with a command + args in your MCP settings:</p> <pre><code>{\n  \"mcpServers\": {\n    \"exstruct\": {\n      \"command\": \"exstruct-mcp\",\n      \"args\": [\"--root\", \"C:\\\\data\"]\n    }\n  }\n}\n</code></pre>"},{"location":"mcp/#operational-notes","title":"Operational notes","text":"<ul> <li>Logs go to stderr (and optionally <code>--log-file</code>) to avoid contaminating stdio responses.</li> <li>On Windows with Excel, standard/verbose can use COM for richer extraction.   On non-Windows, COM is unavailable and openpyxl-based fallbacks are used.</li> <li>For large outputs, use <code>read_json_chunk</code> to avoid hitting client limits.</li> </ul>"},{"location":"schemas/","title":"JSON Schemas for ExStruct Models","text":"<p>This page lists the JSON Schemas generated from the public Pydantic models. The schema files live at the repository root under <code>schemas/</code> (one file per model). They are not bundled into the MkDocs site build; clone or download the repository to access the raw files.</p>"},{"location":"schemas/#available-schemas","title":"Available Schemas","text":"<ul> <li><code>schemas/workbook.json</code> \u2014 <code>WorkbookData</code></li> <li><code>schemas/sheet.json</code> \u2014 <code>SheetData</code></li> <li><code>schemas/cell_row.json</code> \u2014 <code>CellRow</code></li> <li><code>schemas/shape.json</code> \u2014 <code>Shape</code></li> <li><code>schemas/arrow.json</code> <code>Arrow</code></li> <li><code>schemas/smartart.json</code> <code>SmartArt</code></li> <li><code>schemas/smartart_node.json</code> <code>SmartArtNode</code></li> <li><code>schemas/chart.json</code> \u2014 <code>Chart</code></li> <li><code>schemas/chart_series.json</code> \u2014 <code>ChartSeries</code></li> <li><code>schemas/print_area.json</code> \u2014 <code>PrintArea</code></li> <li><code>schemas/print_area_view.json</code> \u2014 <code>PrintAreaView</code></li> </ul>"},{"location":"schemas/#regeneration","title":"Regeneration","text":"<p>After modifying models, regenerate the schemas to keep them in sync:</p> <pre><code>python scripts/gen_json_schema.py\n</code></pre> <p>The generator produces deterministic output (sorted keys, draft 2020-12 <code>$schema</code>).</p>"},{"location":"agents/API_DESIGN/","title":"API Design \u2014 ExStruct","text":"<p>ExStruct \u306e\u30c8\u30c3\u30d7\u30ec\u30d9\u30eb Python API \u8a2d\u8a08\u3002</p>"},{"location":"agents/API_DESIGN/#api","title":"\u57fa\u672c API","text":"<pre><code>import exstruct as xs\n\ndata = xs.extract(\"file.xlsx\")\n</code></pre>"},{"location":"agents/API_DESIGN/#_1","title":"\u623b\u308a\u5024","text":"<p><code>WorkbookData</code>\uff08Pydantic model\uff09</p>"},{"location":"agents/API_DESIGN/#cli","title":"CLI","text":"<pre><code>exstruct file.xlsx --format json &gt; output.json\n</code></pre> <p>\u30aa\u30d7\u30b7\u30e7\u30f3\uff1a</p> <ul> <li><code>--image</code> \u2192 PNG \u51fa\u529b</li> <li><code>--pdf</code> \u2192 PDF \u51fa\u529b</li> <li><code>--dpi</code> \u2192 PNG \u89e3\u50cf\u5ea6</li> <li><code>--sheets-dir</code> \u2192 \u30b7\u30fc\u30c8\u3054\u3068\u306e\u5206\u5272\u51fa\u529b</li> <li><code>--multiple</code> \u2192 \u8907\u6570\u30d5\u30a1\u30a4\u30eb\u51e6\u7406</li> </ul>"},{"location":"agents/API_DESIGN/#jsonyamltoon","title":"JSON/YAML/TOON \u51fa\u529b","text":"<pre><code>data = xs.extract(\"file.xlsx\")\n\nxs.export(\"file.xlsx\")\ndata.to_json(pretty=True)\ndata.to_yaml()\ndata.to_toon()\ndata.save(\"file.json\")\ndata[\"Sheet1\"]          # WorkbookData.__getitem__\nfor name, sheet in data:  # WorkbookData.__iter__\n    print(name, len(sheet.rows))\n\n# ExStructEngine (per-instance options)\nfrom exstruct import ExStructEngine, FilterOptions, FormatOptions, OutputOptions, StructOptions\nengine = ExStructEngine(\n    options=StructOptions(mode=\"standard\"),\n    output=OutputOptions(\n        format=FormatOptions(pretty=True),\n        filters=FilterOptions(include_shapes=False),\n    ),\n)\nwb = engine.extract(\"file.xlsx\")\nengine.export(wb, \"filtered.json\")\n</code></pre>"},{"location":"agents/API_DESIGN/#_2","title":"\u4eca\u5f8c\u62e1\u5f35\u4e88\u5b9a","text":"<ul> <li><code>xs.detect_tables()</code></li> <li><code>xs.semantic_shapes()</code></li> <li><code>xs.smartart()</code></li> </ul>"},{"location":"agents/ARCHITECTURE/","title":"Architecture - ExStruct","text":"<p>ExStruct \u306f\u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u4e2d\u5fc3\u306e\u62bd\u51fa\u30a2\u30fc\u30ad\u30c6\u30af\u30c1\u30e3\u3067\u3001 openpyxl \u3068 Excel COM\uff08xlwings\uff09\u3092\u5f79\u5272\u5206\u62c5\u3055\u305b\u3066\u3044\u307e\u3059\u3002</p>"},{"location":"agents/ARCHITECTURE/#_1","title":"\u5168\u4f53\u69cb\u9020","text":"<pre><code>exstruct/\n  core/\n    pipeline.py\n    integrate.py\n    modeling.py\n    workbook.py\n    backends/\n      base.py\n      openpyxl_backend.py\n      com_backend.py\n    cells.py\n    shapes.py\n    charts.py\n    ranges.py\n    logging_utils.py\n  models/\n    __init__.py\n    maps.py\n  io/\n    serialize.py\n  render/\n  cli/\n    main.py\n</code></pre>"},{"location":"agents/ARCHITECTURE/#_2","title":"\u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u8a2d\u8a08","text":"<ul> <li><code>resolve_extraction_inputs</code> \u304c include_* \u3068 mode \u3092\u6b63\u898f\u5316</li> <li><code>PipelinePlan</code> \u306f pre-com / com \u306e\u9759\u7684\u30b9\u30c6\u30c3\u30d7\u69cb\u6210\u306e\u307f\u4fdd\u6301</li> <li>\u5b9f\u884c\u72b6\u614b\u306f <code>PipelineState</code> / <code>PipelineResult</code> \u306b\u5206\u96e2</li> <li><code>run_extraction_pipeline</code> \u304c COM \u53ef\u5426\u5224\u5b9a\u3068\u30d5\u30a9\u30fc\u30eb\u30d0\u30c3\u30af\u3092\u4e00\u5143\u7ba1\u7406</li> </ul>"},{"location":"agents/ARCHITECTURE/#_3","title":"\u30e2\u30b8\u30e5\u30fc\u30eb\u8cac\u52d9","text":""},{"location":"agents/ARCHITECTURE/#core","title":"core/","text":"<p>\u62bd\u51fa\u306e\u4e2d\u5fc3\u5c64\uff08\u5916\u90e8\u4f9d\u5b58\u3092\u96c6\u7d04\uff09</p> <ul> <li><code>pipeline.py</code> \u2192 \u62bd\u51fa\u30d5\u30ed\u30fc\u3001COM \u5224\u5b9a\u3001fallback\u3001raw \u751f\u6210</li> <li><code>backends/*</code> \u2192 openpyxl/COM \u306e\u62bd\u8c61\u5316</li> <li><code>cells.py</code> \u2192 \u30bb\u30eb\u62bd\u51fa\u3001\u30c6\u30fc\u30d6\u30eb\u691c\u51fa\u3001colors_map</li> <li><code>shapes.py</code> \u2192 \u56f3\u5f62\u62bd\u51fa\u3001\u65b9\u5411\u63a8\u5b9a</li> <li><code>charts.py</code> \u2192 \u30c1\u30e3\u30fc\u30c8\u89e3\u6790</li> <li><code>ranges.py</code> \u2192 \u7bc4\u56f2\u89e3\u6790\u306e\u5171\u901a\u95a2\u6570</li> <li><code>workbook.py</code> \u2192 openpyxl/xlwings \u306e contextmanager</li> <li><code>modeling.py</code> \u2192 RawData \u304b\u3089 WorkbookData/SheetData \u3092\u751f\u6210</li> <li><code>integrate.py</code> \u2192 pipeline \u547c\u3073\u51fa\u3057\u306b\u7279\u5316\u3057\u305f\u8584\u3044\u5165\u53e3</li> </ul>"},{"location":"agents/ARCHITECTURE/#models","title":"models/","text":"<p>Pydantic \u306b\u3088\u308b\u516c\u958b\u30c7\u30fc\u30bf\u69cb\u9020 \uff08\u5916\u90e8 API \u306f BaseModel \u3092\u8fd4\u3059\uff09</p>"},{"location":"agents/ARCHITECTURE/#io","title":"io/","text":"<p>\u51fa\u529b\u30d5\u30a9\u30fc\u30de\u30c3\u30c8\uff08JSON / YAML / TOON\uff09\u3068\u30d5\u30a1\u30a4\u30eb\u66f8\u304d\u8fbc\u307f</p>"},{"location":"agents/ARCHITECTURE/#render","title":"render/","text":"<p>PDF/PNG \u51fa\u529b\uff08RAG \u7528\u9014\uff09</p>"},{"location":"agents/ARCHITECTURE/#cli","title":"cli/","text":"<p>CLI \u30a8\u30f3\u30c8\u30ea\u30dd\u30a4\u30f3\u30c8</p>"},{"location":"agents/ARCHITECTURE/#ai","title":"AI \u30a8\u30fc\u30b8\u30a7\u30f3\u30c8\u5411\u3051\u30ac\u30a4\u30c9","text":"<ul> <li>\u30e2\u30c7\u30eb\u5909\u66f4\u306f core \u306e RawData \u5909\u63db\u306b\u3082\u53cd\u6620\u3059\u308b</li> <li>\u5916\u90e8\u4f9d\u5b58\uff08openpyxl/xlwings\uff09\u306f core \u306e\u5883\u754c\u3067\u5b8c\u7d50\u3055\u305b\u308b</li> <li><code>PipelinePlan</code> \u306f\u4e0d\u5909\u3001\u5b9f\u884c\u72b6\u614b\u306f <code>PipelineState</code> \u3078\u5206\u96e2</li> <li>\u4ed5\u69d8\u306f docs/DATA_MODEL.md \u3092\u6700\u512a\u5148\u3068\u3059\u308b</li> </ul>"},{"location":"agents/CODING_GUIDELINES/","title":"ExStruct Coding Guidelines","text":"<p>AI\uff08Codex\uff09\u3068\u4eba\u9593\u304c\u5354\u8abf\u3057\u3066\u9577\u671f\u7684\u306b\u4fdd\u5b88\u3067\u304d\u308b\u30b3\u30fc\u30c9\u30d9\u30fc\u30b9 \u3092\u5b9f\u73fe\u3059\u308b\u305f\u3081\u306e\u3001 ExStruct \u72ec\u81ea\u306e\u30b3\u30fc\u30c7\u30a3\u30f3\u30b0\u898f\u7d04\u3067\u3059\u3002</p> <p>\u4ee5\u4e0b\u306e\u898f\u7d04\u306f\u3001Codex \u306b\u30b3\u30fc\u30c9\u3092\u751f\u6210\u3055\u305b\u308b\u5834\u5408\u306b\u3082\u9069\u7528\u3057\u307e\u3059\u3002 AI \u751f\u6210\u30b3\u30fc\u30c9\u306e\u54c1\u8cea\u5b89\u5b9a\u5316\u30fb\u4fdd\u5b88\u6027\u5411\u4e0a\u30fbRuff / mypy / Pydantic \u3068\u306e\u6574\u5408\u6027\u3092\u76ee\u7684\u3068\u3057\u307e\u3059\u3002</p>"},{"location":"agents/CODING_GUIDELINES/#1","title":"1. \u57fa\u672c\u65b9\u91dd\uff08\u6700\u91cd\u8981\uff09","text":""},{"location":"agents/CODING_GUIDELINES/#11","title":"1.1 \u578b\u30d2\u30f3\u30c8\u306f\u5fc5\u9808","text":"<p>\u3059\u3079\u3066\u306e\u95a2\u6570\u30fb\u30e1\u30bd\u30c3\u30c9\u30fb\u30af\u30e9\u30b9\u306b\u5b8c\u5168\u306a\u578b\u30d2\u30f3\u30c8\u3092\u4ed8\u3051\u308b\u3053\u3068\u3002</p> <p>\u826f\u3044\u4f8b</p> <pre><code>def extract_shapes(sheet: xw.Sheet) -&gt; list[Shape]:\n    ...\n</code></pre> <p>\u60aa\u3044\u4f8b</p> <pre><code>def extract_shapes(sheet):\n    ...\n</code></pre>"},{"location":"agents/CODING_GUIDELINES/#12-1","title":"1.2 \u95a2\u6570\u306f\u300c1 \u8cac\u52d9\u300d\u3060\u3051\u3092\u6301\u3064","text":"<p>\u8907\u96d1\u306a Excel \u51e6\u7406\u306f\u95a2\u6570\u304c\u80a5\u5927\u5316\u3057\u3084\u3059\u3044\u305f\u3081\u3001 1 \u95a2\u6570 = 1 \u30ed\u30b8\u30c3\u30af \u3092\u5fb9\u5e95\u3059\u308b\u3002</p> <p>\u826f\u3044\u4f8b</p> <ul> <li><code>extract_raw_shapes</code></li> <li><code>normalize_shape</code></li> <li><code>detect_shape_direction</code></li> </ul>"},{"location":"agents/CODING_GUIDELINES/#13-basemodel-dataclass","title":"1.3 \u5883\u754c\u306f BaseModel\u3001\u5185\u90e8\u306f dataclass \u3092\u4e3b\u306a\u30c7\u30fc\u30bf\u69cb\u9020\u306b\u3059\u308b","text":"<p>Raw*Data (e.g., SheetRawData/WorkbookRawData) \u306f\u5185\u90e8\u5c02\u7528\u3067\u516c\u958bAPI\u306b\u51fa\u3055\u306a\u3044\u3002 Do not expose them via public APIs or re-export from package init.</p> <p>\u8f9e\u66f8\u3084\u30bf\u30d7\u30eb\u3067\u306f\u306a\u304f\u3001\u5fc5\u305a Pydantic BaseModel \u304b dataclass \u3092\u8fd4\u3059\u3002</p> <p>\u30e1\u30ea\u30c3\u30c8\uff1a</p> <ul> <li>AI \u304c\u8aa4\u89e3\u3057\u306b\u304f\u3044</li> <li>IDE \u3067\u306e\u958b\u767a\u304c\u5bb9\u6613</li> <li>JSON \u5316\u3068\u306e\u76f8\u6027\u304c\u3088\u3044</li> </ul>"},{"location":"agents/CODING_GUIDELINES/#2","title":"2. \u547d\u540d\u898f\u5247","text":""},{"location":"agents/CODING_GUIDELINES/#21-snake_case","title":"2.1 snake_case\uff08\u95a2\u6570\u30fb\u5909\u6570\uff09","text":"<p>\u4f8b\uff1a<code>parse_chart_labels</code>, <code>shape_items</code></p>"},{"location":"agents/CODING_GUIDELINES/#22-pascalcase","title":"2.2 PascalCase\uff08\u30af\u30e9\u30b9\uff09","text":"<p>\u4f8b\uff1a<code>WorkbookParser</code>, <code>ChartSeries</code></p>"},{"location":"agents/CODING_GUIDELINES/#23","title":"2.3 \u30e2\u30b8\u30e5\u30fc\u30eb\u540d\u306f\u77ed\u304f\u8cac\u52d9\u3092\u793a\u3059","text":"<p>\u4f8b\uff1a<code>shape_parser.py</code>, <code>chart_reader.py</code></p>"},{"location":"agents/CODING_GUIDELINES/#3","title":"3. \u30a4\u30f3\u30dd\u30fc\u30c8\u898f\u5247","text":"<p>Ruff \u306e isort \u30eb\u30fc\u30eb\u306b\u5f93\u3046\u3002</p> <p>\u9806\u5e8f\uff1a</p> <ol> <li>\u6a19\u6e96\u30e9\u30a4\u30d6\u30e9\u30ea</li> <li>\u30b5\u30fc\u30c9\u30d1\u30fc\u30c6\u30a3</li> <li>\u81ea\u524d\u30e9\u30a4\u30d6\u30e9\u30ea\uff08exstruct\uff09</li> </ol> <p>\u4f8b</p> <pre><code>import json\nfrom typing import Any\n\nimport xlwings as xw\nfrom pydantic import BaseModel\n\nfrom exstruct.models import Shape\n</code></pre>"},{"location":"agents/CODING_GUIDELINES/#4-docstring","title":"4. Docstring \u898f\u7d04","text":"<p>Google \u30b9\u30bf\u30a4\u30eb\u3092\u63a1\u7528\u3057\u3001\u4e0b\u8a18\u3092\u5fc5\u305a\u660e\u8a18\uff1a</p> <ul> <li>Args</li> <li>Returns</li> <li>Raises\uff08\u4f8b\u5916\u3092\u6295\u3052\u308b\u5834\u5408\uff09</li> </ul> <p>\u4f8b</p> <pre><code>def detect_shape_direction(shape: Shape) -&gt; str | None:\n    \"\"\"Detect arrow direction from shape coordinates and rotation.\n\n    Args:\n        shape: Parsed shape model.\n\n    Returns:\n        Direction code (\"E\", \"NE\", etc.) or None if no arrow is detected.\n    \"\"\"\n</code></pre>"},{"location":"agents/CODING_GUIDELINES/#5","title":"5. \u4f8b\u5916\u51e6\u7406\u306e\u30eb\u30fc\u30eb","text":""},{"location":"agents/CODING_GUIDELINES/#51-valueerror-runtimeerror","title":"5.1 ValueError / RuntimeError \u3092\u4e2d\u5fc3\u306b\u4f7f\u7528","text":"<pre><code>if not cell:\n    raise ValueError(\"cell must not be empty.\")\n</code></pre>"},{"location":"agents/CODING_GUIDELINES/#52-com","title":"5.2 COM \u4f8b\u5916\u306f\u30e9\u30c3\u30d7\u3059\u308b","text":"<pre><code>try:\n    text = shape.text_frame.characters.text\nexcept Exception as e:\n    raise RuntimeError(f\"Failed to read shape text: {e}\") from e\n</code></pre>"},{"location":"agents/CODING_GUIDELINES/#6","title":"6. \u8907\u96d1\u5ea6\u306e\u30b3\u30f3\u30c8\u30ed\u30fc\u30eb","text":"<p>Ruff \u306e <code>C90</code>\uff08mccabe\uff09\u306b\u5f93\u3044\u3001 max-complexity = 12 \u3092\u8d85\u3048\u306a\u3044\u3088\u3046\u306b\u95a2\u6570\u3092\u5206\u5272\u3059\u308b\u3002</p>"},{"location":"agents/CODING_GUIDELINES/#7-codexai","title":"7. Codex\uff08AI\uff09\u3092\u4f7f\u3046\u3068\u304d\u306e\u30ac\u30a4\u30c9\u30e9\u30a4\u30f3","text":""},{"location":"agents/CODING_GUIDELINES/#71-codex","title":"7.1 Codex \u306b\u5b88\u3089\u305b\u308b\u30eb\u30fc\u30eb","text":"<p>Codex \u3092\u5229\u7528\u3059\u308b\u5834\u5408\u3001\u4ee5\u4e0b\u3092\u4e8b\u524d\u306b\u30d7\u30ed\u30f3\u30d7\u30c8\u306b\u8a18\u8f09\u3059\u308b\uff1a</p> <ul> <li>\u578b\u30d2\u30f3\u30c8\u306f\u5fc5\u9808</li> <li>1 \u95a2\u6570 = 1 \u8cac\u52d9</li> <li>\u5883\u754c\u306f BaseModel\u3001\u5185\u90e8\u306f dataclass \u30e2\u30c7\u30eb\u3092\u8fd4\u3059</li> <li>Docstring \u3092 Google \u30b9\u30bf\u30a4\u30eb\u3067\u66f8\u304f</li> <li>import \u306f\u6b63\u3057\u3044\u9806\u5e8f\u3067\u66f8\u304f</li> <li>\u30a8\u30e9\u30fc\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0\u306f\u7c21\u6f54\u306b</li> <li>\u8907\u96d1\u5ea6\u304c\u9ad8\u304f\u306a\u308b\u5834\u5408\u306f\u95a2\u6570\u3092\u5206\u5272\u3059\u308b</li> </ul>"},{"location":"agents/CODING_GUIDELINES/#72-codex","title":"7.2 Codex \u306b\u30a2\u30a6\u30c8\u30d7\u30c3\u30c8\u3055\u305b\u308b\u305f\u3081\u306e\u63a8\u5968\u30d7\u30ed\u30f3\u30d7\u30c8","text":"<p>\u4ee5\u4e0b\u3092\u8cbc\u308b\u3060\u3051\u3067\u5b89\u5b9a\u3057\u305f\u30b3\u30fc\u30c9\u3092\u751f\u6210\u3067\u304d\u308b\uff1a</p> <pre><code>\u3042\u306a\u305f\u306f\u719f\u7df4 Python \u30a8\u30f3\u30b8\u30cb\u30a2\u3067\u3042\u308a\u3001ExStruct \u30e9\u30a4\u30d6\u30e9\u30ea\u306e\u6a19\u6e96\u306b\u5f93\u3063\u3066\u30b3\u30fc\u30c9\u3092\u66f8\u304d\u307e\u3059\u3002\n\n\u5fc5\u305a\u4ee5\u4e0b\u3092\u5b88\u3063\u3066\u304f\u3060\u3055\u3044\uff1a\n- \u578b\u30d2\u30f3\u30c8\u306f\u5168\u3066\u306e\u5f15\u6570\u3068\u623b\u308a\u5024\u306b\u4ed8\u3051\u308b\n- \uff11\u95a2\u6570 = \uff11\u8cac\u52d9\n- \u5883\u754c\u306f BaseModel\u3001\u5185\u90e8\u306f dataclass \u3092\u8fd4\u3059\n- import \u3092\u6b63\u3057\u3044\u9806\u5e8f\u3067\u4e26\u3079\u308b\n- docstring\uff08Google \u30b9\u30bf\u30a4\u30eb\uff09\u3092\u66f8\u304f\n- \u8907\u96d1\u306b\u306a\u308a\u3059\u304e\u306a\u3044\u3088\u3046\u95a2\u6570\u3092\u5206\u5272\u3059\u308b\n- JSON \u3084\u8f9e\u66f8\u3067\u306f\u306a\u304f Pydantic \u30e2\u30c7\u30eb\u3092\u8fd4\u3059\n\n\u51fa\u529b\u306f Python \u306e\u30b3\u30fc\u30c9\u306e\u307f\u3002\n</code></pre>"},{"location":"agents/CODING_GUIDELINES/#8-ai","title":"8. AI \u751f\u6210\u30b3\u30fc\u30c9\u306e\u30ec\u30d3\u30e5\u30fc\u9805\u76ee\uff08\u30c1\u30a7\u30c3\u30af\u30ea\u30b9\u30c8\uff09","text":"<p>AI \u304c\u751f\u6210\u3057\u305f\u30b3\u30fc\u30c9\u3092\u30ec\u30d3\u30e5\u30fc\u3059\u308b\u969b\u306f\u3001\u4ee5\u4e0b\u306e\u9806\u306b\u78ba\u8a8d\u3059\u308b\uff1a</p> <ol> <li>\u578b\u30d2\u30f3\u30c8\u304c\u5b8c\u5168\u304b</li> <li>docstring \u304c\u3042\u308b\u304b</li> <li>import \u306e\u9806\u5e8f\u304c\u6b63\u3057\u3044\u304b</li> <li>\u5883\u754c\u306f BaseModel\u3001\u5185\u90e8\u306f dataclass \u30e2\u30c7\u30eb\u3092\u8fd4\u3057\u3066\u3044\u308b\u304b</li> <li>\u95a2\u6570\u304c\u5358\u4e00\u8cac\u52d9\u304b</li> <li>\u4f8b\u5916\u51e6\u7406\u304c\u9069\u5207\u304b</li> <li>\u8907\u96d1\u5ea6\u304c max 12 \u3092\u8d85\u3048\u3066\u3044\u306a\u3044\u304b</li> <li>Ruff \u3067\u30a8\u30e9\u30fc\u304c\u51fa\u306a\u3044\u304b</li> </ol>"},{"location":"agents/CODING_GUIDELINES/#9-ai","title":"9. \u7981\u6b62\u4e8b\u9805\uff08AI \u751f\u6210\u30b3\u30fc\u30c9\u3067\u7279\u306b\u6ce8\u610f\uff09","text":"<p>\u4ee5\u4e0b\u306f Codex \u306b\u7d76\u5bfe\u3055\u305b\u306a\u3044\uff1a</p> <ul> <li>\u8907\u96d1\u3059\u304e\u308b if/else \u30cd\u30b9\u30c8</li> <li>\u591a\u6570\u306e\u8cac\u52d9\u3092\u6301\u3064\u300c\u795e\u30af\u30e9\u30b9\u300d</li> <li>\u5927\u304d\u306a\u8f9e\u66f8\u3084\u30bf\u30d7\u30eb\u3092\u8fd4\u3059</li> <li>\u30b3\u30e1\u30f3\u30c8\u304c\u4e00\u5207\u306a\u3044\u30b3\u30fc\u30c9</li> <li>\u7121\u540d\u306e\u30de\u30b8\u30c3\u30af\u30ca\u30f3\u30d0\u30fc</li> </ul>"},{"location":"agents/CODING_GUIDELINES/#10-exstruct","title":"10. ExStruct \u306e\u8a2d\u8a08\u539f\u5247\u307e\u3068\u3081","text":"<ul> <li>\u578b\u5b89\u5168\u6027\uff08type safety\uff09</li> <li>\u30c7\u30fc\u30bf\u69cb\u9020\u306e\u660e\u78ba\u5316\uff08\u5883\u754c\u306f BaseModel\u3001\u5185\u90e8\u306f dataclass\uff09</li> <li>\u30e2\u30b8\u30e5\u30fc\u30eb\u306e\u758e\u7d50\u5408\u5316</li> <li>\u95a2\u6570\u8cac\u52d9\u306e\u6700\u5c0f\u5316</li> <li>AI \u3068\u4eba\u9593\u306e\u5171\u5b58\u3092\u524d\u63d0\u306b\u3057\u305f\u30b3\u30fc\u30c9\u898f\u5f8b</li> </ul> <p>\u3053\u308c\u3089\u306f Ruff / mypy / CI \u3068\u3082\u9ad8\u3044\u4e92\u63db\u6027\u3092\u6301\u3064\u3088\u3046\u8a2d\u8a08\u3055\u308c\u3066\u3044\u308b\u3002</p>"},{"location":"agents/CODING_GUIDELINES/#appendix","title":"Appendix: \u4eca\u5f8c\u8ffd\u52a0\u304c\u63a8\u5968\u3055\u308c\u308b\u30eb\u30fc\u30eb","text":"<ul> <li>mypy \u306e\u53b3\u683c\u5316</li> <li>pydantic \u306e\u30d5\u30a3\u30fc\u30eb\u30c9\u5236\u7d04\u7d71\u4e00</li> <li>public API \u306e docstring \u5f37\u5236</li> <li>internal API \u306e _prefix \u547d\u540d</li> </ul>"},{"location":"agents/CONTRIBUTING_FOR_AI/","title":"CONTRIBUTING FOR AI AGENTS","text":"<p>\u3053\u306e\u30d5\u30a1\u30a4\u30eb\u306f AI \u30b3\u30fc\u30c7\u30a3\u30f3\u30b0\u30a8\u30fc\u30b8\u30a7\u30f3\u30c8\uff08ChatGPT, Cursor, Copilot \u7b49\uff09\u5411\u3051\u306e \u7279\u5225\u306a\u30ac\u30a4\u30c9\u30e9\u30a4\u30f3\u3067\u3059\u3002</p>"},{"location":"agents/CONTRIBUTING_FOR_AI/#_1","title":"\u539f\u5247","text":"<ol> <li>docs/*.md \u3092\u4ed5\u69d8\u306e\u552f\u4e00\u306e\u30bd\u30fc\u30b9\u3068\u3059\u308b</li> <li>\u30e2\u30c7\u30eb\u5b9a\u7fa9\uff08DATA_MODEL.md\uff09\u3068\u77db\u76fe\u3059\u308b\u30b3\u30fc\u30c9\u306f\u7981\u6b62</li> <li>core \u5c64\u306f\u300c\u62bd\u51fa\u306e\u307f\u300d\u3002\u63a8\u8ad6\u30ed\u30b8\u30c3\u30af\u306f integrate \u306b\u96c6\u7d04</li> <li>models \u5c64\u306f\u7d76\u5bfe\u306b\u300c\u526f\u4f5c\u7528\u306a\u3057\u300d</li> <li>I/O \u51e6\u7406\u3068\u30b3\u30a2\u30ed\u30b8\u30c3\u30af\u3092\u6df7\u5728\u3055\u305b\u306a\u3044</li> <li>\u4f8b\u5916\u51e6\u7406\u306f fail-safe \u3092\u5fb9\u5e95\u3059\u308b</li> <li>\u65b0\u6a5f\u80fd\u3092\u8ffd\u52a0\u3059\u308b\u3068\u304d\u306f\u30ed\u30fc\u30c9\u30de\u30c3\u30d7\u3092\u66f4\u65b0\u3059\u308b\u3053\u3068</li> </ol>"},{"location":"agents/CONTRIBUTING_FOR_AI/#ai","title":"AI \u5411\u3051\u30bf\u30b9\u30af\u30bb\u30d1\u30ec\u30fc\u30b7\u30e7\u30f3","text":"<ul> <li>\u65b0\u3057\u3044\u62bd\u51fa\u6a5f\u80fd, \u610f\u5473\u89e3\u6790\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0 \u2192 core/</li> <li>\u65b0\u3057\u3044\u30c7\u30fc\u30bf\u69cb\u9020 \u2192 models/</li> <li>\u51fa\u529b\u5f62\u5f0f\u8ffd\u52a0 \u2192 io/</li> <li>CLI \u6a5f\u80fd \u2192 cli/</li> </ul>"},{"location":"agents/CONTRIBUTING_FOR_AI/#_2","title":"\u30b3\u30fc\u30c7\u30a3\u30f3\u30b0\u30ac\u30a4\u30c9\u30e9\u30a4\u30f3","text":"<p>\u5fc5\u305a\u4ee5\u4e0b\u3092\u5b88\u3063\u3066\u304f\u3060\u3055\u3044\uff1a</p> <ul> <li>\u578b\u30d2\u30f3\u30c8\u306f\u5168\u3066\u306e\u5f15\u6570\u3068\u623b\u308a\u5024\u306b\u4ed8\u3051\u308b</li> <li>\uff11\u95a2\u6570 = \uff11\u8cac\u52d9</li> <li>\u5883\u754c\u306f BaseModel\u3001\u5185\u90e8\u306f dataclass \u3092\u8fd4\u3059</li> <li>import \u3092\u6b63\u3057\u3044\u9806\u5e8f\u3067\u4e26\u3079\u308b</li> <li>docstring\uff08Google \u30b9\u30bf\u30a4\u30eb\uff09\u3092\u66f8\u304f</li> <li>\u8907\u96d1\u306b\u306a\u308a\u3059\u304e\u306a\u3044\u3088\u3046\u95a2\u6570\u3092\u5206\u5272\u3059\u308b</li> <li>JSON \u3084\u8f9e\u66f8\u3067\u306f\u306a\u304f Pydantic \u30e2\u30c7\u30eb\u3092\u8fd4\u3059</li> </ul>"},{"location":"agents/CONTRIBUTING_FOR_AI/#_3","title":"\u30c6\u30b9\u30c8\u65b9\u91dd","text":"<ul> <li>\u30c6\u30b9\u30c6\u30a3\u30f3\u30b0\u30d5\u30ec\u30fc\u30e0\u30ef\u30fc\u30af\u306f<code>pytest</code>, <code>pytest-mock</code>\u3092\u4f7f\u7528</li> <li>Excel \u30d5\u30a1\u30a4\u30eb\u306e\u30b5\u30f3\u30d7\u30eb\u306f <code>/tests/data/*.xlsx</code> \u306b\u7f6e\u304f</li> <li>\u56de\u5e30\u30c6\u30b9\u30c8\u3068\u3057\u3066 Pydantic/dataclass \u30e2\u30c7\u30eb\u4e00\u81f4\u3092\u512a\u5148\u3059\u308b</li> <li>\u9759\u7684\u89e3\u6790\u306b\u306fruff, mypy\u3092\u4f7f\u7528\u3059\u308b\u3002\u3057\u305f\u304c\u3063\u3066\u3001\u3053\u308c\u3089\u306elint\u306b\u901a\u308b\u5b9f\u88c5\u3092\u3059\u308b\u3002</li> </ul>"},{"location":"agents/DATA_MODEL/","title":"ExStruct \u30c7\u30fc\u30bf\u30e2\u30c7\u30eb\u4ed5\u69d8","text":"<p>Version: 0.16 Status: Authoritative</p> <p>\u672c\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u306f ExStruct \u304c\u8fd4\u3059\u5168\u30e2\u30c7\u30eb\u306e\u552f\u4e00\u306e\u6b63\u6e96\u30bd\u30fc\u30b9\u3067\u3059\u3002 core / io / integrate \u306f\u3053\u306e\u4ed5\u69d8\u306b\u5f93\u3046\u3053\u3068\u3002\u30e2\u30c7\u30eb\u306f pydantic v2 \u3067\u5b9f\u88c5\u3057\u307e\u3059\u3002</p>"},{"location":"agents/DATA_MODEL/#1-overview","title":"1. Overview","text":"<p>ExStruct \u306f Excel \u30ef\u30fc\u30af\u30d6\u30c3\u30af\u3092 LLM \u304c\u6271\u3044\u3084\u3059\u3044 \u610f\u5473\u69cb\u9020 \u3068\u3057\u3066 JSON \u5316\u3057\u307e\u3059\u3002 \u7279\u8a18\u304c\u306a\u3044\u9650\u308a\u3001\u4ee5\u4e0b\u306e\u30e2\u30c7\u30eb\u306f\u3059\u3079\u3066 Pydantic \u306e <code>BaseModel</code> \u3067\u3059\u3002</p>"},{"location":"agents/DATA_MODEL/#2-shape-arrow-smartart-model","title":"2. Shape / Arrow / SmartArt Model","text":"<p>\u51fa\u529b\u306e <code>shapes</code> \u306f\u4e0b\u8a18 3 \u30e2\u30c7\u30eb\u306e\u30e6\u30cb\u30aa\u30f3\u3067\u3059\u3002<code>kind</code> \u3067\u5224\u5225\u3057\u307e\u3059\u3002</p> <pre><code>BaseShape {\n  id: int | null   // sheet \u9023\u756a id\uff08\u77e2\u5370\u306f null \u306e\u5834\u5408\u3042\u308a\uff09\n  text: str\n  l: int           // left (px)\n  t: int           // top  (px)\n  w: int | null    // width (px)\n  h: int | null    // height (px)\n  rotation: float | null\n}\n\nShape extends BaseShape {\n  kind: \"shape\"\n  type: str | null // MSO \u56f3\u5f62\u30bf\u30a4\u30d7\u30e9\u30d9\u30eb\n}\n\nArrow extends BaseShape {\n  kind: \"arrow\"\n  begin_arrow_style: int | null\n  end_arrow_style: int | null\n  begin_id: int | null // \u30b3\u30cd\u30af\u30bf\u59cb\u70b9\u306e\u63a5\u7d9a Shape.id\n  end_id: int | null   // \u30b3\u30cd\u30af\u30bf\u7d42\u70b9\u306e\u63a5\u7d9a Shape.id\n  direction: \"E\"|\"SE\"|\"S\"|\"SW\"|\"W\"|\"NW\"|\"N\"|\"NE\" | null\n}\n\nSmartArtNode {\n  text: str\n  kids: [SmartArtNode]\n}\n\nSmartArt extends BaseShape {\n  kind: \"smartart\"\n  layout: str\n  nodes: [SmartArtNode]\n}\n</code></pre> <p>\u88dc\u8db3:</p> <ul> <li><code>direction</code> \u306f\u7dda\u3084\u77e2\u5370\u306e\u5411\u304d\u3092 8 \u65b9\u4f4d\u306b\u6b63\u898f\u5316</li> <li>\u77e2\u5370\u30b9\u30bf\u30a4\u30eb\u306f Excel \u306e enum \u306b\u5bfe\u5fdc</li> <li><code>begin_id</code> / <code>end_id</code> \u306f\u30b3\u30cd\u30af\u30bf\u304c\u63a5\u7d9a\u3057\u3066\u3044\u308b\u56f3\u5f62\u306e <code>id</code></li> <li><code>SmartArtNode</code> \u306f\u30cd\u30b9\u30c8\u69cb\u9020\u3067\u8868\u73fe\u3057\u3001<code>nodes</code> \u304c\u30c4\u30ea\u30fc\u306e\u6839</li> </ul>"},{"location":"agents/DATA_MODEL/#3-cellrow-model","title":"3. CellRow Model","text":"<pre><code>CellRow {\n  r: int                                  // \u884c\u756a\u53f7 (1-based)\n  c: { [colIndex: str]: str | int | float } // \u975e\u7a7a\u30bb\u30eb\u306e\u307f\u3001\u30ad\u30fc\u306f\u5217\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u6587\u5b57\u5217\n  links: { [colIndex: str]: url } | null    // \u30cf\u30a4\u30d1\u30fc\u30ea\u30f3\u30af\u6709\u52b9\u5316\u6642\u306e\u307f\n}\n</code></pre>"},{"location":"agents/DATA_MODEL/#4-chartseries-model","title":"4. ChartSeries Model","text":"<pre><code>ChartSeries {\n  name: str\n  name_range: str | null\n  x_range: str | null\n  y_range: str | null\n}\n</code></pre> <p>\u30b7\u30ea\u30fc\u30ba\u306f\u5024\u3067\u306f\u306a\u304f\u53c2\u7167\u3092\u4fdd\u6301\u3057\u3001\u30da\u30a4\u30ed\u30fc\u30c9\u3092\u524a\u6e1b\u3057\u307e\u3059\u3002</p>"},{"location":"agents/DATA_MODEL/#5-chart-model","title":"5. Chart Model","text":"<pre><code>Chart {\n  name: str\n  chart_type: str              // XL_CHART_TYPE_MAP \u306e\u30e9\u30d9\u30eb\n  title: str | null\n  y_axis_title: str\n  y_axis_range: [float]        // [min, max]\u3001\u7a7a\u306e\u53ef\u80fd\u6027\u3042\u308a\n  w: int | null\n  h: int | null\n  series: [ChartSeries]\n  l: int                       // left (px)\n  t: int                       // top  (px)\n  error: str | null            // \u89e3\u6790\u5931\u6557\u6642\u306e\u307f\u30bb\u30c3\u30c8\n}\n</code></pre>"},{"location":"agents/DATA_MODEL/#6-printarea-model","title":"6. PrintArea Model","text":"<pre><code>PrintArea {\n  r1: int  // \u958b\u59cb\u884c (1-based, inclusive)\n  c1: int  // \u958b\u59cb\u5217 (0-based, inclusive)\n  r2: int  // \u7d42\u4e86\u884c (1-based, inclusive)\n  c2: int  // \u7d42\u4e86\u5217 (0-based, inclusive)\n}\n</code></pre> <p>\u88dc\u8db3:</p> <ul> <li>\u30b7\u30fc\u30c8\u3054\u3068\u306b\u8907\u6570\u4fdd\u6301\u53ef\u80fd</li> <li><code>standard</code> / <code>verbose</code> \u3067\u53d6\u5f97\u3067\u304d\u308b\u5834\u5408\u306b\u542b\u307e\u308c\u308b</li> </ul>"},{"location":"agents/DATA_MODEL/#7-printareaview-model","title":"7. PrintAreaView Model","text":"<pre><code>PrintAreaView {\n  book_name: str\n  sheet_name: str\n  area: PrintArea\n  shapes: [Shape | Arrow | SmartArt]\n  charts: [Chart]\n  rows: [CellRow]          // \u7bc4\u56f2\u306b\u4ea4\u5dee\u3059\u308b\u884c\u306e\u307f\u3001\u7a7a\u5217\u306f\u843d\u3068\u3059\n  table_candidates: [str]  // \u7bc4\u56f2\u5185\u306b\u53ce\u307e\u308b\u30c6\u30fc\u30d6\u30eb\u5019\u88dc\n}\n</code></pre> <p>\u88dc\u8db3:</p> <ul> <li>\u5ea7\u6a19\u306f\u30c7\u30d5\u30a9\u30eb\u30c8\u3067\u30b7\u30fc\u30c8\u57fa\u6e96\u3002<code>normalize</code> \u6307\u5b9a\u6642\u306f\u7bc4\u56f2\u5de6\u4e0a\u3092\u539f\u70b9\u306b\u518d\u57fa\u6e96\u5316</li> </ul>"},{"location":"agents/DATA_MODEL/#8-mergedcells-model","title":"8. MergedCells Model","text":"<pre><code>MergedCells {\n  schema: [\"r1\", \"c1\", \"r2\", \"c2\", \"v\"]\n  items: [[int, int, int, int, str]]\n}\n</code></pre> <ul> <li><code>items</code> \u306f <code>(r1, c1, r2, c2, v)</code> \u306e\u914d\u5217</li> <li>row \u306f 1-based\u3001col \u306f 0-based</li> <li><code>v</code> \u306f\u7d50\u5408\u30bb\u30eb\u306e\u4ee3\u8868\u5024\u3002\u5024\u304c\u306a\u3044\u5834\u5408\u3067\u3082 <code>\" \"</code> \u3092\u51fa\u529b\u3059\u308b</li> </ul>"},{"location":"agents/DATA_MODEL/#9-sheetdata-model","title":"9. SheetData Model","text":"<pre><code>SheetData {\n  rows: [CellRow]\n  shapes: [Shape | Arrow | SmartArt]\n  charts: [Chart]\n  table_candidates: [str]\n  print_areas: [PrintArea]\n  auto_print_areas: [PrintArea] // \u81ea\u52d5\u6539\u30da\u30fc\u30b8\u77e9\u5f62 (COM \u524d\u63d0\u3001\u30c7\u30d5\u30a9\u30eb\u30c8\u7121\u52b9)\n  formulas_map: {[formula: str]: [[int, int]]} // (row=1-based, col=0-based)\n  colors_map: {[colorHex: str]: [[int, int]]} // (row=1-based, col=0-based)\n  merged_cells: MergedCells | null\n}\n</code></pre> <p>\u88dc\u8db3:</p> <ul> <li><code>table_candidates</code> \u306f\u30c6\u30fc\u30d6\u30eb\u691c\u77e5\u7d50\u679c</li> <li><code>print_areas</code> \u306f\u5b9a\u7fa9\u6e08\u307f\u5370\u5237\u7bc4\u56f2</li> <li><code>auto_print_areas</code> \u306f Excel COM \u306e\u81ea\u52d5\u6539\u30da\u30fc\u30b8\u304b\u3089\u53d6\u5f97</li> <li><code>rows</code> \u306e\u7d50\u5408\u30bb\u30eb\u5024\u306e\u51fa\u529b\u306f <code>include_merged_values_in_rows</code> \u30d5\u30e9\u30b0\u3067\u5236\u5fa1\uff08\u65e2\u5b9a: <code>True</code>\uff09</li> </ul>"},{"location":"agents/DATA_MODEL/#10-workbookdata-model","title":"10. WorkbookData Model (\u30c8\u30c3\u30d7\u30ec\u30d9\u30eb)","text":"<pre><code>WorkbookData {\n  book_name: str\n  sheets: { [sheetName: str]: SheetData }\n}\n</code></pre> <p>\u88dc\u8db3:</p> <ul> <li>\u30b7\u30fc\u30c8\u540d\u306f Excel \u306e Unicode \u540d\u3092\u305d\u306e\u307e\u307e\u4fdd\u6301</li> </ul>"},{"location":"agents/DATA_MODEL/#11-export-helpers-sheetdata-workbookdata","title":"11. Export Helpers (SheetData / WorkbookData)","text":"<p>\u5171\u901a:</p> <ul> <li><code>to_json(pretty=False, indent=None)</code></li> <li><code>to_yaml()</code> (<code>pyyaml</code> \u5fc5\u9808)</li> <li><code>to_toon()</code> (<code>python-toon</code> \u5fc5\u9808)</li> <li><code>save(path, pretty=False, indent=None)</code></li> <li>\u62e1\u5f35\u5b50 <code>.json</code> / <code>.yaml</code> / <code>.yml</code> / <code>.toon</code> \u3092\u81ea\u52d5\u5224\u5225</li> <li>\u975e\u5bfe\u5fdc\u62e1\u5f35\u5b50\u306f <code>ValueError</code></li> <li><code>model_dump(exclude_none=True)</code> \u5f8c\u306b <code>dict_without_empty_values</code> \u3067\u7a7a\u5024\u3092\u9664\u53bb</li> </ul> <p><code>SheetData</code>:</p> <ul> <li>\u30b7\u30ea\u30a2\u30e9\u30a4\u30ba\u6642\u306b <code>book_name</code> \u306f\u542b\u307e\u306a\u3044\uff08\u30b7\u30fc\u30c8\u5358\u4f53\uff09</li> </ul> <p><code>WorkbookData</code>:</p> <ul> <li>\u30da\u30a4\u30ed\u30fc\u30c9\u306b <code>book_name</code> \u3068 <code>sheets</code> \u3092\u542b\u3080</li> <li><code>__getitem__(sheet_name)</code> \u3067 SheetData \u3092\u53d6\u5f97</li> <li><code>__iter__()</code> \u3067 <code>(sheet_name, SheetData)</code> \u3092\u9806\u306b\u8fd4\u3059</li> </ul>"},{"location":"agents/DATA_MODEL/#12-versioning-principles","title":"12. Versioning Principles","text":"<ul> <li>\u30e2\u30c7\u30eb\u5909\u66f4\u6642\u306f\u672c\u30d5\u30a1\u30a4\u30eb\u3092\u5148\u306b\u66f4\u65b0\u3059\u308b</li> <li>\u30e2\u30c7\u30eb\u306f\u7d14\u7c8b\u306a\u30c7\u30fc\u30bf\u30b3\u30f3\u30c6\u30ca\u3068\u3057\u3001\u526f\u4f5c\u7528\u3092\u6301\u305f\u305b\u306a\u3044</li> <li>core / io / integrate \u306f\u672c\u4ed5\u69d8\u306b\u5fe0\u5b9f\u306a\u30e2\u30c7\u30eb\u306e\u307f\u3092\u8fd4\u3057\u3001\u72ec\u81ea\u30d5\u30a3\u30fc\u30eb\u30c9\u3092\u8ffd\u52a0\u3057\u306a\u3044</li> </ul>"},{"location":"agents/DATA_MODEL/#13-changelog","title":"13. Changelog","text":"<ul> <li>0.3: serialize/save \u30d8\u30eb\u30d1\u30fc\u8ffd\u52a0\u3001<code>WorkbookData</code> \u306b <code>__iter__</code> / <code>__getitem__</code> \u3092\u5b9a\u7fa9</li> <li>0.4: <code>CellRow.links</code> \u3092\u8ffd\u52a0\uff08\u30cf\u30a4\u30d1\u30fc\u30ea\u30f3\u30af\u306f opt-in\uff09</li> <li>0.5: <code>PrintArea</code> \u3092\u8ffd\u52a0\u3057\u3001<code>SheetData.print_areas</code> \u3067\u4fdd\u6301</li> <li>0.6: PrintArea \u3092\u30c7\u30d5\u30a9\u30eb\u30c8\u62bd\u51fa\u3002\u30c6\u30fc\u30d6\u30eb\u691c\u77e5\u306f\u5f93\u6765\u901a\u308a</li> <li>0.7: Chart \u306b\u30b5\u30a4\u30ba <code>w</code> / <code>h</code> \u3092\u8ffd\u52a0</li> <li>0.8: <code>SheetData.auto_print_areas</code> \u3092\u8ffd\u52a0\uff08COM \u81ea\u52d5\u6539\u30da\u30fc\u30b8\u77e9\u5f62\u3001\u30c7\u30d5\u30a9\u30eb\u30c8\u7121\u52b9\uff09</li> <li>0.9: Shape \u306b <code>name</code> / <code>begin_connected_shape</code> / <code>end_connected_shape</code> \u3092\u8ffd\u52a0\u3057\u3001\u5f8c\u306b <code>begin_id</code> / <code>end_id</code> \u306b\u5909\u66f4</li> <li>0.10: Shape \u306b <code>id</code> \u3092\u8ffd\u52a0\u3057\u3001<code>name</code> \u3092\u524a\u9664</li> <li>0.11: \u30b3\u30cd\u30af\u30bf\u306e\u30d5\u30a3\u30fc\u30eb\u30c9\u540d\u3092 <code>begin_id</code> / <code>end_id</code> \u306b\u7d71\u4e00</li> <li>0.12: <code>SheetData.colors_map</code> \u3092\u8ffd\u52a0</li> <li>0.13: Shape \u3092 <code>Shape</code> / <code>Arrow</code> / <code>SmartArt</code> \u306b\u5206\u5272\u3057\u3001<code>SmartArtNode</code> \u306e\u30cd\u30b9\u30c8\u69cb\u9020\u3092\u8ffd\u52a0</li> <li>0.14: <code>MergedCell</code> / <code>SheetData.merged_cells</code> \u3092\u8ffd\u52a0</li> <li>0.15: <code>MergedCells</code> \u3092 schema + items \u5f62\u5f0f\u306b\u5909\u66f4\u3057\u5727\u7e2e\u5f62\u5f0f\u3092\u5c0e\u5165</li> <li>0.16: <code>SheetData.formulas_map</code> \u3092\u8ffd\u52a0</li> </ul>"},{"location":"agents/EXCEL_EXTRACTION/","title":"Excel Extraction Specification - ExStruct","text":"<p>\u3053\u306e\u6587\u66f8\u306f Excel \u304b\u3089\u306e\u62bd\u51fa\u51e6\u7406\u306e\u6700\u65b0\u4ed5\u69d8\u3092\u307e\u3068\u3081\u305f\u3082\u306e\u3067\u3059\u3002</p>"},{"location":"agents/EXCEL_EXTRACTION/#_1","title":"\u5168\u4f53\u30d5\u30ed\u30fc","text":"<ol> <li><code>resolve_extraction_inputs</code> \u3067 include_* \u3068 mode \u3092\u6b63\u898f\u5316</li> <li>pre-com\uff08openpyxl\uff09\u3067 cells/print_areas/colors_map \u3092\u53d6\u5f97</li> <li>com\uff08xlwings\uff09\u3067 shapes/charts/auto_page_breaks \u3092\u53d6\u5f97</li> <li>COM \u6210\u529f\u6642\u306f colors_map \u3092 COM \u7d50\u679c\u3067\u4e0a\u66f8\u304d</li> <li>COM \u5931\u6557\u6642\u306f cells+tables \u306e\u307f\u3067\u30d5\u30a9\u30fc\u30eb\u30d0\u30c3\u30af</li> </ol>"},{"location":"agents/EXCEL_EXTRACTION/#_2","title":"\u5ea7\u6a19\u7cfb","text":"<ul> <li>\u884c\u306f 1-based</li> <li>\u5217\u306f 0-based</li> </ul>"},{"location":"agents/EXCEL_EXTRACTION/#_3","title":"\u30e2\u30fc\u30c9","text":"<ul> <li>light: COM \u3092\u5b8c\u5168\u306b\u30b9\u30ad\u30c3\u30d7\u3001cells+tables \u306e\u307f</li> <li>standard: \u65e2\u5b58\u6319\u52d5\uff08\u30c6\u30ad\u30b9\u30c8\u4ed8\u304d\u56f3\u5f62\u3001\u5fc5\u8981\u306b\u5fdc\u3058\u3066\u30c1\u30e3\u30fc\u30c8\uff09</li> <li>verbose: \u5168\u56f3\u5f62 + \u30b5\u30a4\u30ba\u4ed8\u304d\u3001\u30c1\u30e3\u30fc\u30c8\u3082\u30b5\u30a4\u30ba\u4ed8\u304d</li> </ul>"},{"location":"agents/EXCEL_EXTRACTION/#cells","title":"Cells","text":"<ul> <li>pandas \u306e <code>read_excel(header=None, dtype=str)</code> \u3067\u8aad\u307f\u8fbc\u3080</li> <li>\u7a7a\u767d\u30bb\u30eb\u306f\u7121\u8996</li> <li>\u884c\u30c7\u30fc\u30bf\u306f <code>CellRow</code> \u306b\u6b63\u898f\u5316</li> </ul>"},{"location":"agents/EXCEL_EXTRACTION/#tables","title":"Tables","text":"<ul> <li>openpyxl \u306e\u30c6\u30fc\u30d6\u30eb\u5b9a\u7fa9 + \u7f6b\u7dda\u30af\u30e9\u30b9\u30bf\u30fc\u3092\u7d71\u5408</li> <li>COM \u304c\u4f7f\u3048\u306a\u3044\u5834\u5408\u3067\u3082 table_candidates \u3092\u7dad\u6301</li> </ul>"},{"location":"agents/EXCEL_EXTRACTION/#shapes-arrows-smartart","title":"Shapes / Arrows / SmartArt","text":"<p>\u62bd\u51fa\u5185\u5bb9:</p> <ul> <li>Type / AutoShapeType \u306e\u6b63\u898f\u5316\uff08<code>type</code> \u306f Shape \u306e\u307f\uff09</li> <li>Left/Top/Width/Height</li> <li>TextFrame2.TextRange.Text</li> <li>\u77e2\u5370\u65b9\u5411\u3084\u63a5\u7d9a\u60c5\u5831</li> <li>SmartArt \u306e layout/nodes/kids\uff08\u30cd\u30b9\u30c8\u69cb\u9020\uff09</li> </ul>"},{"location":"agents/EXCEL_EXTRACTION/#charts","title":"Charts","text":"<p>\u62bd\u51fa\u5185\u5bb9:</p> <ul> <li>ChartType\uff08\u6574\u6570 \u2192 XL_CHART_TYPE_MAP \u3067\u6587\u5b57\u5217\u5316\uff09</li> <li>Series / Axis Title / Axis Range</li> <li>Chart Title</li> </ul>"},{"location":"agents/EXCEL_EXTRACTION/#print-areas-auto-page-breaks","title":"Print Areas / Auto Page Breaks","text":"<ul> <li>print_areas \u306f pre-com\uff08openpyxl\uff09\u3067\u53d6\u5f97\u3057 COM \u3067\u306f\u88dc\u5b8c\u306e\u307f</li> <li>auto_page_breaks \u306f COM \u306e\u307f\u3067\u53d6\u5f97</li> </ul>"},{"location":"agents/EXCEL_EXTRACTION/#colors-map","title":"Colors Map","text":"<ul> <li>\u6761\u4ef6\u4ed8\u304d\u66f8\u5f0f\u306e\u8272\u3092\u542b\u3081\u308b\u305f\u3081 COM \u3092\u512a\u5148</li> <li>COM \u6210\u529f\u6642\u306f COM \u7d50\u679c\u3067\u4e0a\u66f8\u304d</li> <li>COM \u5931\u6557\u6642\u306e\u307f openpyxl \u7d50\u679c\u3092\u4f7f\u7528</li> </ul>"},{"location":"agents/EXCEL_EXTRACTION/#_4","title":"\u30a8\u30e9\u30fc\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0 / \u30d5\u30a9\u30fc\u30eb\u30d0\u30c3\u30af","text":"<ul> <li>COM \u4e0d\u53ef\u30fb\u4f8b\u5916\u6642\u306f cells+tables \u306e\u307f\u8fd4\u3059</li> <li>fallback \u7406\u7531\u306f <code>FallbackReason</code> \u3067\u7d71\u4e00\u30ed\u30b0</li> </ul>"},{"location":"agents/FEATURE_SPEC/","title":"Feature Spec for AI Agent (Phase-by-Phase)","text":"<p>\u672c\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u306f AI \u30a8\u30fc\u30b8\u30a7\u30f3\u30c8\u5411\u3051\u306b\u3001\u6bb5\u968e\u7684\u306b\u5b9f\u88c5\u3092\u9032\u3081\u308b\u305f\u3081\u306e\u4ed5\u69d8\u30e1\u30e2\u3067\u3059\u3002</p>"},{"location":"agents/FEATURE_SPEC/#mcp","title":"MCP\u30b5\u30fc\u30d0\u30fc\u6a5f\u80fd\u8ffd\u52a0","text":""},{"location":"agents/FEATURE_SPEC/#_1","title":"\u76ee\u7684","text":"<ul> <li>MCP \u30af\u30e9\u30a4\u30a2\u30f3\u30c8\uff08Codex / Claude / VS Code Copilot / Gemini CLI \u7b49\uff09\u304b\u3089 ExStruct \u3092\u300c\u30c4\u30fc\u30eb\u300d\u3068\u3057\u3066\u5b89\u5168\u306b\u547c\u3073\u51fa\u305b\u308b\u3088\u3046\u306b\u3059\u308b</li> <li>\u63a8\u8ad6\u306f\u30a8\u30fc\u30b8\u30a7\u30f3\u30c8\u5074\u3067\u884c\u3044\u3001MCP \u306f\u5236\u5fa1\u9762\uff08\u5b9f\u884c\u30fb\u7d50\u679c\u53c2\u7167\uff09\u306b\u5fb9\u3059\u308b</li> </ul>"},{"location":"agents/FEATURE_SPEC/#mvp","title":"\u30b9\u30b3\u30fc\u30d7\uff08MVP\uff09","text":"<ul> <li>stdio \u30c8\u30e9\u30f3\u30b9\u30dd\u30fc\u30c8\u306e MCP \u30b5\u30fc\u30d0\u30fc</li> <li>\u30c4\u30fc\u30eb: <code>exstruct_extract</code></li> <li>\u62bd\u51fa\u7d50\u679c\u306f \u5fc5\u305a\u30d5\u30a1\u30a4\u30eb\u51fa\u529b\uff08MCP \u5fdc\u7b54\u306f\u30d1\u30b9 + \u8efd\u3044\u30e1\u30bf\u60c5\u5831\uff09</li> <li>\u5b89\u5168\u306a\u30d1\u30b9\u5236\u7d04\uff08allowlist / deny glob\uff09</li> </ul>"},{"location":"agents/FEATURE_SPEC/#_2","title":"\u524d\u63d0\u30fb\u5236\u7d04","text":"<ul> <li>1MB \u7a0b\u5ea6\u306e Excel \u3092\u60f3\u5b9a</li> <li>\u51e6\u7406\u6642\u9593\u306f\u9577\u304f\u306a\u3063\u3066\u3082\u9ad8\u54c1\u8cea\u91cd\u8996</li> <li>Windows \u4ee5\u5916\u306f COM \u306a\u3057\u306e\u7c21\u6613\u8aad\u307f\u53d6\u308a\uff08\u30e9\u30a4\u30d6\u30e9\u30ea\u306e\u30b9\u30bf\u30f3\u30b9\u306b\u6e96\u62e0\uff09</li> </ul>"},{"location":"agents/FEATURE_SPEC/#json","title":"\u51fa\u529b JSON \u306e\u4ed5\u69d8","text":"<ul> <li><code>mode</code> \u3067\u51fa\u529b\u7c92\u5ea6\u3092\u9078\u629e: <code>light</code> / <code>standard</code> / <code>verbose</code></li> <li>\u4e92\u63db\u65b9\u91dd: \u8ffd\u52a0\u306f OK\u3001\u7834\u58ca\u7684\u5909\u66f4\u306f NG</li> </ul>"},{"location":"agents/FEATURE_SPEC/#light","title":"<code>light</code>","text":"<ul> <li>\u8efd\u91cf\u30e1\u30bf\u30c7\u30fc\u30bf\u4e2d\u5fc3\uff08\u30b7\u30fc\u30c8\u540d\u3001\u4ef6\u6570\u3001\u4e3b\u8981\u7bc4\u56f2\u306a\u3069\uff09</li> <li>\u5927\u304d\u306a\u30bb\u30eb\u672c\u6587\u3084\u8a73\u7d30\u69cb\u9020\u306f\u542b\u3081\u306a\u3044</li> </ul>"},{"location":"agents/FEATURE_SPEC/#standard","title":"<code>standard</code>","text":"<ul> <li>\u901a\u5e38\u904b\u7528\u5411\u3051\u306e\u57fa\u672c\u60c5\u5831</li> <li>\u30bb\u30eb\u60c5\u5831\u306f\u8981\u7d04\u30fb\u5727\u7e2e\u524d\u63d0</li> </ul>"},{"location":"agents/FEATURE_SPEC/#verbose","title":"<code>verbose</code>","text":"<ul> <li>\u8a73\u7d30\u306a\u69cb\u9020\u60c5\u5831\u3092\u542b\u3080</li> <li>\u5927\u5bb9\u91cf\u306b\u306a\u308a\u3084\u3059\u3044\u305f\u3081\u3001\u30d5\u30a1\u30a4\u30eb\u51fa\u529b\uff0b\u30c1\u30e3\u30f3\u30af\u53d6\u5f97\u524d\u63d0</li> </ul>"},{"location":"agents/FEATURE_SPEC/#mcp_1","title":"MCP \u30c4\u30fc\u30eb\u4ed5\u69d8\uff08\u6848\uff09","text":""},{"location":"agents/FEATURE_SPEC/#exstruct_extract","title":"<code>exstruct_extract</code>","text":"<ul> <li>\u5165\u529b: <code>xlsx_path</code>, <code>mode</code>, <code>format</code>, <code>out_dir?</code>, <code>out_name?</code>, <code>options?</code></li> <li>\u51fa\u529b: <code>out_path</code>, <code>workbook_meta</code>, <code>warnings</code>, <code>engine</code></li> <li>\u5b9f\u88c5: \u5185\u90e8 API \u3092\u512a\u5148\u3001\u30d5\u30a9\u30fc\u30eb\u30d0\u30c3\u30af\u3067 CLI \u30b5\u30d6\u30d7\u30ed\u30bb\u30b9</li> </ul>"},{"location":"agents/FEATURE_SPEC/#exstruct_read_json_chunk","title":"<code>exstruct_read_json_chunk</code>\uff08\u5b9f\u7528\u5316\u30d5\u30a7\u30fc\u30ba\uff09","text":"<ul> <li>\u5165\u529b: <code>out_path</code>, <code>sheet?</code>, <code>max_bytes?</code>, <code>filter?</code>, <code>cursor?</code></li> <li>\u51fa\u529b: <code>chunk</code>, <code>next_cursor?</code></li> <li>\u65b9\u91dd: \u8fd4\u5374\u30b5\u30a4\u30ba\u3092\u6291\u5236\u3057\u3001\u6bb5\u968e\u7684\u306b\u53d6\u5f97\u3067\u304d\u308b\u3053\u3068</li> </ul>"},{"location":"agents/FEATURE_SPEC/#exstruct_validate_input","title":"<code>exstruct_validate_input</code>\uff08\u5b9f\u7528\u5316\u30d5\u30a7\u30fc\u30ba\uff09","text":"<ul> <li>\u5165\u529b: <code>xlsx_path</code></li> <li>\u51fa\u529b: <code>is_readable</code>, <code>warnings</code>, <code>errors</code></li> </ul>"},{"location":"agents/FEATURE_SPEC/#_3","title":"\u30b5\u30fc\u30d0\u30fc\u8a2d\u8a08","text":"<ul> <li>stdio \u512a\u5148</li> <li>\u30ed\u30b0\u306f stderr / \u30d5\u30a1\u30a4\u30eb\uff08stdio \u3092\u6c5a\u3055\u306a\u3044\uff09</li> <li><code>--root</code> \u306b\u3088\u308a\u30a2\u30af\u30bb\u30b9\u7bc4\u56f2\u3092\u56fa\u5b9a</li> <li><code>--deny-glob</code> \u306b\u3088\u308a\u9632\u5fa1\u7684\u306b\u9664\u5916</li> <li><code>--on-conflict</code> \u3067\u51fa\u529b\u885d\u7a81\u65b9\u91dd\u3092\u6307\u5b9a\uff08overwrite / skip / rename\uff09</li> </ul>"},{"location":"agents/FEATURE_SPEC/#_4","title":"\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u69cb\u6210\uff08\u6848\uff09","text":"<pre><code>src/exstruct/\n  mcp/\n    __init__.py\n    server.py          # MCP server entrypoint (stdio)\n    tools.py           # tool definitions + handlers\n    io.py              # path validation, safe read/write\n    extract_runner.py  # internal API call or subprocess fallback\n    chunk_reader.py    # JSON partial read / pointer / sheet filters\n</code></pre>"},{"location":"agents/FEATURE_SPEC/#_5","title":"\u4eca\u5f8c\u306e\u30aa\u30d7\u30b7\u30e7\u30f3\u691c\u8a0e\u30e1\u30e2","text":"<ul> <li>\u8868\u691c\u77e5\u30b9\u30b3\u30a2\u30ea\u30f3\u30b0\u306e\u95be\u5024\u3092 CLI/\u74b0\u5883\u5909\u6570\u3067\u8abf\u6574\u53ef\u80fd\u306b\u3059\u308b</li> <li>\u51fa\u529b\u30e2\u30fc\u30c9\uff08light/standard/verbose\uff09\u306b\u5fdc\u3058\u3066\u30c6\u30fc\u30d6\u30eb\u5019\u88dc\u6570\u3092\u5236\u9650\u3059\u308b\u30aa\u30d7\u30b7\u30e7\u30f3</li> </ul>"},{"location":"agents/FEATURE_SPEC/#_6","title":"\u5b9f\u88c5\u65b9\u91dd","text":"<ul> <li>\u5c0f\u3055\u306a\u30b9\u30c6\u30c3\u30d7\u3054\u3068\u306b\u30c6\u30b9\u30c8\u8ffd\u52a0\u3001\u307e\u305f\u306f\u65e2\u5b58\u30d5\u30a3\u30af\u30b9\u30c1\u30e3\u3067\u624b\u52d5\u78ba\u8a8d</li> <li>\u77ed\u3044\u95a2\u6570\u30fb\u8cac\u52d9\u5206\u5272\u3067\u30b9\u30b3\u30a2\u30ea\u30f3\u30b0\u8abf\u6574\u3092\u3057\u3084\u3059\u304f\u3059\u308b</li> <li>\u5916\u90e8\u516c\u958b\u524d\u306a\u306e\u3067\u3001\u7834\u58ca\u7684\u5909\u66f4\u306f\u30b3\u30e1\u30f3\u30c8\u3084\u4ed5\u69d8\u306b\u660e\u793a\u3057\u3066\u6bb5\u968e\u7684\u306b\u79fb\u884c\u3059\u308b</li> </ul>"},{"location":"agents/OVERVIEW/","title":"ExStruct - Excel Semantic Structure Extraction Engine","text":"<p>ExStruct \u306f Excel \u30d6\u30c3\u30af\u304b\u3089\u610f\u5473\u69cb\u9020\u3092\u62bd\u51fa\u3059\u308b Python \u30e9\u30a4\u30d6\u30e9\u30ea\u3067\u3059\u3002 openpyxl \u3068 Excel COM\uff08xlwings\uff09\u3092\u7d44\u307f\u5408\u308f\u305b\u3001LLM \u304c\u6271\u3044\u3084\u3059\u3044\u69cb\u9020\u30c7\u30fc\u30bf\u3092\u751f\u6210\u3057\u307e\u3059\u3002</p>"},{"location":"agents/OVERVIEW/#_1","title":"\u7279\u5fb4","text":"<ul> <li>\u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u8a2d\u8a08\u3067\u62bd\u51fa\u30d5\u30ed\u30fc\u3092\u7d71\u4e00</li> <li>mode\uff08light/standard/verbose\uff09\u3067\u62bd\u51fa\u7c92\u5ea6\u3092\u5207\u66ff</li> <li>openpyxl/COM \u306e backend \u62bd\u8c61\u5316</li> <li>JSON/YAML/TOON \u51fa\u529b\uff08\u4f9d\u5b58\u304c\u3042\u308b\u5834\u5408\uff09</li> <li>print_areas / auto_page_breaks \u306e\u51fa\u529b\u5bfe\u5fdc</li> <li>\u30d5\u30a9\u30fc\u30eb\u30d0\u30c3\u30af\u7406\u7531\u3092\u7d71\u4e00\u30ed\u30b0\u3067\u53ef\u8996\u5316</li> </ul>"},{"location":"agents/OVERVIEW/#_2","title":"\u62bd\u51fa\u5bfe\u8c61","text":"<ul> <li>Cells\uff08\u5024/\u30ea\u30f3\u30af/\u5ea7\u6a19\uff09</li> <li>Tables\uff08\u5019\u88dc\u7bc4\u56f2\uff09</li> <li>Shapes / Arrows / SmartArt\uff08\u4f4d\u7f6e/\u30c6\u30ad\u30b9\u30c8/\u77e2\u5370/\u30ec\u30a4\u30a2\u30a6\u30c8\uff09</li> <li>Charts\uff08Series/Axis/Type/Title\uff09</li> <li>Print Areas / Auto Page Breaks</li> <li>Colors Map\uff08\u6761\u4ef6\u4ed8\u304d\u66f8\u5f0f\u3092\u542b\u3080\uff09</li> </ul>"},{"location":"agents/OVERVIEW/#_3","title":"\u5229\u7528\u4f8b\uff08\u6982\u8981\uff09","text":"<ul> <li><code>extract(path, mode=\"standard\")</code> \u3067 WorkbookData \u3092\u53d6\u5f97</li> <li><code>process_excel</code> \u3067\u30d5\u30a1\u30a4\u30eb\u51fa\u529b\u3084\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u51fa\u529b</li> <li>CLI \u3067 <code>exstruct file.xlsx --format json</code> \u3092\u5229\u7528</li> </ul>"},{"location":"agents/OVERVIEW/#_4","title":"\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u69cb\u6210\uff08\u6982\u8981\uff09","text":"<pre><code>docs/agents/          \u4ed5\u69d8\u66f8\nsrc/exstruct/\n  core/               \u62bd\u51fa\u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u3068 backend\n  models/             Pydantic \u30e2\u30c7\u30eb\n  io/                 JSON/YAML/TOON \u51fa\u529b\n  render/             PDF/PNG \u51fa\u529b\n  cli/                CLI\ntests/                \u30c6\u30b9\u30c8\n</code></pre> <p>AI \u30a8\u30fc\u30b8\u30a7\u30f3\u30c8\u306f docs \u4ee5\u4e0b\u306e\u4ed5\u69d8\u3092\u53c2\u7167\u3057\u3066\u5b9f\u88c5\u3057\u307e\u3059\u3002</p>"},{"location":"agents/RAG_INTEGRATION/","title":"RAG Integration \u2014 How to Use ExStruct in AI Pipelines","text":"<p>ExStruct \u306e\u60f3\u5b9a\u7528\u9014\u306f RAG\uff08Retrieval Augmented Generation\uff09\u3067\u3059\u3002</p>"},{"location":"agents/RAG_INTEGRATION/#_1","title":"\u63a8\u5968\u30d5\u30ed\u30fc","text":"<pre><code>Excel \u2192 ExStruct(JSON) \u2192 Chunking \u2192 VectorDB \u2192 LLM\n</code></pre>"},{"location":"agents/RAG_INTEGRATION/#json","title":"JSON \u305d\u306e\u307e\u307e\u683c\u7d0d\uff08\u69cb\u9020\u512a\u5148\uff09","text":"<ul> <li>ChartType / AutoShapeType / Coordinates \u304c\u5f37\u3044\u691c\u7d22\u30ad\u30fc</li> <li>\u30c6\u30fc\u30d6\u30eb\u691c\u7d22\u304c\u7cbe\u78ba</li> <li>Lookup \u578b RAG \u306b\u6700\u9069</li> </ul>"},{"location":"agents/RAG_INTEGRATION/#markdown","title":"Markdown \u5316\u3057\u3066\u683c\u7d0d\uff08\u751f\u6210\u54c1\u8cea\u512a\u5148\uff09","text":"<ul> <li>LLM \u304c\u8aad\u307f\u3084\u3059\u3044</li> <li>\u56de\u7b54\u304c\u81ea\u7136\u306b\u306a\u308b</li> </ul>"},{"location":"agents/RAG_INTEGRATION/#_2","title":"\u30cf\u30a4\u30d6\u30ea\u30c3\u30c9\u8a2d\u8a08\uff08\u6700\u3082\u63a8\u5968\uff09","text":"<pre><code>VectorDB #1: Structural JSON\nVectorDB #2: Markdown Summary\n</code></pre> <p>RAG \u5b9f\u884c\u6642\uff1a</p> <p>\u4e21\u65b9\u5408\u308f\u305b\u3066 LLM \u306b\u9001\u308b\u3002</p>"},{"location":"agents/RAG_INTEGRATION/#1","title":"1 \u3067\u69cb\u9020\u30de\u30c3\u30c1","text":""},{"location":"agents/RAG_INTEGRATION/#2","title":"2 \u3067\u81ea\u7136\u8a00\u8a9e\u30de\u30c3\u30c1","text":""},{"location":"agents/ROADMAP/","title":"Roadmap \u2014 ExStruct","text":""},{"location":"agents/ROADMAP/#v010","title":"v0.1.0","text":"<ul> <li>Core extraction\uff08Cells, Shapes, Charts\uff09</li> <li>JSON/YAML/TOON export</li> <li>PDF/PNG rendering</li> <li>\u7f6b\u7dda\u89e3\u6790</li> <li>\u8868\u69cb\u9020\u691c\u51fa\uff08Table heuristics\uff09</li> </ul>"},{"location":"agents/ROADMAP/#v020","title":"v0.2.0","text":"<ul> <li>Flowchart semantic mapping</li> <li>\u56f3\u5f62\u306e\u8ad6\u7406\u95a2\u4fc2\uff08\u77e2\u5370 \u2192 \u30ce\u30fc\u30c9\u9593\u30ea\u30f3\u30af\uff09</li> <li>\u30cf\u30a4\u30d1\u30fc\u30ea\u30f3\u30af\u53d6\u5f97\uff08\u30aa\u30d7\u30b7\u30e7\u30f3\uff09</li> </ul>"},{"location":"agents/ROADMAP/#v023","title":"v0.2.3","text":"<ul> <li>\u5370\u5237\u7bc4\u56f2\u30c7\u30fc\u30bf\u306b\u5bfe\u5fdc</li> <li>CLI \u3067\u81ea\u52d5\u6539\u30da\u30fc\u30b8\u7bc4\u56f2\u306e\u51fa\u529b\uff08COM \u9650\u5b9a\uff09</li> </ul>"},{"location":"agents/ROADMAP/#v0280","title":"v0.2.80","text":"<ul> <li>\u30d5\u30ed\u30fc\u30c1\u30e3\u30fc\u30c8\u63a8\u8ad6\u7cbe\u5ea6\u5f37\u5316</li> </ul>"},{"location":"agents/ROADMAP/#v0290","title":"v0.2.90","text":"<ul> <li>\u30bb\u30eb\u306e\u80cc\u666f\u8272\u60c5\u5831\u306e\u69cb\u9020\u5316</li> </ul>"},{"location":"agents/ROADMAP/#v030","title":"v0.3.0","text":"<ul> <li>\u5185\u90e8\u51e6\u7406\u30a2\u30fc\u30ad\u30c6\u30af\u30c1\u30e3\u306e\u30ea\u30d5\u30a1\u30af\u30bf\u30ea\u30f3\u30b0\u3068\u30ec\u30ac\u30b7\u30fc\u30aa\u30d7\u30b7\u30e7\u30f3\u306e\u5ec3\u6b62</li> </ul>"},{"location":"agents/ROADMAP/#v031","title":"v0.3.1","text":"<ul> <li>Shapes \u3068 Arrows \u306e\u5206\u96e2\uff08\u5f8c\u306e SmartArt \u8ffd\u52a0\u306e\u305f\u3081\uff09</li> <li>SmartArt \u89e3\u6790</li> </ul>"},{"location":"agents/ROADMAP/#v032","title":"v0.3.2","text":"<ul> <li>\u30bb\u30eb\u7d50\u5408\u7bc4\u56f2\u53d6\u5f97\u6a5f\u80fd\u8ffd\u52a0</li> </ul>"},{"location":"agents/ROADMAP/#v035","title":"v0.3.5","text":"<ul> <li>\u30bb\u30eb\u7d50\u5408\u7bc4\u56f2\u30c7\u30fc\u30bf\u5727\u7e2e\u3068rows\u30c7\u30fc\u30bf\u69cb\u9020\u898b\u76f4\u3057\u306b\u3088\u308b\u30b3\u30f3\u30c6\u30ad\u30b9\u30c8\u5727\u7e2e</li> </ul>"},{"location":"agents/ROADMAP/#v037","title":"v0.3.7","text":"<ul> <li>\u6570\u5f0f\u53d6\u5f97\u30aa\u30d7\u30b7\u30e7\u30f3\u8ffd\u52a0</li> </ul>"},{"location":"agents/ROADMAP/#v040","title":"v0.4.0","text":"<ul> <li>MCP\u30b5\u30fc\u30d0\u30fc\u6a5f\u80fd\u8ffd\u52a0</li> </ul>"},{"location":"agents/ROADMAP/#v050","title":"v0.5.0","text":"<ul> <li>Excel Form Controls \u89e3\u6790</li> </ul>"},{"location":"agents/ROADMAP/#v100","title":"v1.0.0","text":"<ul> <li>\u5b8c\u5168\u306a Excel \u610f\u5473\u69cb\u9020\u89e3\u6790\u30a8\u30f3\u30b8\u30f3</li> <li>RAG \u6700\u9069\u5316\u30e2\u30fc\u30c9\u642d\u8f09</li> </ul>"},{"location":"agents/TASKS/","title":"Task List","text":"<p>\u672a\u5b8c\u4e86 [ ], \u5b8c\u4e86 [x]</p>"},{"location":"agents/TASKS/#mcpmvp","title":"MCP\u30b5\u30fc\u30d0\u30fc\uff08MVP\uff09","text":"<ul> <li>[x] \u4ed5\u69d8\u53cd\u6620: <code>docs/agents/FEATURE_SPEC.md</code> \u3092\u66f4\u65b0</li> <li>[x] \u4f9d\u5b58\u8ffd\u52a0: <code>pyproject.toml</code> \u306b <code>exstruct[mcp]</code> \u306e extras \u3092\u8ffd\u52a0</li> <li>[x] \u30a8\u30f3\u30c8\u30ea\u30dd\u30a4\u30f3\u30c8: <code>exstruct-mcp = exstruct.mcp.server:main</code> \u3092\u5b9a\u7fa9</li> <li>[x] MCP \u57fa\u76e4: <code>src/exstruct/mcp/server.py</code> \u3092\u8ffd\u52a0\uff08stdio \u30b5\u30fc\u30d0\u30fc\u8d77\u52d5\uff09</li> <li>[x] \u30c4\u30fc\u30eb\u5b9a\u7fa9: <code>src/exstruct/mcp/tools.py</code> \u306b <code>exstruct_extract</code> \u3092\u5b9f\u88c5</li> <li>[x] \u30d1\u30b9\u5236\u7d04: <code>src/exstruct/mcp/io.py</code> \u306b allowlist / deny glob \u3092\u5b9f\u88c5</li> <li>[x] \u62bd\u51fa\u5b9f\u884c: <code>src/exstruct/mcp/extract_runner.py</code> \u306b\u5185\u90e8 API \u512a\u5148\u306e\u5b9f\u884c\u5c64\u3092\u5b9f\u88c5</li> <li>[x] \u51fa\u529b\u30e2\u30c7\u30eb: Pydantic \u3067\u5165\u51fa\u529b\u30e2\u30c7\u30eb\u3092\u5b9a\u7fa9\uff08mypy strict / Ruff \u9075\u5b88\uff09</li> <li>[x] \u30ed\u30b0: stderr / \u30d5\u30a1\u30a4\u30eb\u51fa\u529b\u306e\u8a2d\u5b9a\u3092\u8ffd\u52a0</li> <li>[x] \u30c9\u30ad\u30e5\u30e1\u30f3\u30c8: README \u307e\u305f\u306f docs \u306b\u8d77\u52d5\u4f8b\uff08<code>exstruct-mcp --root ...</code>\uff09\u3092\u8ffd\u8a18</li> </ul>"},{"location":"agents/TASKS/#mcp","title":"MCP\u30b5\u30fc\u30d0\u30fc\uff08\u5b9f\u7528\u5316\uff09","text":"<ul> <li>[x] <code>exstruct_read_json_chunk</code> \u3092\u8ffd\u52a0\uff08\u5927\u5bb9\u91cf JSON \u5bfe\u5fdc\uff09</li> <li>[x] <code>exstruct_validate_input</code> \u3092\u8ffd\u52a0\uff08\u4e8b\u524d\u691c\u8a3c\uff09</li> <li>[x] <code>--on-conflict</code> \u306e\u51fa\u529b\u885d\u7a81\u30dd\u30ea\u30b7\u30fc\u5b9f\u88c5</li> <li>[x] Windows/\u975eWindows \u306e\u8aad\u307f\u53d6\u308a\u5dee\u5206\u3092\u660e\u6587\u5316</li> <li>[x] \u6700\u4f4e\u9650\u306e\u30c6\u30b9\u30c8\u8ffd\u52a0\uff08\u30d1\u30b9\u5236\u7d04 / \u5165\u51fa\u529b\u30e2\u30c7\u30eb / \u4f8b\u5916\uff09</li> </ul>"},{"location":"agents/TASKS/#pr-47","title":"PR #47 \u30ec\u30d3\u30e5\u30fc\u5bfe\u5fdc","text":"<ul> <li>[x] cells.py \u306e\u5217\u5e45\u7e2e\u5c0f\u30d2\u30e5\u30fc\u30ea\u30b9\u30c6\u30a3\u30c3\u30af\u3092\u518d\u691c\u8a0e\uff08\u9045\u3044\u884c\u306b\u5883\u754c\u304c\u3042\u308b\u30b1\u30fc\u30b9\u3067\u65e9\u671f\u7e2e\u5c0f\u3057\u306a\u3044\u65b9\u91dd\u306b\u4fee\u6b63\uff09</li> <li>[x] \u4e0a\u8a18\u4fee\u6b63\u306b\u5bfe\u5fdc\u3059\u308b\u30c6\u30b9\u30c8\u3092\u8ffd\u52a0\uff08\u9045\u3044\u884c\u30fb\u53f3\u7aef\u306b\u8868\u304c\u3042\u308b\u30b1\u30fc\u30b9\u3092 openpyxl \u3067\u691c\u8a3c\uff09</li> <li>[x] Codecov \u6307\u6458\u306e\u4e0d\u8db3\u5206\u3092\u57cb\u3081\u308b\u30c6\u30b9\u30c8\u8ffd\u52a0\uff08mcp: chunk_reader/extract_runner/server/tools/validate_input/io\u3001core/cells\uff09</li> <li>[x] CodeRabbit: Docstring coverage 80% \u3092\u6e80\u305f\u3059\u3088\u3046\u4e0d\u8db3\u5206\u306e docstring \u3092\u8ffd\u52a0</li> </ul>"},{"location":"agents/TEST_REQUIREMENTS/","title":"ExStruct \u30c6\u30b9\u30c8\u8981\u4ef6\u4ed5\u69d8\u66f8","text":"<p>Version: 0.5 Status: Required for Release</p> <p>ExStruct \u306e\u5168\u6a5f\u80fd\u306b\u3064\u3044\u3066\u3001\u6b63\u5f0f\u306a\u30c6\u30b9\u30c8\u8981\u4ef6\u3092\u307e\u3068\u3081\u305f\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8\u3067\u3059\u3002AI \u30a8\u30fc\u30b8\u30a7\u30f3\u30c8\uff0f\u4eba\u9593\u958b\u767a\u8005\u304c\u81ea\u52d5\u30c6\u30b9\u30c8\u30fb\u624b\u52d5\u30c6\u30b9\u30c8\u3092\u8a2d\u8a08\u3059\u308b\u305f\u3081\u306e\u57fa\u76e4\u3068\u3057\u307e\u3059\u3002 \u5168\u4f53\u306e\u30b3\u30fc\u30c9\u30ab\u30d0\u30ec\u30c3\u30b8\u306f 78% \u4ee5\u4e0a \u3092\u6e80\u305f\u3059\u3053\u3068\u3002</p>"},{"location":"agents/TEST_REQUIREMENTS/#1","title":"1. \u30ab\u30d0\u30ec\u30c3\u30b8\u30ab\u30c6\u30b4\u30ea","text":"<ol> <li>\u30bb\u30eb\u62bd\u51fa</li> <li>\u56f3\u5f62\u62bd\u51fa</li> <li>\u77e2\u5370\u30fb\u65b9\u5411\u63a8\u5b9a</li> <li>\u30c1\u30e3\u30fc\u30c8\u62bd\u51fa</li> <li>\u30ec\u30a4\u30a2\u30a6\u30c8\u7d71\u5408</li> <li>Pydantic \u691c\u8a3c</li> <li>\u51fa\u529b\uff08JSON/YAML/TOON\uff09</li> <li>CLI</li> <li>\u30a8\u30e9\u30fc\u51e6\u7406\u30fb\u30d5\u30a7\u30a4\u30eb\u30bb\u30fc\u30d5</li> <li>\u56de\u5e30</li> <li>\u30d1\u30d5\u30a9\u30fc\u30de\u30f3\u30b9\u30fb\u30e1\u30e2\u30ea</li> </ol>"},{"location":"agents/TEST_REQUIREMENTS/#2","title":"2. \u6a5f\u80fd\u8981\u4ef6","text":""},{"location":"agents/TEST_REQUIREMENTS/#21","title":"2.1 \u30bb\u30eb\u62bd\u51fa","text":"<ul> <li>[CEL-01] \u7a7a\u30bb\u30eb\u3092\u9664\u5916\u3057\u3001\u975e\u7a7a\u30bb\u30eb\u306e\u307f <code>c</code> \u306b\u51fa\u529b\u3059\u308b</li> <li>[CEL-02] \u884c\u756a\u53f7 <code>r</code> \u306f 0 \u59cb\u307e\u308a</li> <li>[CEL-03] \u5217\u30ad\u30fc\u306f 0 \u59cb\u307e\u308a\u306e\u30a4\u30f3\u30c7\u30c3\u30af\u30b9 \"0\", \"1\" \u2026</li> <li>[CEL-04] \u6539\u884c\u30fb\u30bf\u30d6\u3092\u542b\u3080\u30bb\u30eb\u3082\u6b63\u3057\u304f\u8aad\u307f\u53d6\u308c\u308b</li> <li>[CEL-05] Unicode\uff08\u65e5\u672c\u8a9e\u30fb\u7d75\u6587\u5b57\u30fb\u30b5\u30ed\u30b2\u30fc\u30c8\uff09\u3092\u4fdd\u6301</li> <li>[CEL-06] pandas \u8aad\u307f\u8fbc\u307f\u3067 dtype=string \u3092\u5f37\u5236</li> <li>[CEL-07] \u30b7\u30fc\u30c8\u5168\u4f53\u898f\u6a21\u3067\u3082\u6027\u80fd\u52a3\u5316\u3057\u306a\u3044</li> <li>[CEL-08] <code>_coerce_numeric_preserve_format</code> \u304c int/float/\u975e\u6570\u3092\u6b63\u3057\u304f\u5224\u5b9a</li> <li>[CEL-09] <code>detect_tables_openpyxl</code> \u304c openpyxl Table \u3092\u691c\u51fa</li> <li>[CEL-10] <code>CellRow.links</code> \u306f mode=verbose \u307e\u305f\u306f include_cell_links=True \u3067\u51fa\u529b</li> <li>[CEL-11] detect_tables \u306f .xlsx/.xls \u306e\u62e1\u5f35\u5b50\u3068 openpyxl \u6709\u7121\u3067\u7d4c\u8def\u3092\u5207\u308a\u66ff\u3048\u308b</li> </ul>"},{"location":"agents/TEST_REQUIREMENTS/#211","title":"2.1.1 \u30bb\u30eb\u80cc\u666f\u8272","text":"<ul> <li>[COL-01] <code>include_colors_map=True</code> \u306e\u307f <code>colors_map</code> \u3092\u62bd\u51fa</li> <li>[COL-02] <code>include_default_background=False</code> \u3067\u306f <code>FFFFFF</code> \u3092\u51fa\u529b\u3057\u306a\u3044</li> <li>[COL-03] <code>ignore_colors</code> \u6307\u5b9a\u6642\u306f\u5bfe\u8c61\u8272\u3092\u9664\u5916\uff08<code>#</code> \u4ed8\u304d/\u5927\u5c0f\u6587\u5b57\u3092\u6b63\u898f\u5316\uff09</li> <li>[COL-04] COM \u5229\u7528\u6642\u306f <code>DisplayFormat.Interior</code> \u3092\u53c2\u7167\u3057\u6761\u4ef6\u4ed8\u304d\u66f8\u5f0f\u3092\u542b\u3081\u3066\u53d6\u5f97</li> <li>[COL-05] <code>_normalize_color_key</code> / <code>_normalize_rgb</code> \u306f ARGB/#/auto/theme/indexed \u3092\u6b63\u898f\u5316</li> </ul>"},{"location":"agents/TEST_REQUIREMENTS/#212","title":"2.1.2 \u7d50\u5408\u30bb\u30eb","text":"<ul> <li>[MRG-01] standard/verbose \u306e\u307f <code>merged_cells</code> \u3092\u62bd\u51fa\u3059\u308b\uff08light \u306f\u7a7a\uff09</li> <li>[MRG-02] 1-based row / 0-based column \u306e\u5ea7\u6a19\u3067\u51fa\u529b\u3059\u308b</li> <li>[MRG-03] <code>v</code> \u306f\u7d50\u5408\u7bc4\u56f2\u306e\u5de6\u4e0a\u30bb\u30eb\u5024\uff08None \u306f\u7a7a\u6587\u5b57\uff09</li> <li>[MRG-04] \u8907\u6570\u7bc4\u56f2\u304c\u3042\u308b\u5834\u5408\u3082\u5168\u4ef6\u3092\u4fdd\u6301\u3059\u308b</li> </ul>"},{"location":"agents/TEST_REQUIREMENTS/#22","title":"2.2 \u56f3\u5f62\u62bd\u51fa","text":"<ul> <li>[SHP-01] AutoShape \u306e type \u3092\u6b63\u898f\u5316</li> <li>[SHP-02] TextFrame \u3092\u6b63\u3057\u304f\u53d6\u5f97</li> <li>[SHP-02a] <code>type</code> \u306f Shape \u306e\u307f\u4fdd\u6301\u3057\u3001Arrow/SmartArt \u3067\u306f\u51fa\u529b\u3057\u306a\u3044</li> <li>[SHP-03] \u30b5\u30a4\u30ba <code>w</code>,<code>h</code> \u306f\u53d6\u5f97\u3067\u304d\u306a\u3044\u5834\u5408\u306e\u307f null</li> <li>[SHP-04] \u30b0\u30eb\u30fc\u30d7\u56f3\u5f62\u306f\u5c55\u958b\u65b9\u91dd\u3092\u4e00\u8cab\u3055\u305b\u308b</li> <li>[SHP-05] \u5ea7\u6a19 <code>l</code>,<code>t</code> \u306f\u6574\u6570\u3067\u53d6\u5f97\u3057\u30ba\u30fc\u30e0\u306e\u5f71\u97ff\u3092\u53d7\u3051\u306a\u3044</li> <li>[SHP-07] \u56de\u8ee2\u89d2\u5ea6\u306f Excel \u3068\u4e00\u81f4</li> <li>[SHP-09] begin/end_arrow_style \u306f Excel ENUM \u3068\u4e00\u81f4</li> <li>[SHP-10] direction \u306f 8 \u65b9\u4f4d\u306b\u6b63\u898f\u5316</li> <li>[SHP-11] \u30c6\u30ad\u30b9\u30c8\u306a\u3057\u56f3\u5f62\u306f text=\"\"</li> <li>[SHP-12] \u8907\u6570\u6bb5\u843d\u306e\u30c6\u30ad\u30b9\u30c8\u3082\u53d6\u5f97</li> </ul>"},{"location":"agents/TEST_REQUIREMENTS/#221-smartart","title":"2.2.1 SmartArt \u62bd\u51fa","text":"<ul> <li>[SHP-SA-01] SmartArt \u306f <code>layout</code> \u3092\u5fc5\u9808\u3067\u51fa\u529b\u3059\u308b</li> <li>[SHP-SA-02] SmartArt \u306e\u30ce\u30fc\u30c9\u306f <code>nodes</code> \u306b\u30cd\u30b9\u30c8\u69cb\u9020\u3067\u51fa\u529b\u3059\u308b</li> <li>[SHP-SA-03] \u30ce\u30fc\u30c9\u306e\u5b50\u306f <code>kids</code> \u3067\u8868\u73fe\u3059\u308b\uff08level \u306f\u51fa\u529b\u3057\u306a\u3044\uff09</li> <li>[SHP-SA-04] SmartArt \u304c\u5b58\u5728\u3059\u308b\u5834\u5408\u306f <code>kind=\"smartart\"</code> \u3067\u5224\u5225\u3067\u304d\u308b</li> </ul>"},{"location":"agents/TEST_REQUIREMENTS/#23","title":"2.3 \u77e2\u5370\u65b9\u5411\u63a8\u5b9a","text":"<ul> <li>[DIR-01] 0\u00b0 \u00b122.5\u00b0 \u2192 \"E\"</li> <li>[DIR-02] 45\u00b0 \u00b122.5\u00b0 \u2192 \"NE\"</li> <li>[DIR-03] 90\u00b0 \u00b122.5\u00b0 \u2192 \"N\"</li> <li>[DIR-04] 135\u00b0 \u00b122.5\u00b0 \u2192 \"NW\"</li> <li>[DIR-05] 180\u00b0 \u00b122.5\u00b0 \u2192 \"W\"</li> <li>[DIR-06] 225\u00b0 \u00b122.5\u00b0 \u2192 \"SW\"</li> <li>[DIR-07] 270\u00b0 \u00b122.5\u00b0 \u2192 \"S\"</li> <li>[DIR-08] 315\u00b0 \u00b122.5\u00b0 \u2192 \"SE\"</li> <li>[DIR-09] \u5883\u754c\u89d2\u5ea6\u306f\u4ed5\u69d8\u3069\u304a\u308a\u4e38\u3081\u308b</li> </ul>"},{"location":"agents/TEST_REQUIREMENTS/#24","title":"2.4 \u30c1\u30e3\u30fc\u30c8\u62bd\u51fa","text":"<ul> <li>[CH-01] ChartType \u306f <code>XL_CHART_TYPE_MAP</code> \u3067\u6b63\u898f\u5316</li> <li>[CH-02] \u30bf\u30a4\u30c8\u30eb\u53d6\u5f97\uff08\u306a\u3051\u308c\u3070 null\uff09</li> <li>[CH-03] y_axis_title \u53d6\u5f97\uff08\u306a\u3051\u308c\u3070\u7a7a\u6587\u5b57\uff09</li> <li>[CH-04] \u8ef8 min/max \u306f float</li> <li>[CH-05] \u672a\u8a2d\u5b9a\u8ef8\u306f\u7a7a\u30ea\u30b9\u30c8</li> <li>[CH-06] name_range \u3092\u53c2\u7167\u5f0f\u3067\u51fa\u529b\uff08\u4f8b: <code>=Sheet1!$B$1</code>\uff09</li> <li>[CH-06a] \u6587\u5b57\u5217\u30ea\u30c6\u30e9\u30eb\u306e series \u540d\u306f name_literal \u306b\u683c\u7d0d\u3055\u308c\u308b</li> <li>[CH-07] x_range \u3092\u53c2\u7167\u5f0f\u3067\u51fa\u529b</li> <li>[CH-08] y_range \u3092\u53c2\u7167\u5f0f\u3067\u51fa\u529b</li> <li>[CH-09] \u4e3b\u8981\u30c1\u30e3\u30fc\u30c8\u7a2e\u5225\uff08\u6563\u5e03\u30fb\u68d2\u306a\u3069\uff09\u3092\u89e3\u6790</li> <li>[CH-10] \u5931\u6557\u6642\u306f <code>error</code> \u306b\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u6b8b\u3057\u30c1\u30e3\u30fc\u30c8\u3092\u7dad\u6301</li> <li>[CH-11] \u6587\u5316\u570f\u5dee\u306e\u30bb\u30df\u30b3\u30ed\u30f3\u533a\u5207\u308a\u3082\u89e3\u6790\u3067\u304d\u308b</li> </ul>"},{"location":"agents/TEST_REQUIREMENTS/#25","title":"2.5 \u30ec\u30a4\u30a2\u30a6\u30c8\u7d71\u5408","text":"<ul> <li>[LAY-01] Shape \u306e\u30c6\u30ad\u30b9\u30c8\u3092\u5c5e\u3059\u308b\u884c\u306b\u7d10\u3065\u3051\u308b</li> <li>[LAY-02] \u5217\u65b9\u5411\u306e\u7c21\u6613\u7d10\u3065\u3051\uff08\u672a\u5b9f\u88c5\u306e\u305f\u3081 skip\uff09</li> <li>[LAY-03] 1 \u884c\u306b\u8907\u6570 shape \u304c\u3042\u308b\u5834\u5408\u3082\u9806\u5e8f\u3092\u4fdd\u6301</li> <li>[LAY-04] \u56f3\u5f62\u306a\u3057\u306a\u3089\u7a7a\u30ea\u30b9\u30c8</li> </ul>"},{"location":"agents/TEST_REQUIREMENTS/#3","title":"3. \u30e2\u30c7\u30eb\u691c\u8a3c\u8981\u4ef6","text":"<ul> <li>[MOD-01] \u3059\u3079\u3066\u306e\u30e2\u30c7\u30eb\u306f <code>BaseModel</code> \u7d99\u627f</li> <li>[MOD-02] \u578b\u304c DATA_MODEL.md \u3068\u5b8c\u5168\u4e00\u81f4</li> <li>[MOD-03] Optional \u306f\u672a\u6307\u5b9a\u3067 None</li> <li>[MOD-04] \u6570\u5024\u306f int/float \u306b\u6b63\u898f\u5316</li> <li>[MOD-05] direction Literal \u3067\u4e0d\u6b63\u5024\u306f ValidationError</li> <li>[MOD-06] rows/shapes/charts/tables \u306f\u30c7\u30d5\u30a9\u30eb\u30c8\u7a7a\u30ea\u30b9\u30c8</li> <li>[MOD-07] WorkbookData \u306f <code>__getitem__</code> \u3068\u9806\u5e8f\u4ed8\u304d iteration \u3092\u63d0\u4f9b</li> <li>[MOD-08] PrintArea \u306f row=1-based / column=0-based \u3092\u6e80\u305f\u3059</li> </ul>"},{"location":"agents/TEST_REQUIREMENTS/#4-jsonyamltoon","title":"4. \u51fa\u529b\u8981\u4ef6\uff08JSON/YAML/TOON\uff09","text":"<ul> <li>[EXP-01] None/\u7a7a\u6587\u5b57/\u7a7a\u30ea\u30b9\u30c8/\u7a7a dict \u306f <code>dict_without_empty_values</code> \u3067\u9664\u53bb</li> <li>[EXP-02] JSON \u51fa\u529b\u306f UTF-8</li> <li>[EXP-03] YAML \u51fa\u529b\u306f sort_keys=False</li> <li>[EXP-04] TOON \u51fa\u529b\u304c\u6b63\u3057\u304f\u751f\u6210\u3055\u308c\u308b</li> <li>[EXP-05] WorkbookData \u2192 JSON \u2192 WorkbookData \u306e\u5f80\u5fa9\u3067\u7834\u58ca\u7684\u5909\u66f4\u306a\u3057</li> <li>[EXP-06] <code>export_sheets</code> \u304c\u30b7\u30fc\u30c8\u5358\u4f4d\u3067\u30d5\u30a1\u30a4\u30eb\u51fa\u529b</li> <li>[EXP-07] <code>to_json</code> \u306f pretty/indent \u306b\u5bfe\u5fdc</li> <li>[EXP-08] <code>save(path)</code> \u306f\u62e1\u5f35\u5b50\u3067\u5224\u5225\u3057\u672a\u5bfe\u5fdc\u62e1\u5f35\u5b50\u306f ValueError</li> <li>[EXP-09] <code>to_yaml</code> / <code>to_toon</code> \u306f\u4f9d\u5b58\u672a\u5c0e\u5165\u6642\u306b MissingDependencyError</li> <li>[EXP-10] OutputOptions \u306e include_* \u3067\u5bfe\u8c61\u30d5\u30a3\u30fc\u30eb\u30c9\u3092\u9664\u5916\u3057\u7a7a\u30ea\u30b9\u30c8\u306f\u51fa\u529b\u3057\u306a\u3044</li> <li>[EXP-11] <code>print_areas_dir</code> / <code>save_print_area_views</code> \u3067\u5370\u5237\u7bc4\u56f2\u3054\u3068\u306e\u30d5\u30a1\u30a4\u30eb\u51fa\u529b\uff08\u7bc4\u56f2\u306a\u3057\u306a\u3089\u66f8\u304d\u51fa\u3055\u306a\u3044\uff09</li> <li>[EXP-12] PrintAreaView \u306f\u7bc4\u56f2\u5185\u306e\u884c\u306e\u307f\u4fdd\u6301\u3057\u3001\u7bc4\u56f2\u5916\u306e\u30bb\u30eb/\u30ea\u30f3\u30af\u3092\u9664\u5916</li> <li>[EXP-13] PrintAreaView \u306e table_candidates \u306f\u7bc4\u56f2\u5185\u306b\u5b8c\u5168\u306b\u53ce\u307e\u308b\u3082\u306e\u306e\u307f</li> <li>[EXP-14] normalize=True \u3067\u884c\u30fb\u5217\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u3092\u5370\u5237\u7bc4\u56f2\u8d77\u70b9\u306b\u518d\u57fa\u6e96\u5316</li> <li>[EXP-15] include_print_areas=False \u306e\u5834\u5408\u306f print_areas_dir \u304c\u3042\u3063\u3066\u3082\u51fa\u529b\u3057\u306a\u3044</li> <li>[EXP-16] PrintAreaView \u306f\u7bc4\u56f2\u3068\u4ea4\u5dee\u3059\u308b shapes/charts \u306e\u307f\u542b\u3081\u3001\u30b5\u30a4\u30ba\u4e0d\u660e\u306e\u56f3\u5f62\u306f\u70b9\u6271\u3044</li> <li>[EXP-17] Chart.w/h \u306f verbose \u3067\u51fa\u529b\u3057\u3001standard \u3067\u306f include_chart_size \u3067\u5236\u5fa1</li> <li>[EXP-18] Shape.w/h \u306f include_shape_size \u3067\u5236\u5fa1\u3057\u3001\u30c7\u30d5\u30a9\u30eb\u30c8 True \u306f verbose \u306e\u307f</li> <li>[EXP-19] auto_page_breaks_dir \u6307\u5b9a\u6642\u306f include_auto_page_breaks=True \u3067 auto_print_areas \u3092\u53d6\u5f97\uff08COM \u5fc5\u9808\uff09</li> <li>[EXP-20] export_auto_page_breaks \u306f auto_print_areas \u304c\u7a7a\u306a\u3089\u4f8b\u5916\u3001\u5b58\u5728\u6642\u306e\u307f\u66f8\u304d\u51fa\u3057</li> <li>[EXP-21] save_auto_page_break_views \u306f auto_print_areas \u3092 Sheet1#auto#1 \u306a\u3069\u30e6\u30cb\u30fc\u30af\u30ad\u30fc\u3067\u4fdd\u5b58</li> <li>[EXP-22] serialize_workbook \u306f\u672a\u5bfe\u5fdc\u30d5\u30a9\u30fc\u30de\u30c3\u30c8\u3067 SerializationError</li> <li>[EXP-23] export/process API \u306f output_path/sheets_dir/print_areas_dir/auto_page_breaks_dir \u306b str/Path \u3092\u6e21\u3057\u3066\u3082\u6b63\u3057\u304f\u51fa\u529b\u3067\u304d\u308b</li> <li>[EXP-24] fmt=\"yml\" \u306f yaml \u3068\u3057\u3066\u6271\u3044\u3001\u62e1\u5f35\u5b50\u306f .yaml \u306b\u306a\u308b</li> <li>[EXP-25] OutputOptions \u306e include_merged_cells=False \u3067 <code>merged_cells</code> \u3092\u9664\u5916</li> </ul>"},{"location":"agents/TEST_REQUIREMENTS/#5-cli","title":"5. CLI \u8981\u4ef6","text":"<ul> <li>[CLI-01] <code>exstruct extract file.xlsx</code> \u304c\u6210\u529f\u3059\u308b</li> <li>[CLI-02] <code>--format json/yaml/toon</code> \u304c\u6a5f\u80fd\u3059\u308b</li> <li>[CLI-03] <code>--image</code> \u3067 PNG \u51fa\u529b</li> <li>[CLI-04] <code>--pdf</code> \u3067 PDF \u51fa\u529b</li> <li>[CLI-05] \u7121\u52b9\u30d1\u30b9\u5165\u529b\u6642\u3082\u5b89\u5168\u306b\u7d42\u4e86\uff08\u30af\u30e9\u30c3\u30b7\u30e5\u3057\u306a\u3044\uff09</li> <li>[CLI-06] \u30a8\u30e9\u30fc\u30e1\u30c3\u30bb\u30fc\u30b8\u306f stdout/stderr \u306b\u51fa\u529b</li> <li>[CLI-07] <code>--print-areas-dir</code> \u3067\u5370\u5237\u7bc4\u56f2\u30d5\u30a1\u30a4\u30eb\u3092\u51fa\u529b\u3057\u3001include_print_areas=False \u306a\u3089\u30b9\u30ad\u30c3\u30d7</li> <li>[CLI-08] Windows \u306e cp932 \u74b0\u5883\uff08\u4f8b: PYTHONIOENCODING=cp932\uff09\u3067\u3082 stdout \u51fa\u529b\u304c UTF-8 \u3092\u7dad\u6301</li> </ul>"},{"location":"agents/TEST_REQUIREMENTS/#6","title":"6. \u30a8\u30e9\u30fc\u51e6\u7406\u8981\u4ef6","text":"<ul> <li>[ERR-01] xlwings COM \u30a8\u30e9\u30fc\u3067\u3082\u30d7\u30ed\u30bb\u30b9\u304c\u843d\u3061\u306a\u3044</li> <li>[ERR-02] \u56f3\u5f62\u62bd\u51fa\u5931\u6557\u3067\u3082\u4ed6\u8981\u7d20\u3092\u7dad\u6301</li> <li>[ERR-03] \u30c1\u30e3\u30fc\u30c8\u62bd\u51fa\u5931\u6557\u6642\u306f Chart.error \u306b\u8a18\u9332</li> <li>[ERR-04] \u58ca\u308c\u305f\u53c2\u7167\u7bc4\u56f2\u306f\u4f8b\u5916\u306b\u305b\u305a null/error \u3092\u8a18\u9332</li> <li>[ERR-05] Excel \u30d5\u30a1\u30a4\u30eb\u3092\u958b\u3051\u306a\u3044\u5834\u5408\u306b\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u51fa\u3057\u7d42\u4e86</li> <li>[ERR-06] openpyxl <code>_print_area</code> \u8a2d\u5b9a\u3082\u62bd\u51fa\u6f0f\u308c\u3057\u306a\u3044</li> <li>[ERR-07] auto_print_areas \u304c\u7a7a\u306e\u5834\u5408 export_auto_page_breaks \u306f PrintAreaError\uff08ValueError \u4e92\u63db\uff09\u3092\u9001\u51fa</li> <li>[ERR-08] YAML/TOON \u4f9d\u5b58\u306a\u3057\u306e\u5834\u5408 MissingDependencyError \u3067\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u6848\u5185</li> <li>[ERR-09] \u66f8\u304d\u8fbc\u307f\u5931\u6557\u306f OutputError \u3092\u9001\u51fa\u3057\u3001\u4f8b\u5916\u306e cause \u306b\u4fdd\u6301</li> </ul>"},{"location":"agents/TEST_REQUIREMENTS/#7","title":"7. \u56de\u5e30\u8981\u4ef6","text":"<ul> <li>[REG-01] \u65e2\u5b58\u30d5\u30a3\u30af\u30b9\u30c1\u30e3\u306e JSON \u69cb\u9020\u304c\u904e\u53bb\u7248\u3068\u4e00\u81f4</li> <li>[REG-02] \u30e2\u30c7\u30eb\u306e\u30ad\u30fc\u524a\u9664\u30fb\u540d\u79f0\u5909\u66f4\u3092\u7834\u58ca\u7684\u5909\u66f4\u3068\u3057\u3066\u691c\u77e5</li> <li>[REG-03] \u65b9\u5411\u63a8\u5b9a\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\u5909\u66f4\u3092\u691c\u77e5</li> <li>[REG-04] ChartSeries \u53c2\u7167\u89e3\u6790\u304c\u904e\u53bb\u7d50\u679c\u3068\u4e00\u81f4</li> </ul>"},{"location":"agents/TEST_REQUIREMENTS/#8","title":"8. \u975e\u6a5f\u80fd\u8981\u4ef6","text":"<ul> <li>\u30d1\u30d5\u30a9\u30fc\u30de\u30f3\u30b9\u30fb\u30e1\u30e2\u30ea\u76ee\u6a19\u306f\u5225\u9014\u5b9a\u7fa9\u6642\u306b\u8ffd\u8a18</li> </ul>"},{"location":"agents/TEST_REQUIREMENTS/#9","title":"9. \u30e2\u30fc\u30c9/\u7d71\u5408\u8981\u4ef6","text":"<ul> <li>[MODE-01] CLI <code>--mode</code> / API <code>extract(..., mode=)</code> \u306f light/standard/verbose \u306e\u307f\uff08\u30c7\u30d5\u30a9\u30eb\u30c8 standard\uff09</li> <li>[MODE-02] light: \u30bb\u30eb+\u30c6\u30fc\u30d6\u30eb\u306e\u307f\u3001shapes/charts \u7a7a\u3001COM \u4e0d\u4f7f\u7528</li> <li>[MODE-03] standard: \u65e2\u5b58\u6319\u52d5\uff08\u30c6\u30ad\u30b9\u30c8\u4ed8\u304d\u56f3\u5f62\u30fb\u77e2\u5370\u3001COM \u6709\u52b9\u306a\u3089\u30c1\u30e3\u30fc\u30c8\uff09</li> <li>[MODE-04] verbose: \u5168\u56f3\u5f62\uff08\u30b5\u30a4\u30ba\u4ed8\u304d\uff09\u3068\u30c1\u30e3\u30fc\u30c8\uff08\u30b5\u30a4\u30ba\u4ed8\u304d\u3001\u7279\u5b9a\u9664\u5916\u3092\u9664\u304f\uff09</li> <li>[MODE-05] process_excel \u306f PDF/\u753b\u50cf\u30aa\u30d7\u30b7\u30e7\u30f3\u4f75\u7528\u3067 mode \u3092\u4f1d\u642c</li> <li>[MODE-06] standard \u3067\u65e2\u5b58\u30d5\u30a3\u30af\u30b9\u30c1\u30e3\u306b\u56de\u5e30\u3057\u4e0d\u8981\u56f3\u5f62\u304c\u5897\u3048\u306a\u3044</li> <li>[MODE-07] \u7121\u52b9 mode \u306f\u51e6\u7406\u958b\u59cb\u524d\u306b\u30a8\u30e9\u30fc</li> <li>[INT-01] COM \u30aa\u30fc\u30d7\u30f3\u5931\u6557\u6642\u306f\u30bb\u30eb+table_candidates \u3078\u306e\u30d5\u30a9\u30fc\u30eb\u30d0\u30c3\u30af</li> <li>[INT-02] COM \u30d5\u30a9\u30fc\u30eb\u30d0\u30c3\u30af\u6642\u3082 print_areas \u3092\u4fdd\u6301\u3059\u308b</li> <li>[IO-05] dict_without_empty_values \u3067 None/\u7a7a\u30ea\u30b9\u30c8/\u7a7a dict \u3092\u9664\u53bb\u3057\u30cd\u30b9\u30c8\u3092\u4fdd\u6301</li> <li>[RENDER-01] Excel+COM+pypdfium2 \u306e PDF/PNG \u30b9\u30e2\u30fc\u30af\u30c6\u30b9\u30c8\uff08\u74b0\u5883 ON/OFF\uff09</li> <li>[MODE-08] light \u3067\u306f openpyxl \u3067 print_areas \u62bd\u51fa\u3001\u30c7\u30d5\u30a9\u30eb\u30c8\u51fa\u529b\u306f\u9664\u5916\uff08auto \u5224\u5b9a\uff09</li> </ul>"},{"location":"agents/TEST_REQUIREMENTS/#26-pipeline","title":"2.6 Pipeline","text":"<ul> <li>[PIPE-01] buildpre_com_pipeline \u306f include* \u3068 mode \u306b\u5fdc\u3058\u3066\u5fc5\u8981\u306a\u30b9\u30c6\u30c3\u30d7\u306e\u307f\u542b\u3080</li> <li>[PIPE-02] build_cells_tables_workbook \u306f print_areas \u3092\u6761\u4ef6\u306b\u53cd\u6620\u3057 table_candidates \u3092\u4fdd\u6301</li> <li>[PIPE-03] resolve_extraction_inputs \u306f mode \u30c7\u30d5\u30a9\u30eb\u30c8\u3067 include_* \u3092\u89e3\u6c7a\u3059\u308b</li> <li>[PIPE-04] run_extraction_pipeline \u306f COM \u3092\u8a66\u884c\u3057\u3001\u5931\u6557\u6642\u306f cells+tables \u306b\u30d5\u30a9\u30fc\u30eb\u30d0\u30c3\u30af\u3059\u308b</li> <li>[PIPE-05] colors_map \u306f COM \u6210\u529f\u6642\u306b COM \u7d50\u679c\u3067\u4e0a\u66f8\u304d\u3057\u3001\u5931\u6557\u6642\u306e\u307f openpyxl \u3092\u4f7f\u3046</li> <li>[PIPE-06] print_areas \u306f openpyxl \u306e\u7d50\u679c\u3092\u4fdd\u6301\u3057\u3001COM \u306f\u4e0d\u8db3\u5206\u306e\u307f\u88dc\u5b8c\u3059\u308b</li> <li>[PIPE-07] PipelineState \u306f com_attempted/com_succeeded/fallback_reason \u3092\u4fdd\u6301\u3059\u308b</li> <li>[PIPE-08] include_auto_page_breaks=False \u306e\u5834\u5408\u306f auto_page_breaks \u306e COM \u30b9\u30c6\u30c3\u30d7\u3092\u542b\u3081\u306a\u3044</li> <li>[PIPE-09] include_merged_cells=False \u306e\u5834\u5408\u306f merged_cells \u306e\u62bd\u51fa\u30b9\u30c6\u30c3\u30d7\u3092\u542b\u3081\u306a\u3044</li> <li>[PIPE-MOD-01] build_workbook_data \u306f raw \u30b3\u30f3\u30c6\u30ca\u304b\u3089 WorkbookData/SheetData \u3092\u69cb\u7bc9\u3059\u308b</li> <li>[PIPE-MOD-02] collect_sheet_raw_data \u306f\u62bd\u51fa\u6e08\u307f\u30c7\u30fc\u30bf\u3092 raw \u30b3\u30f3\u30c6\u30ca\u306b\u307e\u3068\u3081\u308b</li> </ul>"},{"location":"agents/TEST_REQUIREMENTS/#27-backend","title":"2.7 Backend","text":"<ul> <li>[BE-01] OpenpyxlBackend \u306f include_links \u306e\u6709\u7121\u3067 cells \u62bd\u51fa\u7d4c\u8def\u3092\u5207\u308a\u66ff\u3048\u308b</li> <li>[BE-02] OpenpyxlBackend \u306f table \u691c\u51fa\u5931\u6557\u6642\u306b\u7a7a\u30ea\u30b9\u30c8\u3067\u7d99\u7d9a\u3059\u308b</li> <li>[BE-03] ComBackend \u306f colors_map \u62bd\u51fa\u5931\u6557\u6642\u306b None \u3092\u8fd4\u3059</li> <li>[BE-04] OpenpyxlBackend \u306f colors_map \u62bd\u51fa\u5931\u6557\u6642\u306b None \u3092\u8fd4\u3059</li> <li>[BE-05] ComBackend \u306f print_areas \u62bd\u51fa\u5931\u6557\u6642\u306b\u7a7a\u30de\u30c3\u30d7\u3067\u7d99\u7d9a\u3059\u308b</li> <li>[BE-06] OpenpyxlBackend \u306f merged_cells \u62bd\u51fa\u5931\u6557\u6642\u306b\u7a7a\u30de\u30c3\u30d7\u3067\u7d99\u7d9a\u3059\u308b</li> <li>[BE-07] ComBackend \u306e merged_cells \u672a\u5b9f\u88c5\u306f NotImplementedError \u3068\u3059\u308b</li> </ul>"},{"location":"agents/TEST_REQUIREMENTS/#28-ranges","title":"2.8 Ranges","text":"<ul> <li>[RNG-01] parse_range_zero_based \u306f \"Sheet1!A1:B2\" \u306e\u3088\u3046\u306a\u30b7\u30fc\u30c8\u4ed8\u304d\u7bc4\u56f2\u3092\u6b63\u898f\u5316\u3067\u304d\u308b</li> </ul>"},{"location":"agents/TEST_REQUIREMENTS/#29-table-detection","title":"2.9 Table Detection","text":"<ul> <li>[TBL-01] \u77e9\u5f62\u30de\u30fc\u30b8\u306f\u5305\u542b\u95a2\u4fc2\u306e\u77e9\u5f62\u3092\u7d71\u5408\u3057\u306a\u3044</li> <li>[TBL-02] \u5024\u884c\u5217\u304b\u3089\u30c6\u30fc\u30d6\u30eb\u5019\u88dc\u306e\u7bc4\u56f2\u6587\u5b57\u5217\u3092\u751f\u6210\u3067\u304d\u308b</li> </ul>"},{"location":"agents/TEST_REQUIREMENTS/#210-workbook","title":"2.10 Workbook","text":"<ul> <li>[WB-01] openpyxl_workbook \u306f\u4f8b\u5916\u306e\u6709\u7121\u306b\u95a2\u4fc2\u306a\u304f close \u3092\u547c\u3073\u51fa\u3059</li> <li>[WB-02] openpyxl_workbook \u306f\u65e2\u77e5\u306e openpyxl \u8b66\u544a\u3092\u6291\u5236\u3059\u308b\u30d5\u30a3\u30eb\u30bf\u3092\u8a2d\u5b9a\u3059\u308b</li> <li>[WB-03] _find_open_workbook \u306f fullname/resolve \u4f8b\u5916\u3092\u8a31\u5bb9\u3057 None \u3092\u8fd4\u3059</li> <li>[WB-04] _find_open_workbook \u306e\u5168\u4f53\u4f8b\u5916\u6642\u306f None \u3092\u8fd4\u3059</li> <li>[WB-05] xlwings_workbook \u306f\u65e2\u5b58\u30d6\u30c3\u30af\u304c\u898b\u3064\u304b\u308c\u3070 App \u3092\u8d77\u52d5\u3057\u306a\u3044</li> </ul>"},{"location":"agents/TEST_REQUIREMENTS/#211-logging","title":"2.11 Logging","text":"<ul> <li>[LOG-01] log_fallback \u306f\u7406\u7531\u30b3\u30fc\u30c9\u3092\u542b\u3080\u8b66\u544a\u30ed\u30b0\u3092\u51fa\u529b\u3059\u308b</li> </ul>"},{"location":"agents/TEST_REQUIREMENTS/#212-e2e","title":"2.12 \u7d71\u5408/E2E","text":"<ul> <li>[E2E-01] light \u62bd\u51fa\u2192serialize_workbook\u2192export_sheets \u306e\u4e00\u9023\u304c\u6210\u529f\u3059\u308b</li> <li>[E2E-02] Engine.process \u306f output_path=None \u306e\u3068\u304d stream \u3078 JSON \u3092\u51fa\u529b\u3067\u304d\u308b</li> </ul>"},{"location":"agents/TEST_REQUIREMENTS/#10-com","title":"10. COM \u30c6\u30b9\u30c8\u904b\u7528\uff08\u30ed\u30fc\u30ab\u30eb\u624b\u52d5\uff09","text":"<p>CI \u3067\u306f Excel COM \u3092\u5b9f\u884c\u3067\u304d\u306a\u3044\u305f\u3081\u3001COM \u30c6\u30b9\u30c8\u306f\u30ed\u30fc\u30ab\u30eb\u624b\u52d5\u3067\u5b9f\u884c\u3059\u308b\u3002 Codecov \u3067\u306f unit \u3068 com \u3092\u5206\u96e2\u3057\u3001com \u306f carryforward \u3067\u7dad\u6301\u3059\u308b\u3002</p>"},{"location":"agents/TEST_REQUIREMENTS/#101","title":"10.1 \u30ed\u30fc\u30ab\u30eb\u5b9f\u884c\u624b\u9806","text":"<ul> <li>unit\uff08CI \u76f8\u5f53\uff09: <code>task test-unit</code></li> <li>COM: <code>task test-com</code></li> </ul>"},{"location":"agents/TEST_REQUIREMENTS/#102-codecov","title":"10.2 Codecov \u624b\u52d5\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\uff08\u4efb\u610f\uff09","text":"<p>\u624b\u52d5\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u6642\u306f <code>CODECOV_TOKEN</code> \u3068 <code>CODECOV_SHA</code> \u3092\u8a2d\u5b9a\u3059\u308b\u3002</p> <ul> <li>unit \u9001\u4fe1: <code>codecov-cli upload-process -f coverage.xml -F unit -C %CODECOV_SHA% -t %CODECOV_TOKEN%</code></li> <li>COM \u9001\u4fe1: <code>codecov-cli upload-process -f coverage.xml -F com -C %CODECOV_SHA% -t %CODECOV_TOKEN%</code></li> </ul>"},{"location":"architecture/pipeline/","title":"Pipeline Architecture Overview","text":"<p>ExStruct converts Excel workbooks into semantic structured JSON using a three-layer design: Pipeline + Backend + Modeling.</p> <p>This design enables:</p> <ul> <li>Separation of Excel COM-dependent and non-dependent logic</li> <li>Future expansion to OpenXML/XML direct parsing</li> <li>Stable, reliable output for RAG/LLM use cases</li> </ul>"},{"location":"architecture/pipeline/#end-to-end-flow-high-level","title":"End-to-End Flow (High Level)","text":"<pre><code>sequenceDiagram\n    participant Client\n    participant Pipeline\n    participant OpenpyxlBackend\n    participant ComBackend\n    participant Modeling\n\n    Client-&gt;&gt;Pipeline: extract()\n    Pipeline-&gt;&gt;OpenpyxlBackend: pre_extract()\n    OpenpyxlBackend--&gt;&gt;Pipeline: cells / tables / print_areas\n\n    alt COM available\n        Pipeline-&gt;&gt;ComBackend: extract()\n        ComBackend--&gt;&gt;Pipeline: shapes / charts\n    else COM unavailable\n        Pipeline-&gt;&gt;Pipeline: log_fallback()\n    end\n\n    Pipeline-&gt;&gt;Modeling: integrate()\n    Modeling--&gt;&gt;Pipeline: WorkbookData\n    Pipeline--&gt;&gt;Client: structured output\n</code></pre> <p>Processing proceeds in this order:</p> <ol> <li>Pipeline builds the execution plan</li> <li>Openpyxl Backend performs pre-analysis (cells, tables, print areas)</li> <li>COM Backend extracts rich data when available (shapes, charts)</li> <li>Modeling integrates results into WorkbookData / SheetData</li> <li>Output is generated in the requested format (JSON / YAML / TOON)</li> </ol>"},{"location":"architecture/pipeline/#pipeline-responsibilities","title":"Pipeline Responsibilities","text":"<p>The Pipeline is the control tower:</p> <ul> <li>Determines extraction order</li> <li>Selects backends</li> <li>Controls fallback paths</li> <li>Manages intermediate artifacts</li> </ul> <p>The Pipeline is designed to never read Excel contents directly.</p>"},{"location":"architecture/pipeline/#backend-responsibilities-swap-points","title":"Backend Responsibilities (Swap Points)","text":"<p>Backends define how Excel is read:</p> Backend Responsibilities OpenpyxlBackend Cells / tables / print areas / colors map ComBackend Shapes / arrows / charts / SmartArt (TBD) <p>This abstraction enables:</p> <ul> <li>XML direct parsing backend</li> <li>LibreOffice backend</li> <li>Remote Excel service backend</li> </ul> <p>With no Pipeline changes required.</p>"},{"location":"architecture/pipeline/#fallback-design","title":"Fallback Design","text":"<p>When COM is unavailable:</p> <ul> <li>Do not crash on exceptions</li> <li>Reuse Openpyxl results as much as possible</li> <li>Log the fallback reason explicitly</li> </ul> <p>This is a deliberate design for batch processing, CI, and automation.</p>"},{"location":"architecture/pipeline/#modeling-layer-responsibilities","title":"Modeling Layer Responsibilities","text":"<p>Modeling:</p> <ul> <li>Integrates results from multiple backends</li> <li>Produces normalized WorkbookData / SheetData</li> <li>Remains output-format agnostic</li> </ul> <p>The semantic structure model for RAG/LLM use is centralized here.</p>"},{"location":"architecture/pipeline/#why-this-design","title":"Why This Design?","text":"<ul> <li>Excel has separate worlds: cells, shapes, charts</li> <li>COM is powerful but fragile</li> <li>LLMs require stable, structured data</li> </ul> <p>Therefore, pipeline separation is the most practical approach.</p>"},{"location":"contributors/architecture/","title":"Contributor Guide - Internal Architecture","text":""},{"location":"contributors/architecture/#audience","title":"Audience","text":"<p>This page is intended for contributors who:</p> <ul> <li>want to extend ExStruct internals</li> <li>want to add new extraction targets (shapes, SmartArt, comments, etc.)</li> <li>want to extend backends (Openpyxl / COM / future XML)</li> <li>want to submit a PR but are unsure where to make changes</li> </ul>"},{"location":"contributors/architecture/#directory-layout-core","title":"Directory Layout (core)","text":"<pre><code>src/exstruct/core/\n\u251c\u2500\u2500 pipeline.py        # Orchestrates the overall flow\n\u251c\u2500\u2500 backend.py         # Backend abstraction (Protocol)\n\u251c\u2500\u2500 openpyxl_backend.py\n\u251c\u2500\u2500 com_backend.py\n\u251c\u2500\u2500 modeling.py        # Final data integration\n\u251c\u2500\u2500 workbook.py        # Workbook lifecycle management\n\u251c\u2500\u2500 cells.py           # Cell/table analysis (mainly openpyxl)\n\u2514\u2500\u2500 utils.py           # Shared utilities\n</code></pre>"},{"location":"contributors/architecture/#key-design-rules-must-read","title":"Key Design Rules (Must Read)","text":""},{"location":"contributors/architecture/#1-the-pipeline-only-knows-the-order","title":"1. The Pipeline only knows the order","text":"<ul> <li>Do not place Excel parsing logic in Pipeline</li> <li>Pipeline is responsible for:</li> <li>Backend call order</li> <li>fallback decisions</li> <li>artifact management</li> <li>passing to Modeling</li> </ul> <p>Rule of thumb</p> <p>\"Does this code read Excel contents directly?\" If yes, it does not belong in Pipeline.</p>"},{"location":"contributors/architecture/#2-backend-is-extraction-only","title":"2. Backend is extraction-only","text":"<p>Backends are for pure extraction:</p> <ul> <li>Excel -&gt; raw data</li> <li>no interpretation, no integration</li> <li>avoid side effects whenever possible</li> </ul>"},{"location":"contributors/architecture/#allowed-in-backend","title":"Allowed in Backend","text":"<ul> <li>reading cell values</li> <li>reading shape positions</li> <li>calling COM APIs</li> <li>raising exceptions</li> </ul>"},{"location":"contributors/architecture/#not-allowed-in-backend","title":"Not allowed in Backend","text":"<ul> <li>building WorkbookData / SheetData</li> <li>output-format concerns</li> <li>fallback logging (Pipeline handles it)</li> </ul>"},{"location":"contributors/architecture/#3-modeling-is-the-single-integration-point","title":"3. Modeling is the single integration point","text":"<p>Only Modeling merges backend results into one semantic structure.</p> <ul> <li>combine Openpyxl + COM results</li> <li>normalize coordinates, directions, and types</li> <li>fill missing data</li> </ul> <p>The only layer that should know the final JSON/YAML/TOON shape is Modeling.</p>"},{"location":"contributors/architecture/#common-extension-patterns","title":"Common Extension Patterns","text":""},{"location":"contributors/architecture/#case-1-add-a-new-extraction-target-eg-comments","title":"Case 1: Add a new extraction target (e.g., comments)","text":""},{"location":"contributors/architecture/#steps","title":"Steps","text":"<ol> <li>Add an extraction method to Backend</li> </ol> <p><code>python    class Backend(Protocol):        def extract_comments(self, ...): ...</code></p> <ol> <li>Implement in <code>OpenpyxlBackend</code> / <code>ComBackend</code></li> <li> <p>Either side can be optional; use <code>NotImplementedError</code> when missing</p> </li> <li> <p>Add calls in <code>pipeline.py</code></p> </li> <li> <p>Make it explicit whether it participates in fallback</p> </li> <li> <p>Integrate into WorkbookData in <code>modeling.py</code></p> </li> <li> <p>Add tests</p> </li> </ol>"},{"location":"contributors/architecture/#case-2-add-a-new-backend-eg-xml-backend","title":"Case 2: Add a new Backend (e.g., XML backend)","text":""},{"location":"contributors/architecture/#steps_1","title":"Steps","text":"<ol> <li>Implement the Protocol in <code>backend.py</code></li> </ol> <p><code>python    class XmlBackend:        def extract_cells(...)        def extract_shapes(...)</code></p> <ol> <li>Add backend selection in Pipeline</li> <li> <p>Keep changes to existing backends minimal</p> </li> <li> <p>Keep Modeling unchanged if possible</p> </li> </ol>"},{"location":"contributors/architecture/#case-3-change-output-structure","title":"Case 3: Change output structure","text":"<ul> <li>This is the most fragile type of change</li> </ul>"},{"location":"contributors/architecture/#principles","title":"Principles","text":"<ul> <li>Limit changes to <code>modeling.py</code> and Pydantic models</li> <li>Do not change backends</li> <li>Do not modify Pipeline</li> </ul>"},{"location":"contributors/architecture/#fallback-rules","title":"Fallback Rules","text":"<ul> <li>COM being unavailable is normal</li> <li>fallback is not an exception</li> <li>always provide a <code>FallbackReason</code></li> </ul> <pre><code>log_fallback(\n    reason=FallbackReason.COM_UNAVAILABLE,\n    message=\"COM backend not available\"\n)\n</code></pre>"},{"location":"contributors/architecture/#testing-guidelines-important","title":"Testing Guidelines (Important)","text":""},{"location":"contributors/architecture/#expected-test-granularity","title":"Expected test granularity","text":"Layer Test focus Backend extraction correctness Pipeline fallback / branching Modeling integration logic"},{"location":"contributors/architecture/#anti-patterns","title":"Anti-patterns","text":"<ul> <li>Fragile tests that depend heavily on a real Excel instance</li> <li>Giant tests that combine Backend and Modeling</li> </ul>"},{"location":"contributors/architecture/#pre-pr-checklist","title":"Pre-PR Checklist","text":"<ul> <li>[ ] No Excel parsing logic in Pipeline</li> <li>[ ] No interpretation logic in Backend</li> <li>[ ] Modeling is the single source of final structure</li> <li>[ ] Fallback reasons are explicit</li> <li>[ ] Tests are added</li> <li>[ ] Docs updated if public API changes</li> </ul>"},{"location":"contributors/architecture/#common-anti-patterns","title":"Common Anti-Patterns","text":"<ul> <li>Creating WorkbookData inside Backend</li> <li>Calling openpyxl / xlwings directly in Pipeline</li> <li>\"Just process here\" ad-hoc logic</li> <li>Catch-all exceptions without fallback reason</li> </ul>"},{"location":"contributors/architecture/#design-philosophy-recap","title":"Design Philosophy (Recap)","text":"<ul> <li>Excel is fragile</li> <li>COM is powerful but unstable</li> <li>LLM/RAG requires stable structure first</li> </ul> <p>Therefore:</p> <p>\"Separate responsibilities and localize failure points.\"</p>"},{"location":"generated/models/","title":"Data Models (generated)","text":""},{"location":"generated/models/#data-models","title":"Data Models","text":""},{"location":"generated/models/#arrow","title":"Arrow","text":"<p>Connector shape metadata.</p> Field Type Required Default Description <code>begin_arrow_style</code> <code>int \\| None</code> No None Arrow style enum for the start of a connector. <code>begin_id</code> <code>int \\| None</code> No None Shape id at the start of a connector (ConnectorFormat.BeginConnectedShape). <code>direction</code> <code>Literal['E', 'SE', 'S', 'SW', 'W', 'NW', 'N', 'NE'] \\| None</code> No None Connector direction (compass heading). <code>end_arrow_style</code> <code>int \\| None</code> No None Arrow style enum for the end of a connector. <code>end_id</code> <code>int \\| None</code> No None Shape id at the end of a connector (ConnectorFormat.EndConnectedShape). <code>h</code> <code>int \\| None</code> No None Shape height (None if unknown). <code>id</code> <code>int \\| None</code> No None Sequential shape id within the sheet (if applicable). <code>kind</code> <code>Literal['arrow']</code> No 'arrow' Shape kind. <code>l</code> <code>int</code> Yes - Left offset (Excel units). <code>rotation</code> <code>float \\| None</code> No None Rotation angle in degrees. <code>t</code> <code>int</code> Yes - Top offset (Excel units). <code>text</code> <code>str</code> Yes - Visible text content of the shape. <code>w</code> <code>int \\| None</code> No None Shape width (None if unknown)."},{"location":"generated/models/#baseshape","title":"BaseShape","text":"<p>Common shape metadata (position, size, text, and styling).</p> Field Type Required Default Description <code>h</code> <code>int \\| None</code> No None Shape height (None if unknown). <code>id</code> <code>int \\| None</code> No None Sequential shape id within the sheet (if applicable). <code>l</code> <code>int</code> Yes - Left offset (Excel units). <code>rotation</code> <code>float \\| None</code> No None Rotation angle in degrees. <code>t</code> <code>int</code> Yes - Top offset (Excel units). <code>text</code> <code>str</code> Yes - Visible text content of the shape. <code>w</code> <code>int \\| None</code> No None Shape width (None if unknown)."},{"location":"generated/models/#cellrow","title":"CellRow","text":"<p>A single row of cells with optional hyperlinks.</p> Field Type Required Default Description <code>c</code> <code>dict[str, int \\| float \\| str]</code> Yes - Column index (string) to cell value map. <code>links</code> <code>dict[str, str] \\| None</code> No None Optional hyperlinks per column index. <code>r</code> <code>int</code> Yes - Row index (1-based)."},{"location":"generated/models/#chart","title":"Chart","text":"<p>Chart metadata including series and layout.</p> Field Type Required Default Description <code>chart_type</code> <code>str</code> Yes - Chart type (e.g., Column, Line). <code>error</code> <code>str \\| None</code> No None Extraction error detail if any. <code>h</code> <code>int \\| None</code> No None Chart height (None if unknown). <code>l</code> <code>int</code> Yes - Left offset (Excel units). <code>name</code> <code>str</code> Yes - Chart name. <code>series</code> <code>list[ChartSeries]</code> Yes - Series included in the chart. <code>t</code> <code>int</code> Yes - Top offset (Excel units). <code>title</code> <code>str \\| None</code> No None Chart title. <code>w</code> <code>int \\| None</code> No None Chart width (None if unknown). <code>y_axis_range</code> <code>list[float]</code> No Y-axis range [min, max] when available. <code>y_axis_title</code> <code>str</code> Yes - Y-axis title."},{"location":"generated/models/#chartseries","title":"ChartSeries","text":"<p>Series metadata for a chart.</p> Field Type Required Default Description <code>name</code> <code>str</code> Yes - Series display name. <code>name_range</code> <code>str \\| None</code> No None Range reference for the series name. <code>x_range</code> <code>str \\| None</code> No None Range reference for X axis values. <code>y_range</code> <code>str \\| None</code> No None Range reference for Y axis values."},{"location":"generated/models/#colorsoptions","title":"ColorsOptions","text":"<p>Color extraction options.</p> <p>Examples:     &gt;&gt;&gt; ColorsOptions(     ...     include_default_background=False,     ...     ignore_colors=[\"#FFFFFF\", \"AD3815\", \"theme:1:0.2\", \"indexed:64\", \"auto\"],     ... )</p> Field Type Required Default Description <code>ignore_colors</code> <code>list[str]</code> No List of color keys to ignore. <code>include_default_background</code> <code>bool</code> No False Include default (white) backgrounds."},{"location":"generated/models/#destinationoptions","title":"DestinationOptions","text":"<p>Destinations for optional side outputs.</p> Field Type Required Default Description <code>auto_page_breaks_dir</code> <code>str \\| Path \\| None</code> No None Directory to write auto page-break files. <code>print_areas_dir</code> <code>str \\| Path \\| None</code> No None Directory to write per-print-area files. <code>sheets_dir</code> <code>str \\| Path \\| None</code> No None Directory to write per-sheet files. <code>stream</code> <code>TextIO \\| None</code> No None Stream override for primary output (stdout/file)."},{"location":"generated/models/#filteroptions","title":"FilterOptions","text":"<p>Include/exclude filters for output.</p> Field Type Required Default Description <code>include_auto_print_areas</code> <code>bool</code> No False Include COM-computed auto page-break areas. <code>include_chart_size</code> <code>bool \\| None</code> No None Include chart size; None -&gt; auto (verbose=True, others=False). <code>include_charts</code> <code>bool</code> No True Include charts. <code>include_merged_cells</code> <code>bool</code> No True Include merged cell ranges. <code>include_print_areas</code> <code>bool \\| None</code> No None Include print areas; None -&gt; auto (light=False, others=True). <code>include_rows</code> <code>bool</code> No True Include cell rows. <code>include_shape_size</code> <code>bool \\| None</code> No None Include shape size; None -&gt; auto (verbose=True, others=False). <code>include_shapes</code> <code>bool</code> No True Include shapes. <code>include_tables</code> <code>bool</code> No True Include table candidate ranges."},{"location":"generated/models/#formatoptions","title":"FormatOptions","text":"<p>Formatting options for serialization.</p> Field Type Required Default Description <code>fmt</code> <code>Literal['json', 'yaml', 'yml', 'toon']</code> No 'json' Serialization format. <code>indent</code> <code>int \\| None</code> No None Indent width for JSON (defaults to 2 when pretty is True). <code>pretty</code> <code>bool</code> No False Pretty-print JSON output."},{"location":"generated/models/#mergedcells","title":"MergedCells","text":"<p>Compressed merged cell ranges using schema + items.</p> Field Type Required Default Description <code>items</code> <code>list[tuple[int, int, int, int, str]]</code> No Merged cell items as (r1, c1, r2, c2, v) tuples where rows are 1-based and columns are 0-based. <code>schema_</code> <code>list[Literal['r1', 'c1', 'r2', 'c2', 'v']]</code> No Ordered field names for each item."},{"location":"generated/models/#outputoptions","title":"OutputOptions","text":"<p>Output-time options for ExStructEngine.</p> <ul> <li>format: serialization format/indent.</li> <li>filters: include/exclude flags (rows/shapes/charts/tables/print_areas, size flags).</li> <li>destinations: side outputs (per-sheet, per-print-area, stream override).</li> </ul> Field Type Required Default Description <code>destinations</code> <code>DestinationOptions</code> No Side output destinations. <code>filters</code> <code>FilterOptions</code> No Include/exclude flags. <code>format</code> <code>FormatOptions</code> No Formatting options."},{"location":"generated/models/#printarea","title":"PrintArea","text":"<p>Cell coordinate bounds for a print area.</p> Field Type Required Default Description <code>c1</code> <code>int</code> Yes - Start column (0-based). <code>c2</code> <code>int</code> Yes - End column (0-based, inclusive). <code>r1</code> <code>int</code> Yes - Start row (1-based). <code>r2</code> <code>int</code> Yes - End row (1-based, inclusive)."},{"location":"generated/models/#printareaview","title":"PrintAreaView","text":"<p>Slice of a sheet restricted to a print area (manual or auto).</p> Field Type Required Default Description <code>area</code> <code>PrintArea</code> Yes - Print area bounds. <code>book_name</code> <code>str</code> Yes - Workbook name owning the area. <code>charts</code> <code>list[Chart]</code> No Charts overlapping the area. <code>rows</code> <code>list[CellRow]</code> No Rows within the area bounds. <code>shapes</code> <code>list[Shape \\| Arrow \\| SmartArt]</code> No Shapes overlapping the area. <code>sheet_name</code> <code>str</code> Yes - Sheet name owning the area. <code>table_candidates</code> <code>list[str]</code> No Table candidates intersecting the area."},{"location":"generated/models/#shape","title":"Shape","text":"<p>Normal shape metadata.</p> Field Type Required Default Description <code>h</code> <code>int \\| None</code> No None Shape height (None if unknown). <code>id</code> <code>int \\| None</code> No None Sequential shape id within the sheet (if applicable). <code>kind</code> <code>Literal['shape']</code> No 'shape' Shape kind. <code>l</code> <code>int</code> Yes - Left offset (Excel units). <code>rotation</code> <code>float \\| None</code> No None Rotation angle in degrees. <code>t</code> <code>int</code> Yes - Top offset (Excel units). <code>text</code> <code>str</code> Yes - Visible text content of the shape. <code>type</code> <code>str \\| None</code> No None Excel shape type name. <code>w</code> <code>int \\| None</code> No None Shape width (None if unknown)."},{"location":"generated/models/#sheetdata","title":"SheetData","text":"<p>Structured data for a single sheet.</p> Field Type Required Default Description <code>auto_print_areas</code> <code>list[PrintArea]</code> No COM-computed auto page-break areas. <code>charts</code> <code>list[Chart]</code> No Charts detected on the sheet. <code>colors_map</code> <code>dict[str, list[tuple[int, int]]]</code> No Mapping of hex color codes to lists of (row, column) tuples where row is 1-based and column is 0-based. <code>formulas_map</code> <code>dict[str, list[tuple[int, int]]]</code> No Mapping of formula strings to lists of (row, column) tuples where row is 1-based and column is 0-based. <code>merged_cells</code> <code>MergedCells \\| None</code> No None Merged cell ranges on the sheet. <code>print_areas</code> <code>list[PrintArea]</code> No User-defined print areas. <code>rows</code> <code>list[CellRow]</code> No Extracted rows with cell values and links. <code>shapes</code> <code>list[Shape \\| Arrow \\| SmartArt]</code> No Shapes detected on the sheet. <code>table_candidates</code> <code>list[str]</code> No Cell ranges likely representing tables."},{"location":"generated/models/#smartart","title":"SmartArt","text":"<p>SmartArt shape metadata with nested nodes.</p> Field Type Required Default Description <code>h</code> <code>int \\| None</code> No None Shape height (None if unknown). <code>id</code> <code>int \\| None</code> No None Sequential shape id within the sheet (if applicable). <code>kind</code> <code>Literal['smartart']</code> No 'smartart' Shape kind. <code>l</code> <code>int</code> Yes - Left offset (Excel units). <code>layout</code> <code>str</code> Yes - SmartArt layout name. <code>nodes</code> <code>list[SmartArtNode]</code> No Root nodes of SmartArt tree. <code>rotation</code> <code>float \\| None</code> No None Rotation angle in degrees. <code>t</code> <code>int</code> Yes - Top offset (Excel units). <code>text</code> <code>str</code> Yes - Visible text content of the shape. <code>w</code> <code>int \\| None</code> No None Shape width (None if unknown)."},{"location":"generated/models/#smartartnode","title":"SmartArtNode","text":"<p>Node of SmartArt hierarchy.</p> Field Type Required Default Description <code>kids</code> <code>list[SmartArtNode]</code> No Child nodes. <code>text</code> <code>str</code> Yes - Visible text for the node."},{"location":"generated/models/#workbookdata","title":"WorkbookData","text":"<p>Workbook-level container with per-sheet data.</p> Field Type Required Default Description <code>book_name</code> <code>str</code> Yes - Workbook file name (no path). <code>sheets</code> <code>dict[str, SheetData]</code> Yes - Mapping of sheet name to SheetData."},{"location":"release-notes/v0.2.60/","title":"v0.2.60 Release Notes","text":"<p>This is the first official release tag for ExStruct. It provides the core capabilities for extracting structured data from Excel workbooks and supports both the Python API and the CLI.</p>"},{"location":"release-notes/v0.2.60/#highlights","title":"Highlights","text":"<ul> <li>Excel structured data: extract cells, table candidates, shapes, charts, print   areas, auto page-break areas, and hyperlinks into JSON by default.</li> <li>Output modes: use <code>light</code> for non-COM environments (cells, tables, print   areas) and <code>standard</code>/<code>verbose</code> when Excel COM is available for richer   extraction including shapes, charts, sizes, and hyperlinks.</li> <li>Flexible formats: JSON by default, with optional YAML and TOON output.   <code>--pretty</code> produces readable JSON for inspection.</li> <li>CLI rendering: when Excel is available, the CLI can export PDF and per-sheet   PNG images.</li> <li>Graceful fallback: when Excel COM is unavailable, extraction falls back to   cells and table candidates without crashing.</li> </ul>"},{"location":"release-notes/v0.2.60/#compatibility-and-install","title":"Compatibility and Install","text":"<ul> <li>Install via <code>pip install exstruct</code>.</li> <li>Optional extras: <code>exstruct[yaml]</code>, <code>exstruct[toon]</code>, <code>exstruct[render]</code>, or   <code>exstruct[yaml,toon,render]</code>.</li> <li>Full extraction (shapes/charts) targets Windows + Excel via xlwings/COM.   Use <code>mode=light</code> on other platforms.</li> </ul>"},{"location":"release-notes/v0.2.60/#other","title":"Other","text":"<ul> <li>No breaking changes in this release.</li> <li>Issues and feedback are welcome.</li> </ul>"},{"location":"release-notes/v0.2.61/","title":"v0.2.61 Release Notes","text":"<p>This release standardizes error handling across extraction, serialization, and rendering, and documents coverage expectations for tests.</p>"},{"location":"release-notes/v0.2.61/#highlights","title":"Highlights","text":"<ul> <li>Exception hierarchy: added <code>ExstructError</code> plus domain-specific errors   (<code>ConfigError</code>, <code>ExtractionError</code>, <code>SerializationError</code>,   <code>MissingDependencyError</code>, <code>RenderError</code>, <code>OutputError</code>, <code>PrintAreaError</code>) for   consistent error handling. See <code>src/exstruct/errors.py</code>.</li> <li>Clear dependency guidance: unsupported formats raise <code>SerializationError</code>, and   missing optional dependencies raise <code>MissingDependencyError</code> with installation   guidance. See <code>src/exstruct/io/__init__.py</code> and <code>src/exstruct/render/__init__.py</code>.</li> <li>Auto page-break behavior: <code>export_auto_page_breaks</code> now raises   <code>PrintAreaError</code> when no auto page-break areas are present. See   <code>src/exstruct/__init__.py</code>.</li> <li>Test requirements spec: published v0.2 coverage expectations for extraction,   output, CLI, and error handling. See <code>docs/agents/TEST_REQUIREMENTS.md</code>.</li> </ul>"},{"location":"release-notes/v0.2.61/#compatibility-notes","title":"Compatibility Notes","text":"<ul> <li><code>PrintAreaError</code> inherits <code>ValueError</code>, so existing handlers still work, but   using the new type makes intent explicit.</li> <li>If your code calls <code>export_auto_page_breaks</code>, handle <code>PrintAreaError</code> or verify   that <code>auto_print_areas</code> is populated before exporting.</li> </ul>"},{"location":"release-notes/v0.2.70/","title":"v0.2.70 \u30ea\u30ea\u30fc\u30b9\u30ce\u30fc\u30c8","text":"<p>\u30bf\u30b0 v0.2.70 \u3067\u306f\u3001\u30d5\u30a1\u30a4\u30eb\u30d1\u30b9\u6307\u5b9a\u306e\u67d4\u8edf\u6027\u3092\u9ad8\u3081\u3064\u3064\u3001\u30a8\u30af\u30b9\u30dd\u30fc\u30c8\u6642\u306e\u6a19\u6e96\u51fa\u529b\u306e\u6271\u3044\u3092\u898b\u76f4\u3057\u307e\u3057\u305f\u3002</p>"},{"location":"release-notes/v0.2.70/#_1","title":"\u30cf\u30a4\u30e9\u30a4\u30c8","text":"<ul> <li>\u30d5\u30a1\u30a4\u30eb\u30d1\u30b9\u306e str \u30b5\u30dd\u30fc\u30c8\u3092\u62e1\u5145: \u30a8\u30f3\u30b8\u30f3\u306e\u5165\u51fa\u529b\u3084 per-sheet/per-area \u51fa\u529b\u5148\u306b <code>str</code> \u3092\u76f4\u63a5\u6e21\u305b\u308b\u3088\u3046\u578b\u5b9a\u7fa9\u3068\u6b63\u898f\u5316\u3092\u8ffd\u52a0\u3057\u3001<code>process</code> \u3067\u3082 PDF/\u753b\u50cf\u751f\u6210\u3092\u542b\u3081 <code>Path</code> \u3078\u7d71\u4e00\u3057\u3066\u51e6\u7406\u3057\u307e\u3059\u3002\u3010F:src/exstruct/engine.py\u2020L96-L240\u3011\u3010F:src/exstruct/engine.py\u2020L592-L643\u3011\u3010F:src/exstruct/core/integrate.py\u2020L290-L375\u3011\u3010F:tests/test_engine.py\u2020L164-L243\u3011</li> <li>\u526f\u6b21\u51fa\u529b\u306e\u307f\u306e export \u5b9f\u884c\u6642\u306b\u6a19\u6e96\u51fa\u529b\u3078\u66f8\u304d\u51fa\u3055\u306a\u3044\u6319\u52d5\u306b\u5909\u66f4: <code>output_path</code> \u3092\u6e21\u3055\u305a <code>sheets_dir</code>/<code>print_areas_dir</code>/<code>auto_page_breaks_dir</code> \u3060\u3051\u3092\u8a2d\u5b9a\u3057\u305f\u5834\u5408\u3001\u3053\u308c\u3089\u306e\u526f\u6b21\u51fa\u529b\u306b\u5c02\u5ff5\u3057\u3001\u6a19\u6e96\u51fa\u529b\u3078\u306f\u66f8\u304d\u8fbc\u307e\u306a\u304f\u306a\u308a\u307e\u3057\u305f\u3002\u3010F:src/exstruct/engine.py\u2020L500-L571\u3011</li> </ul>"},{"location":"release-notes/v0.2.70/#_2","title":"\u4e92\u63db\u6027\u3068\u79fb\u884c","text":"<ul> <li>\u65e2\u5b58\u306e <code>Path</code> \u6307\u5b9a\u306f\u305d\u306e\u307e\u307e\u5229\u7528\u3067\u304d\u307e\u3059\u3002<code>str</code> \u3092\u6e21\u3059\u5834\u5408\u3067\u3082\u5185\u90e8\u3067 <code>Path</code> \u306b\u6b63\u898f\u5316\u3055\u308c\u308b\u305f\u3081\u3001CLI/\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u53cc\u65b9\u3067\u540c\u3058\u6319\u52d5\u306b\u306a\u308a\u307e\u3059\u3002\u3010F:src/exstruct/engine.py\u2020L96-L240\u3011\u3010F:src/exstruct/engine.py\u2020L592-L643\u3011\u3010F:src/exstruct/core/integrate.py\u2020L290-L375\u3011</li> <li>\u526f\u6b21\u51fa\u529b\u306e\u307f\u3092\u5f97\u305f\u3044\u5834\u5408\u306f <code>output_path=None</code> \u306e\u307e\u307e\u3067\u554f\u984c\u3042\u308a\u307e\u305b\u3093\u3002\u6a19\u6e96\u51fa\u529b\u306b\u3082\u6d41\u3057\u305f\u3044\u5834\u5408\u306f\u3053\u308c\u307e\u3067\u901a\u308a <code>output_path</code> \u304b <code>stream</code> \u3092\u660e\u793a\u3057\u3066\u304f\u3060\u3055\u3044\u3002\u3010F:src/exstruct/engine.py\u2020L500-L571\u3011</li> </ul>"},{"location":"release-notes/v0.2.71/","title":"v0.2.71 Release Notes","text":"<p>This release adds CLI support for auto page-break exports with environment gating, plus documentation updates.</p>"},{"location":"release-notes/v0.2.71/#highlights","title":"Highlights","text":"<ul> <li>CLI auto page-break export: new <code>--auto-page-breaks-dir</code> option writes per   auto page-break view files when Excel COM is available.</li> <li>Environment gating: the CLI now detects COM availability and only registers   COM-specific flags when Excel is usable, preventing unsupported options on   non-COM platforms.</li> <li>Parser tests: added coverage to ensure the option is visible only when COM is   available.</li> <li>Documentation updates: CLI usage and API docs now describe the COM-gated   option.</li> </ul>"},{"location":"release-notes/v0.2.71/#compatibility-notes","title":"Compatibility Notes","text":"<ul> <li>No breaking API changes.</li> <li>On non-COM environments, the <code>--auto-page-breaks-dir</code> flag is hidden and   cannot be used.</li> </ul>"},{"location":"release-notes/v0.2.80/","title":"v0.2.80 Release Notes","text":"<p>This release improves shape extraction to better trace flowchart connections by assigning per-sheet shape ids and linking connector endpoints.</p>"},{"location":"release-notes/v0.2.80/#highlights","title":"Highlights","text":"<ul> <li>Shape ids: non-connector shapes now receive sequential <code>id</code> values per sheet   to enable stable references.</li> <li>Connector linking: connector shapes capture <code>begin_id</code> and <code>end_id</code> resolved   from connected shapes (via COM ConnectorFormat).</li> <li>Connector metadata: arrow styles, direction, and rotation are recorded for   arrow/line connectors to enrich flow analysis.</li> <li>Schema updates: JSON schemas and the Shape model include the new connector   fields.</li> <li>Samples and tests: added connector sample artifacts and expanded tests for   connector extraction.</li> </ul>"},{"location":"release-notes/v0.2.80/#compatibility-notes","title":"Compatibility Notes","text":"<ul> <li>Non-COM environments continue to omit connector details as before.</li> <li>Shape extraction now includes additional fields in the default output; existing   fields and semantics remain unchanged.</li> </ul>"},{"location":"release-notes/v0.2.80/#thanks","title":"Thanks","text":"<ul> <li>@moonmile for improving flowchart connectivity tracking (#15)</li> </ul>"},{"location":"release-notes/v0.2.90/","title":"v0.2.90 Release Notes","text":"<p>This release adds cell background color extraction via <code>colors_map</code>, including conditional formatting support when running with Excel COM.</p>"},{"location":"release-notes/v0.2.90/#highlights","title":"Highlights","text":"<ul> <li><code>colors_map</code>: SheetData now includes background color locations keyed by hex   color strings.</li> <li>COM display colors: in COM environments, extraction reads   <code>DisplayFormat.Interior</code> to capture conditional formatting colors.</li> <li>ColorsOptions: configure color extraction with <code>include_default_background</code>   and <code>ignore_colors</code> (normalized hex keys).</li> <li>Verbose mode: <code>mode=\"verbose\"</code> now enables <code>colors_map</code> extraction by default.</li> <li>Tests: added coverage for default background exclusion and ignore lists.</li> </ul>"},{"location":"release-notes/v0.2.90/#compatibility-notes","title":"Compatibility Notes","text":"<ul> <li>Non-COM environments still extract colors via openpyxl, without conditional   formatting evaluation.</li> <li><code>ignore_colors</code> is applied during extraction, reducing payload size early.</li> </ul>"},{"location":"release-notes/v0.3.0/","title":"v0.3.0 Release Notes","text":"<p>This release delivers a large internal refactor (PR #23) to improve maintainability and prepare the codebase for future features. There are no intended user-facing API changes in this release.</p>"},{"location":"release-notes/v0.3.0/#highlights","title":"Highlights","text":"<ul> <li>Internal processing pipeline refactored for clearer responsibilities and   easier extension.</li> <li>Code organization and structure improved to support ongoing maintenance.</li> </ul>"},{"location":"release-notes/v0.3.0/#compatibility-notes","title":"Compatibility Notes","text":"<ul> <li>No expected behavioral or API changes compared to v0.2.90.</li> </ul>"},{"location":"release-notes/v0.3.1/","title":"v0.3.1 Release Notes","text":"<p>This release adds SmartArt extraction and updates shape modeling to better separate standard shapes, arrows, and SmartArt structures.</p>"},{"location":"release-notes/v0.3.1/#highlights","title":"Highlights","text":"<ul> <li>SmartArt extraction via Excel COM, including layout name and nested nodes.</li> <li>Shape modeling split into <code>Shape</code>, <code>Arrow</code>, and <code>SmartArt</code> for clearer semantics.</li> <li>SmartArt node payload optimized for compact output (<code>layout</code>, <code>nodes</code>, <code>kids</code>).</li> </ul>"},{"location":"release-notes/v0.3.1/#compatibility-notes","title":"Compatibility Notes","text":"<ul> <li><code>Shape.type</code> now exists only on <code>Shape</code>; it is omitted for <code>Arrow</code> and <code>SmartArt</code>.</li> <li>SmartArt output uses <code>layout</code> and <code>nodes</code> with <code>kids</code>; previous fields like   <code>layout_name</code>, <code>roots</code>, or <code>children</code> are no longer present.</li> </ul>"},{"location":"release-notes/v0.3.2/","title":"v0.3.2 Release Notes","text":"<p>This release adds merged cell range extraction and output controls, with pipeline integration and tests to cover the new feature.</p>"},{"location":"release-notes/v0.3.2/#highlights","title":"Highlights","text":"<ul> <li><code>MergedCells</code> format and <code>SheetData.merged_cells</code> added to output.</li> <li>Merged cell ranges extracted via openpyxl in standard/verbose modes.</li> <li>Output can exclude merged cells via <code>OutputOptions.filters.include_merged_cells</code>.</li> <li>Pipeline/Backend/Modeling integrations updated with coverage for the new flow.</li> </ul>"},{"location":"release-notes/v0.3.2/#compatibility-notes","title":"Compatibility Notes","text":"<ul> <li>Standard/verbose outputs now include <code>merged_cells</code> by default.</li> <li>Set <code>StructOptions.include_merged_cells=False</code> or   <code>OutputOptions.filters.include_merged_cells=False</code> to suppress the field.</li> </ul>"},{"location":"release-notes/v0.3.5/","title":"v0.3.5 Release Notes","text":"<p>This release introduces a new merged_cells serialization format and adds a compatibility flag to control merged cell values in rows.</p>"},{"location":"release-notes/v0.3.5/#highlights","title":"Highlights","text":"<ul> <li><code>merged_cells</code> output now uses a schema/items structure (breaking change).</li> <li>Added <code>StructOptions.include_merged_values_in_rows</code> to control whether merged   cell values remain in <code>rows</code> (default: True).</li> <li>Merged cell values with no content are normalized to a single space <code>\" \"</code>.</li> <li>Updated tests and documentation to reflect the new format.</li> </ul>"},{"location":"release-notes/v0.3.5/#compatibility-notes","title":"Compatibility Notes","text":"<ul> <li>Old format (&lt;= v0.3.2): <code>merged_cells</code> is a list of objects.</li> <li>New format (v0.3.5+): <code>merged_cells</code> is an object with <code>schema</code> and <code>items</code>.</li> <li>Use the migration note in the README for transition guidance.</li> </ul>"},{"location":"release-notes/v0.3.6/","title":"v0.3.6 Release Notes","text":"<p>This release improves rendering robustness for image export and large Excel files, with better support for multi-page sheets and legacy .xls inputs.</p>"},{"location":"release-notes/v0.3.6/#highlights","title":"Highlights","text":"<ul> <li>Sheet image export now renders all PDF pages per sheet, with <code>_pNN</code> suffixes   for page 2+ (fixes multi-print-range sheets outputting only the first image).</li> <li>.xls rendering now uses Excel SaveAs to a temporary .xlsx before PDF export,   avoiding failures when outputting images from legacy files.</li> <li>Image rendering can run in a subprocess to isolate memory usage and reduce   crashes on large workbooks (enabled by default).</li> </ul>"},{"location":"release-notes/v0.3.6/#notes","title":"Notes","text":"<ul> <li>Set <code>EXSTRUCT_RENDER_SUBPROCESS=0</code> to disable subprocess rendering.</li> </ul>"},{"location":"release-notes/v0.3.7/","title":"v0.3.7 Release Notes","text":"<p>This release adds formula extraction to the structured output, expanding the pipeline, models, and backends while keeping the existing modes and fallbacks.</p>"},{"location":"release-notes/v0.3.7/#highlights","title":"Highlights","text":"<ul> <li>Added <code>formulas_map</code> extraction (formula string -&gt; cell coordinates) via   openpyxl for .xlsx/.xlsm and COM for .xls, with <code>include_formulas_map</code> option   and verbose default behavior.</li> <li>Pipeline, engine, and models now propagate <code>formulas_map</code> end-to-end, with   updated samples and documentation.</li> <li>Rendering robustness improved for print-area exports (safer page numbering   and error handling during PrintArea restoration).</li> </ul>"},{"location":"release-notes/v0.3.7/#notes","title":"Notes","text":"<ul> <li><code>formulas_map</code> is emitted in <code>verbose</code> by default; use <code>include_formulas_map</code>   to enable/disable explicitly.</li> </ul>"},{"location":"release-notes/v0.4.0/","title":"v0.4.0 Release Notes","text":"<p>This release introduces MCP server support for ExStruct, enabling agent tool integration with a stdio server, plus new extraction utilities, policies, and expanded tests and documentation.</p>"},{"location":"release-notes/v0.4.0/#highlights","title":"Highlights","text":"<ul> <li>Added MCP stdio server (<code>exstruct-mcp</code>) with tools:</li> <li><code>exstruct_extract</code></li> <li><code>exstruct_read_json_chunk</code> (cursor + filters for large outputs)</li> <li><code>exstruct_validate_input</code> (pre-checks for files and COM availability)</li> <li>Introduced MCP path policy (allowlist + deny globs), output conflict handling   (<code>--on-conflict</code>), and optional warmup for latency reduction.</li> <li>Added typed extraction options for MCP runs (pretty/indent and side outputs),   and clarified file validation errors.</li> <li>Improved openpyxl border scanning (deferred column shrink) for late-table   detection; added backend selection for border clustering.</li> <li>Documentation updates for MCP setup and agent configuration (site nav and   README updates), plus expanded tests and CI dependency installation.</li> </ul>"},{"location":"release-notes/v0.4.0/#notes","title":"Notes","text":"<ul> <li>MCP dependencies are optional: install with <code>pip install exstruct[mcp]</code>.</li> <li><code>read_json_chunk</code> enforces file paths and chunk size limits; use <code>sheet</code>/   <code>filter</code> when outputs are large.</li> </ul>"}]}